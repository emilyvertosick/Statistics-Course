[["index.html", "MSKCC Biostatistics Course General Course Materials Course Outline Andrews Contact Details Passing the Course Data Checking Procedures Guidelines for presentation of statistics", " MSKCC Biostatistics Course Last Updated: October 01, 2021 General Course Materials Course Outline Course Schedule for K30 Biostatistics Seminar Course Leader: Andrew Vickers All classes are on Monday evenings from 05:30pm - 07:00pm. 5:30 - 6:10: I will go over the R assignments. 6:10 - 7:00: Open office hours All sessions will be held virtually: Zoom Link Reading is from What is a p-value anyway? unless otherwise stated. Readings below are to be done before the class. R assignments are done after the class. Date / Location Topic and Assignments 1/25/2021 Class I: What is statistics? Reading: How To Read This Book, Chapter 1 Assignment: Questions 1 and 4 2/1/2021 Class II: Describing Data Reading: Chapters 2-6 and chapter 20 Assignment: All questions for chapters 2, 3, 4 and 6; questions 1 and 3 for chapter 5; question 1 for chapter 20 2/8/2021 Class III: Data Distributions Reading: Chapters 7-9 Assignment: Chapter 7, question 2; chapter 8, question 1; chapter 9, questions 1 and 3 2/22/2021 Class IV: Confidence Intervals Reading: Chapters 10-12 Assignment: All questions for chapters 10 and 11; question 1 in chapter 12 Extra for those doing R assignment: Statistics Notes: Diagnostic tests 3: receiver operating characteristic plots 3/1/2021 Class V: Hypothesis Testing Reading: Chapters 13-17 Assignment: Chapters 13, 15 and 16, all questions; chapter 14, question 1; chapter 17, questions 1-3 3/8/2021 Class VI: Regression Reading: Chapters 18-19 Assignment: Chapter 18, questions 1-4; chapter 19, questions 1-2 3/15/2021 Class VII: Survival Data Reading: Chapters 21-24 and chapter 28 Assignments: Chapter 21, question 1; chapter 23, question 1; chapter 24, questions 1, 2 and 4 3/22/2021 Class VIII: Errors in Statistics (all class meets) Reading: Chapters 30-34 Optional extra reading: The scandal of poor medical research, Math as Mass Hypnosis: On Mortgage-Backed Securities, Maritime Warfare, and Medical Research Assignments: All questions for chapters 30 and 33 3/29/2021 Make-up day, if needed Andrews Contact Details If you are stuck, feel free to get in contact seven days a week, 7am  10pm. Call me on my cell phone 347 244 6934 If it is non-urgent, email me on vickersa@mskcc.org Some typical problems and what to do about them: I cant access R / RStudio / the website isnt working. Contact the help desk! I want to do a regression but cant work out the right R command. Contact me by phone. I dont know whether to do a regression or a correlation. Pick one or the other and raise this as a question in class. I dont understand the R output. Call me if you are totally in the dark; otherwise do your best and raise this as a question in class. I was going to do the assignment, but my dog got ill and I had laptop problems and can I do the assignment for Tuesday instead? Yawn. I dont understand the question. Call me. I am not sure I understand the difference between a regression and a correlation. Raise this in class. Passing the Course You can only get credit for this course if you pass. I am occasionally asked to write a letter for a former student stating that they took part in the MSKCC biostatistics course. Now because I dont take register or have a sign-up sheet, I cant possibly know who took part and who didnt. So I only write letters saying that a former student passed. To pass, you have to meet three conditions: Be officially signed up Pass the exam Answer the feedback About the exam The exam is given at the end of the course. It is posted on the course website and is an open book exam: you do this in your own time and send me your answers. Some notes and thoughts about the exam: There are only a few questions. It shouldnt take longer than a couple of hours to do and I give you two weeks to complete it. The questions I give are far easier than the typical statistical problems you are likely to encounter in the course of a research career. I mark very liberally, and have a low pass mark (50%). Anyone who fails the exam is given an opportunity to resubmit. Working groups I am perfectly happy for you to work in small groups as long as: You are clear and explicit about this up front All members of a group contribute equally You dont take advantage Note that we have had problems with plagiarism before. It is absolutely straightforward for me to detect this using simple software. Data Checking Procedures Checklist for checking papers: Urology Biostatistics This process should be performed when both the statistician and primary contact are satisfied with the paper, and before the paper is reviewed at the biostatistics workshop. Check every number in the text and in every table against software printout from running R code files. Check every figure (e.g. graph) against software printout from running R code files. Where appropriate (e.g. for key analyses or for any paper with a large impact on clinical practice), run analyses by hand by creating additional R code files titled check analyses [descriptor].R. In particular, re-calculate time variables for survival analysis. Check each number in manuscript against checked tables, figures, or software printout. Read through statistical methods section for accuracy and completeness. Is every analysis stated clearly? If the analysis is not straight forward, is the rationale behind the analysis clearly stated? Is survival time data (when clock starts, when clock ends, what is the event, rules for censoring [e.g. for cancer-specific survival]) described clearly? Read through entire paper. Are all of the statements in the results section backed up? Is the conclusion reasonable? Check abstract (methods, numbers, conclusion) against paper. Guidelines for presentation of statistics Please review these guidelines on the course website. Guidelines for Reporting of Statistics for Clinical Research in Urology Guidelines for Reporting of Figures and Tables for Clinical Research in Urology "],["week-1.html", "1 Week 1 1.1 Setting Up 1.2 R Instructions 1.3 Assignments", " 1 Week 1 1.1 Setting Up As a note about this book - you can copy and paste code referenced in this book by hovering over the gray box containing the code, and clicking on the icon that appears in the top right corner. 1.1.1 Software Installation Note: youll need to put aside 20 - 30 minutes to install the software on your computer. R Install a pre-compiled binary of R for your OS from here by clicking on Download R for [your operating system]: https://cloud.r-project.org RStudio Install RStudio Desktop by selecting the installer for your operating system under Desktop Version: https://www.rstudio.com/products/rstudio/download/preview/ 1.1.2 Setting up course files To access this course, download the Statistics Course Data.zip file here. Create and name a folder (e.g. MSKCC biostats course) on your hard drive, and then unzip the file and save it in that folder. Open the Statistics Course folder and click to open the R project file called Statistics Course.Rproj. Opening this file will open RStudio (once you have it installed), and you can easily access all files from the files tab in the bottom right panel in RStudio. There is a Data folder with 7 subfolders inside, which contain the data files needed for the examples and assignments for weeks 1-7. There is a code file called Install Packages Code.R which contains the necessary code for you to install the packages for the course (see below for more details). There is another code file called Code templates for students.R which includes some example code that you can adapt. Every time you work on this course, you should open RStudio by opening the Statistics Course.Rproj file. This allows R to automatically determine the file path location for the data files so you can access them without having to make any changes to the code. It may be helpful to create a desktop shortcut to the Statistics Course.Rproj file so you can easily access the course materials. 1.1.3 Using RStudio When you open the Statistics Course.Rproj file, RStudio will open, and you will see four panes in the RStudio window (if you only see three panes, select new file and New R script). The console window at the bottom left is where results will be shown if running R code from a .R file or interactively. The console window is also where you type in instructions for R. To run code in the console window, you can type or copy and paste the code and press enter. The source window in the top left is where you will write out R code for your .R analysis file. To run code from the source window, highlight the lines of code youd like to run and click the run button, located in the upper right corner of the source window, or use the shortcut ctrl+enter on your keyboard. The top right panel includes several tabs. The most important tabs here are environment, which shows your current datasets and objects, and history, which shows previous commands that have been run from either the console or the source window. The bottom right panel also includes several tabs. The files tab shows all files in your current directory. The plots tab is where plots will be shown if a plot is created. The packages tab shows all R packages that are available on your machine. The help tab will show help files, and help files can be searched from this tab. The viewer tab will show any other files that are created, for example, formatted tables. 1.1.4 Installing packages For this course, you will need to install several packages which will allow you to use the set of functions included in that package. To install the necessary packages, open the Install Packages Code.R file. Run each line in this file by highlighting the line of code and clicking the Run button in the top right hand corner, or using the keyboard shortcut ctrl-enter. If you get the following popup message, please click yes. If after clicking yes once, the pop-up reappears, you can click no the second time. Enter one line at a time, and wait for the packages to install before entering the next line. While the package is installing, you will see a red stop sign icon at the top right corner of the console window. Once the stop sign icon disappears, the package installation is complete and you can install the next package. You will only have to install the packages one time. # Installing packages install.packages(&quot;tidyverse&quot;) install.packages(&quot;here&quot;) install.packages(&quot;skimr&quot;) install.packages(&quot;epiR&quot;) install.packages(&quot;broom&quot;) install.packages(&quot;pROC&quot;) install.packages(&quot;gmodels&quot;) install.packages(&quot;survival&quot;) install.packages(&quot;survminer&quot;) install.packages(&quot;gt&quot;) If you get a message that says These packages have more recent versions available. Which would you like to update? you can enter 1 in the console window and press enter. This will update all necessary packages and complete the installation. If you are using a Windows computer and get an error message that states Error: Could not find tools necessary to compile a package, you will need to download and install the Rtools program before proceeding. The instructions are below: Download the recommended version of Rtools (in green) from this site. Open the Rtools##.exe file and follow the installation instructions. After installation is complete, close RStudio and re-open by clicking on the Statistics Course.RProj file. Re-run the above code in the console to install the packages. We will also be installing a package called gtsummary written by Dan Sjoberg, a statistician at MSKCC, which can format the results from your R code into a clean, publication-ready table. These tables can be copied and pasted from R into a Word document as well. The code below will install this package. install.packages(&quot;gtsummary&quot;) 1.1.5 A Note About Packages R is open source software. Unlike, say, Microsoft Word, where only Microsoft engineers can make changes, R packages are written by statisticians all over the world. There are hundreds of R packages available, and often there are many packages available to perform the same analyses. The packages you will use in this course have been chosen because they make coding easier, perform the necessary analyses and/or create nicely formatted output such as tables and graphs. You may work with statisticians who use different packages to perform these same analyses or to format tables and graphs. For all packages used in the course, if you give the package name to your statistician, they will be able to find and install the packages directly using the install.packages function as we have done above. 1.2 R Instructions 1.2.1 Opening a data file created by someone else This is mainly what you will be doing during this course. You will be loading data from files with a .rds extension, which is a type of file that can be exported from R. There are two ways to do this: You can load files by typing or copying the following code into the console window and pressing enter. Each lesson will have code in the Setting Up section that will load all data necessary to run the examples in the lesson. You can copy and paste that code into your console window and press enter to load the files. In the Assignments section, there will also be code to load the files necessary for the assignment. # You can copy and paste this code into the console window and press &quot;enter&quot; # to load the data needed for the week 1 examples lesson1a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 1&quot;, &quot;lesson1a.rds&quot;)) Using the files tab on the bottom righthand side of the RStudio window. Click on the files tab, and navigate to the folder where the data is stored, for example, by clicking on the Data folder. Click on the desired data .rds file. A Load R Object popup will appear, which allows you to change the name of the dataset when you import it. It is fine for this course to leave the dataset names as is. Clicking OK will load this file to your environment, which you can confirm by looking for the dataset in the top right environment tab. 1.2.2 Loading packages The packages you have installed contain a number of functions. There are two ways to use the functions from these packages: by loading the package, or specifying the package name every time you use a function from that package. If you attempt to use a function from a package without loading that package or specifying the package name, you will get an error. As an example, the skim function comes from the skimr package. Using skim without loading or specifying the skimr package will give an error: # This will give an error - the &quot;skimr&quot; package isn&#39;t loaded yet skim(lesson1a$age) ## Error in skim(lesson1a$age): could not find function &quot;skim&quot; You can give both the package name and function name to avoid this error: # You can use the function &quot;skim&quot; by specifying package &quot;skimr&quot; skimr::skim(lesson1a$age) Table 1.1: Data summary Name lesson1a$age Number of rows 386 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 49.48 13.75 19 40 49 59 86  However, for commonly used packages, it is easier to load the whole package so you do not need to type out the package name every time you use a function. Packages are loaded by typing the package name into the library function. While you only need to install the packages once, you will need to load any packages you want to use every time you open up the Statistics Course.Rproj file in RStudio. For example, to load the skimr package, type or copy and paste the following line of code into the console window, and press enter. library(skimr) Now you will be able to use all functions in the skimr package without specifying the package name each time. Below is R code that will load all the packages you will need to use in this course. You can copy and paste these lines into your console window every time you start working in RStudio (so if you keep RStudio open, say on your laptop, you wont generally have to reload packages). This code will also be available at the beginning of each lesson. # Here is the code to load all necessary packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(survminer) library(tidyverse) 1.2.3 Looking at the data R stores the data in the form of a spreadsheet. The rows are individual observations, normally a patient. The columns are variables giving data for that observation. View the dataset lesson1a by typing the following into the console window and hitting enter (a new window will pop up): # View the data as a spreadsheet View(lesson1a) This is data from 386 patients undergoing surgery. You can see the patients hospital code number as the variable id and then their age and sex. There are then lists of other variables with names such as p1, t, x and so on. You can see that you can have both numbers and text as a variable. You may also notice that some variables have a value of NA for a particular observation (e.g. the 3rd and 4th observations for variable z). In R, NA indicates missing data. 1.2.4 Typing a command There are two options to run R code: you can type or copy and paste code into either the console window or the source window. To run code from the console window, simply press enter. To run code from the source window, highlight the code you would like to run, and click the run button (top right corner of the source window) or use the keyboard shortcut ctrl+enter. A typical command is of the form: packagename::function(options). If a package has already been loaded using the library function (as we did above), you can omit packagename:: when running the code. Since you can have multiple datasets in R at the same time, your command must indicate which dataset you are referring to. This is usually done by including the dataset name inside the parentheses of the function. For example, this will summarize the data for the full lesson1a dataset. # View a summary of the dataset skim(lesson1a) The output above this text is the code, and the output below this shows the results produced by running that code. (We will discuss the results output in more detail later.) (#tab:section1b_1a)Data summary Name lesson1a Number of rows 386 Number of columns 11 _______________________ Column type frequency: character 1 numeric 10 ________________________ Group variables None Variable type: character skim_variable n_missing complete_rate min max empty n_unique whitespace y 0 1 4 9 0 4 0 Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist id 0 1.00 559159.34 257028.45 101143 337803.5 564405 778010.8 999214  sex 0 1.00 0.53 0.50 0 0.0 1 1.0 1  age 0 1.00 49.48 13.75 19 40.0 49 59.0 86  p1 0 1.00 3.24 1.66 0 2.0 3 5.0 6  p2 0 1.00 3.29 1.59 0 2.0 3 5.0 6  p3 0 1.00 3.09 1.63 0 2.0 3 4.0 6  p4 0 1.00 2.62 1.63 0 1.0 3 4.0 6  t 0 1.00 12.24 5.75 0 8.0 12 17.0 24  x 2 0.99 1.54 0.50 1 1.0 2 2.0 2  z 2 0.99 1.59 0.84 1 1.0 1 2.0 3  1.2.5 Some Useful Commands 1.2.5.1 Extracting a variable by name ($) To refer to one variable in your dataset, you can use the notation dataset$variable to indicate which dataset you are referencing, and which variable within that dataset. For example, this will summarize just the variable age from the lesson1a dataset. # View a summary of the &quot;age&quot; variable only skim(lesson1a$age) Table 1.2: Data summary Name lesson1a$age Number of rows 386 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 49.48 13.75 19 40 49 59 86  1.2.5.2 Pipe operator (%&gt;%) One of the most useful commands is known as the pipe operator (%&gt;%). The pipe operator can be read as and then. Pipes allow a dataset to be passed from the left side of the pipe to the command on the right side. The dataset you are using will be referenced on the left side of the pipe, rather than included as an option in the next function. This notation is useful because it can make your code more clear if you are using more than one function. Here is an example of piping using the skim function. This piece of code can be read as, Use the skim function on the lesson1a dataset. # You can put the dataset into the function skim(lesson1a) This piece of code can be read as, Take the lesson1a dataset, and then give this data to the skim function to use. # You can also use the &quot;pipe&quot; operator lesson1a %&gt;% skim() You can see that both of these lines of code are doing the same thing, although the order of the function and the dataset are different. Both will give the same results - try copying both lines of code into your console window to check that this is true. # These two pieces of code will also give the same results skim(lesson1a$age) lesson1a %&gt;% skim(age) In this example, the pipe operator is not particularly useful - it actually involves more typing (lesson1a %&gt;% skim()) than not using the pipe operator (skim(lesson1a)). However, the pipe operator is very helpful in more complex code. Here is an example of two pieces of code that do the same thing, with the second example using the pipe notation. You dont need to understand what this code does, but you can see that the pipe notation makes the code shorter and easier to read. It allows you to see what is happening in the code in order from left to right and top to bottom, while the code without pipes has to be read from the inside (the innermost set of parentheses) to the outside (the outermost set of parentheses). # Without piping new_data &lt;- select(filter(mutate(trial, trt = as_factor(str_sub(str_to_upper(trt), 1, 4))), age &gt; 60), trt, age, marker, stage, grade) new_data ## # A tibble: 37 x 5 ## trt age marker stage grade ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; ## 1 DRUG 63 0.06 T3 I ## 2 DRUG 71 0.445 T4 III ## 3 DRUG 61 1.71 T4 I ## 4 DRUG 63 0.981 T4 II ## 5 DRUG 67 1.16 T1 II ## 6 DRUG 68 0.105 T4 II ## 7 DRUG 78 0.175 T3 I ## 8 DRUG 61 0.177 T4 III ## 9 DRUG 71 0.737 T1 I ## 10 DRUG 83 0.475 T1 III ## # ... with 27 more rows # With piping new_data_pipe &lt;- trial %&gt;% mutate( trt = str_to_upper(trt) %&gt;% str_sub(1, 4) %&gt;% as_factor() ) %&gt;% select(trt, age, marker, stage, grade) %&gt;% filter(age &gt; 60) new_data_pipe ## # A tibble: 37 x 5 ## trt age marker stage grade ## &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; ## 1 DRUG 63 0.06 T3 I ## 2 DRUG 71 0.445 T4 III ## 3 DRUG 61 1.71 T4 I ## 4 DRUG 63 0.981 T4 II ## 5 DRUG 67 1.16 T1 II ## 6 DRUG 68 0.105 T4 II ## 7 DRUG 78 0.175 T3 I ## 8 DRUG 61 0.177 T4 III ## 9 DRUG 71 0.737 T1 I ## 10 DRUG 83 0.475 T1 III ## # ... with 27 more rows 1.2.5.3 Assignment Operator (&lt;-) The assignment operator allows you save out changes you have made, for example, changes to datasets, or new objects you have created, like a table. You can make changes to a dataset, which will print in the console window. However, you must use the assignment operator to store out these changes. Below is an example of how to create a dataset that contains only patients in the Drug A group and save this dataset out. You do not need to know all of these functions at this point, although you will learn them in the future. # Here we are only keeping patients from the &quot;Drug A&quot; group trial %&gt;% filter(trt == &quot;Drug A&quot;) ## # A tibble: 98 x 8 ## trt age marker stage grade response death ttdeath ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Drug A 23 0.16 T1 II 0 0 24 ## 2 Drug A 31 0.277 T1 II 0 0 24 ## 3 Drug A NA 2.07 T3 III 1 1 17.6 ## 4 Drug A 51 2.77 T4 III 1 1 16.4 ## 5 Drug A 37 0.354 T1 II 0 0 24 ## 6 Drug A 32 1.74 T1 I 0 1 18.4 ## 7 Drug A 31 0.144 T1 II 0 0 24 ## 8 Drug A 38 2.08 T4 III 1 0 24 ## 9 Drug A 57 0.066 T1 III 0 0 24 ## 10 Drug A 46 0.325 T1 II 0 0 24 ## # ... with 88 more rows You can see that the data that prints out only includes observations where trt is Drug A. While this dataset printed out, it no longer exists, because we did not give it a name and save it out. You can see this below - the dataset still has all observations. # Print original dataset to confirm no changes trial ## # A tibble: 200 x 8 ## trt age marker stage grade response death ttdeath ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Drug A 23 0.16 T1 II 0 0 24 ## 2 Drug B 9 1.11 T2 I 1 0 24 ## 3 Drug A 31 0.277 T1 II 0 0 24 ## 4 Drug A NA 2.07 T3 III 1 1 17.6 ## 5 Drug A 51 2.77 T4 III 1 1 16.4 ## 6 Drug B 39 0.613 T4 I 0 1 15.6 ## 7 Drug A 37 0.354 T1 II 0 0 24 ## 8 Drug A 32 1.74 T1 I 0 1 18.4 ## 9 Drug A 31 0.144 T1 II 0 0 24 ## 10 Drug B 34 0.205 T3 I 0 1 10.5 ## # ... with 190 more rows Sometimes, this is fine - for example, if you simply want to take a look at the data. If you need to use this data again, give the dataset a name and use the assignment operator. # Save out dataset including only patients in drug group trial_drug &lt;- trial %&gt;% filter(trt == &quot;Drug A&quot;) trial_drug ## # A tibble: 98 x 8 ## trt age marker stage grade response death ttdeath ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; ## 1 Drug A 23 0.16 T1 II 0 0 24 ## 2 Drug A 31 0.277 T1 II 0 0 24 ## 3 Drug A NA 2.07 T3 III 1 1 17.6 ## 4 Drug A 51 2.77 T4 III 1 1 16.4 ## 5 Drug A 37 0.354 T1 II 0 0 24 ## 6 Drug A 32 1.74 T1 I 0 1 18.4 ## 7 Drug A 31 0.144 T1 II 0 0 24 ## 8 Drug A 38 2.08 T4 III 1 0 24 ## 9 Drug A 57 0.066 T1 III 0 0 24 ## 10 Drug A 46 0.325 T1 II 0 0 24 ## # ... with 88 more rows Here, weve called this dataset trial_drug, and you can see that this dataset only includes the patients in the Drug A group. 1.2.5.4 head function The head function allows you to see the first few rows of your dataset in the console window, including the variable names and variable types at the top of the table. (Using the code head(lesson1a) will also give you the same results.) # Look at the first few rows of your data lesson1a %&gt;% head() ## # A tibble: 6 x 11 ## id sex age p1 p2 p3 p4 t x y z ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 541836 0 33 0 0 0 0 0 2 campus 1 ## 2 285383 1 55 0 1 1 1 3 2 campus 1 ## 3 332777 0 52 0 0 3 3 6 1 campus NA ## 4 566828 1 53 0 0 0 1 1 2 campus NA ## 5 193254 1 57 0 1 2 3 6 2 satellite 1 ## 6 530508 1 31 0 0 2 2 4 1 campus 3 1.2.5.5 table function The table function is the basic function for creating one-way and two-way tables. However, these tables often do not provide much information and are not formatted nicely or in a way that can easily be copied to a Word document. Note: the trial dataset is automatically loaded when you load the gtsummary package, which weve done above, so this dataset does not have to be manually loaded like the lesson1a dataset. Here is an example of a one-way table using the table function: # Create one-way table for death table(trial$death) ## ## 0 1 ## 88 112 While this table does not give column names and is not formatted, you can see that it shows that there are 112 patients who died, and 88 patients who did not. Here is an example of a two-way table: # Create two-way table for response and death table(trial$response, trial$death) ## ## 0 1 ## 0 49 83 ## 1 37 24 Unlike the one-way table, these results are not easily interpretable. If you are not familiar with R code or with your data, this table is not very useful. There is nothing to indicate which variable is represented by the columns, and which variable is represented by the rows. The table only provides counts, and does not provide any percents. If you print the response variable, you can also see that there are NA values in the response variable, which the table doesnt include at all. # Print response variable values trial$response ## [1] 0 1 0 1 1 0 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 ## [26] 0 1 0 0 1 1 0 0 1 0 NA 0 1 0 0 0 1 0 1 1 1 1 0 0 0 ## [51] 0 0 0 0 0 0 1 0 1 1 0 0 0 0 NA 0 1 1 0 0 1 0 0 0 1 ## [76] 0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0 0 1 1 1 0 0 0 0 0 ## [101] 0 0 NA 0 0 1 0 0 0 0 1 1 0 0 1 1 0 0 0 0 1 0 0 0 0 ## [126] 1 1 0 0 0 1 0 0 0 1 0 1 1 NA 1 1 1 0 1 0 0 1 0 NA 1 ## [151] 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 0 1 0 1 0 1 0 1 1 ## [176] 1 0 1 NA 0 1 0 0 1 0 1 0 0 0 0 0 0 0 0 NA 0 1 1 0 0 ## attr(,&quot;label&quot;) ## [1] &quot;Tumor Response&quot; 1.2.5.6 tbl_summary function The tbl_summary function (from the gtsummary package) creates and formats tables so that it is clear what the columns and rows are, and also includes any missing values. This function also formats the tables in a way that can easily be copied and pasted into a Word document for publication. In this course, we will be using the tbl_summary function instead of the table function for all tables that will be displayed. There are some cases where the table function will be used in conjunction with another function to perform an analysis, but these tables will not be displayed. Note: Tables created by the tbl_summary package will not display in the console window, and will instead display in the Viewer pane on the bottom right-hand side of the screen. The tbl_summary function can create one-way and two-way tables for binary and categorical variables. It can also create tables which include summary statistics for continuous variables (by default, median and quartiles). The select function allows you to list the variables you would like to include in your table. Here, we are only showing sex in the table. Here is an example of a one-way table created using the tbl_summary function: # Create a formatted table for the &quot;sex&quot; variable tbl_summary( lesson1a %&gt;% select(sex) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 3861 1 if woman, 0 if man 205 (53%) 1 n (%) As you can see, there is currently only one row in the table. If a variable has values of 0 and 1 only, the tbl_summary function gives the percentage of values that are equal to 1 by default. If you would like to see the percentage of both 0 and 1 values, you can use the type option and specify that the variable is categorical. # Create a formatted table for the &quot;sex&quot; variable, showing both &quot;0&quot; and &quot;1&quot; values tbl_summary( lesson1a %&gt;% select(sex), type = list(&quot;sex&quot; ~ &quot;categorical&quot;) ) ## Warning: The `.dots` argument of `group_by()` is deprecated as of dplyr 1.0.0. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_warnings()` to see where this warning was generated. html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 3861 1 if woman, 0 if man 0 181 (47%) 1 205 (53%) 1 n (%) This tells you that the sex variable has no missing data because the table only shows values of 0 and 1, with no NA values. It also shows that there only 2 different values, all of which are integers (i.e. whole numbers). Now this is useful because if you had been sent a set of data for sex and the tbl_summary function told you that there were 4 unique values, some of which were not integers, you would want to check the data further before doing any analysis. Since 0 = man and 1 = woman based on the variable label (see the first row of the table), this means that there were 181 men in the 386 patients and that they constituted 47% of the population. The tbl_summary function can also be used for two-way tables. The select function is used to select both variables of interest, and the name of the column variable is specified in the by statement. As you can see, this table is much clearer, as well as nicer looking, than the table created by the table function. It also includes information on the missing (NA) values, which are excluded when using the table function. # Create two-way table for response and death using &quot;table&quot; function table(trial$response, trial$death) ## ## 0 1 ## 0 49 83 ## 1 37 24 # Create two-way table for response and death using &quot;tbl_summary&quot; function tbl_summary( trial %&gt;% select(response, death), by = death, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 881 1, N = 1121 Tumor Response 0 49 (57%) 83 (78%) 1 37 (43%) 24 (22%) Unknown 2 5 1 n (%) 1.2.5.7 skim function The skim function (from the skimr package) gives basic summary data. # Show summary statistics for &quot;age&quot; skim(lesson1a$age) Table 1.3: Data summary Name lesson1a$age Number of rows 386 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 49.48 13.75 19 40 49 59 86  So of the 386 patients (column n), the mean age (a type of average, Ill explain next week) is 49.48 (column mean), the standard deviation (again, Ill explain next week) is 13.75 (column sd). The youngest patient was 19 (column p0) and the oldest is 86 (column p100). This simple command gives us our first lesson about the dangers of statistical software: it gives the age to within a few days. So if you were reporting results for a journal, you would never say that mean age was 49.48, youd probably just say 49. p0 here represents the minimum age in the dataset - 19. p100 represents the maximum age of 86. p25, p50 and p75 are the centiles. Well talk more about this later, but briefly, p25 = 40 means that 25% of the patients were aged 40 and younger. The number by p50 (i.e. 49) is the median. 1.2.5.8 mutate function The mutate function is used to create new variables, or replace variable values. The code below means: create a new variable called a and set it equal to 1 in all observations. The &lt;- indicator means to then save out this new dataset including the a variable as lesson1a, replacing the old lesson1a dataset that does not include a. # Save the data out as &quot;lesson1a&quot; lesson1a &lt;- lesson1a %&gt;% # Take the current &quot;lesson1a&quot; dataset mutate(a = 1) # And add a variable called &quot;a&quot; with a value of &quot;1&quot; Since we have already created the variable a above, the code below means: replace the variable a with the value of 2 in all observations. # Replace the value of &quot;a&quot; with &quot;2&quot; for all observations lesson1a &lt;- lesson1a %&gt;% mutate(a = 2) You can also replace one variable with the value of another variable. The code below means: replace the variable a with whatever the value of p1 is in each observation. # Replace the value of &quot;a&quot; with the value of &quot;p1&quot; for all observations lesson1a &lt;- lesson1a %&gt;% mutate(a = p1) You can also calculate values inside a mutate statement. For example, you can create an average of the four variables p1 - p4. # Replace &quot;a&quot; with the average of &quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot; and &quot;p4&quot; lesson1a &lt;- lesson1a %&gt;% mutate(a = (p1 + p2 + p3 + p4)/4) 1.2.5.9 if_else function The if_else function can be used with the mutate function to assign values to a variable based on a specific condition. The first argument in the if_else function is the if condition. The second argument is the value of the variable for observations that meet the if condition. The third argument is the value of the variable for observations that do not meet the if condition. For example, the code below says: replace the value of a with p1 if p1 is greater than 4. Otherwise, keep the original value a. # Replace the value of &quot;a&quot; with &quot;p1&quot; if the value of &quot;p1&quot; is greater than 4 lesson1a &lt;- lesson1a %&gt;% mutate(a = if_else(p1 &gt; 4, p1, a)) In this case, we are only replacing for females. Note that when you use equals sign after an if you have to use two of them in a row to signify is equal to rather than make equal to. # Replace the value of &quot;a&quot; with &quot;p1&quot; if &quot;sex&quot; equals 1 (female) lesson1a &lt;- lesson1a %&gt;% mutate(a = if_else(sex == 1, p1, a)) The | sign means or, such that the code below means: set a equal to 1 if y is equal to either campus or peds. Otherwise, keep the original value of a. # Replace the value of &quot;a&quot; with &quot;1&quot; if &quot;y&quot; is equal to either &quot;campus&quot; or &quot;peds&quot; lesson1a &lt;- lesson1a %&gt;% mutate(a = if_else(y == &quot;campus&quot; | y == &quot;peds&quot;, 1, a)) You can give check for more than one condition by using the &amp; sign. This code looks for observations where the patient is female (sex == 1) and the patient is older than 50 (age &gt; 50). This creates a subgroup of older women: a is 1 for older women and 0 for everybody else. # Replace the value of &quot;a&quot; with 1 if sex equals 1 (female) and age &gt; 50 # For all other observations, replace &quot;a&quot; with 0 lesson1a &lt;- lesson1a %&gt;% mutate(a = if_else(sex == 1 &amp; age &gt; 50, 1, 0)) 1.2.5.10 Renaming and Labeling Variables To rename a variable, you can use the rename function. We have to make sure that the new variable name overwrites the old variable name, so we have to use the assignment operator (&lt;-). # Rename variable y lesson1a &lt;- lesson1a %&gt;% rename(location = y) To label a variable, use attr. This automatically overwrites the old label. # Print the variable with the old label str(trial$response) ## int [1:200] 0 1 0 1 1 0 0 0 0 0 ... ## - attr(*, &quot;label&quot;)= chr &quot;Tumor Response&quot; # Label the response variable attr(trial$response, &quot;label&quot;) &lt;- &quot;0: No Tumor Response, 1: Tumor Response&quot; # Confirm new label is correct str(trial$response) ## int [1:200] 0 1 0 1 1 0 0 0 0 0 ... ## - attr(*, &quot;label&quot;)= chr &quot;0: No Tumor Response, 1: Tumor Response&quot; 1.2.6 Using Help The help feature in R can be useful if you know the name of the function that you need assistance with. Sometimes, the help file for a function can be very technical at the top, but if you scroll to the bottom, there is an examples section which will show different examples of the code. You can copy and paste these examples and run them on your own machine which can help you better understand how to use the functions. To access the help file for a function, you can type ?functionname (e.g., ?skim) or ?packagename::functionname if you have not loaded the package using the library command. Unfortunately, the R help function is not very useful if you dont know the function you are trying to use. However, there are some websites that can be useful to learn more about the common functions used in the course. 1.2.6.1 Data Manipulation Most of the data manipulation we will be doing in this course, such as creating variables and selecting specific variables and observations to keep, is done using functions from the dplyr package (part of the tidyverse) package. This includes the select and mutate functions that youve seen in this lesson, as well as other functions you will see in future lessons, like filter. Click here if you need help remembering which function to use, or need code examples for these functions. 1.2.6.2 Statistical Functions Most of the statistical functions that will be used in this course are included in the stats package, which is pre-loaded when you install R. These include the following functions, among others: quantile, binom.test, t.test, wilcox.test, fisher.test, lm and glm. You can access the help files for these using the ?functionname notation, for example, ?quantile. If you need help deciding which statistical functions to use, the best place to start would be searching through the statistics course online book, using the magnifying glass option at the top left. For example, if you search logistic regression, you can find section 5.2.4 Logistic regression, which will take you to the section of the course on this topic. 1.2.6.3 Tables For more information on the gtsummary package, which creates formatted tables, click here. 1.3 Assignments # Copy and paste this code to load the data for week 1 assignments lesson1a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 1&quot;, &quot;lesson1a.rds&quot;)) The data for you to look at are in the attached file lesson1a.rds. This is data for 386 patients undergoing surgery. What type of data (e.g. continuous, binary, ordinal, nonsense) are each of the variables? "],["week-2.html", "2 Week 2 2.1 Setting Up 2.2 R Instructions 2.3 Assignments", " 2 Week 2 2.1 Setting Up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Load data necessary to run Week 2 examples lesson1a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 1&quot;, &quot;lesson1a.rds&quot;)) 2.2 R Instructions 2.2.1 Looking at your data There are several ways to see the variables in your dataset. Click on the blue circle with an arrow next to the name of your dataset in the environment tab (top right). You will see the number of observations and the number of variables in your dataset next to the name of your dataset. Underneath, you can see the variable name, the variable type, the values from the first several observations, and variable labels (if they exist). In some datasets, variables are labeled with information on what data is stored in the variable and/or what the variable values mean. For example, look below at the variable sex under lesson1a. To the right of the variable name, it shows that this is a numeric variable (num) and displays the first ten values. What we would expect to find in the sex variable is self-explanatory, based on the variable name. However, we dont know how to interpret the values. Luckily, this information is included in the variable label on the following line. Other variables have names that are not self-explanatory, for example, p1. This variable has a label that indicates that this is pain at time 1 postop. You will also notice that sometimes there are variables that are not labeled. In this dataset, age does not have a label - the variable name is self-explanatory, and by looking at the values we can see that this is age in years. If you would like to print out this information in the console window, you can also use the str function: # Shows a list of variables and labels str(lesson1a) ## tibble [386 x 11] (S3: tbl_df/tbl/data.frame) ## $ id : num [1:386] 541836 285383 332777 566828 193254 ... ## $ sex: num [1:386] 0 1 0 1 1 1 0 0 1 0 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;1 if woman, 0 if man&quot; ## $ age: num [1:386] 33 55 52 53 57 31 54 26 52 66 ... ## $ p1 : num [1:386] 0 0 0 0 0 0 0 0 0 0 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;pain at time 1 postop&quot; ## $ p2 : num [1:386] 0 1 0 0 1 0 1 0 0 1 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;pain at time 2 postop&quot; ## $ p3 : num [1:386] 0 1 3 0 2 2 4 1 0 1 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;pain at time 3 postop&quot; ## $ p4 : num [1:386] 0 1 3 1 3 2 1 0 0 1 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;pain at time 4 postop&quot; ## $ t : num [1:386] 0 3 6 1 6 4 6 1 0 3 ... ## ..- attr(*, &quot;label&quot;)= chr &quot;total pain score times 1 - 4&quot; ## $ x : num [1:386] 2 2 1 2 2 1 1 1 2 1 ... ## $ y : chr [1:386] &quot;campus&quot; &quot;campus&quot; &quot;campus&quot; &quot;campus&quot; ... ## $ z : num [1:386] 1 1 NA NA 1 3 1 1 3 1 ... The environment tab and the str function are useful for getting an overview of the variables available in your dataset, they are not as useful for getting an overview of the data values available. The commands you might think about using for the datasets sent after lecture 2 are given below. I give examples from lesson1a.rds, the data I sent after lecture 1. 2.2.2 Summarizing continuous variables The function skim will give summary statistics for specified variables. # Summary of &quot;age&quot; variable from &quot;lesson1a&quot; dataset lesson1a %&gt;% skim(age) Table 2.1: Data summary Name Piped data Number of rows 386 Number of columns 11 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist age 0 1 49.48 13.75 19 40 49 59 86  So you can tell you have data on age for 386 patients (number of rows is the number of observations), the mean age was about 49 years, and the standard deviation of the mean was about 13.8. The numbers below p0, p25, p50, p75 and p100 are the centiles. p0 indicates the minimum value, and p100 indicates the maximum value, so you can tell that the youngest patient was 19 and the oldest was 86. p50 is the median (49 years), and the interquartile range is reported under p25 and p75 (40, 59). # Summary of &quot;age&quot; within men and women separately lesson1a %&gt;% group_by(sex) %&gt;% skim(age) Table 2.2: Data summary Name Piped data Number of rows 386 Number of columns 11 _______________________ Column type frequency: numeric 1 ________________________ Group variables sex Variable type: numeric skim_variable sex n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist age 0 0 1 49.07 13.61 19 40 49 58 82  age 1 0 1 49.85 13.90 21 40 49 60 86  The group_by function allows you to group your data and perform analyses separately by group. For example, the above code groups by sex, so the mean, standard deviation and other summary statistics are presented separately among men and among women. 2.2.3 Centiles You can get R to give you centiles directly by using the quantile function. The option na.rm = TRUE tells R to ignore any missing (NA) values when calculating the centiles. # Get centiles for &quot;age&quot; variable quantile(lesson1a$age, na.rm = TRUE) ## 0% 25% 50% 75% 100% ## 19 40 49 59 86 The first row of the results says that you are looking at the 0, 25, 50, 75, and 100 centiles, i.e. the minimum and maximum, and the median and quartiles. The second row gives you the actual values. So you could report this as Median age was 49 (quartiles 40, 59). You arent restricted to quartiles with the quantile function. For example, you can use the code below to give you the 11th, 45th and 78th centile, as well as 91.5 centile, which would be the 915th highest value in a dataset of 1000 observations. # Get specific centiles (11th, 45th, 78th, 91.5th) for &quot;age&quot; variable quantile(lesson1a$age, probs = c(0.11, 0.45, 0.78, 0.915), na.rm = TRUE) ## 11% 45% 78% 91.5% ## 32.0 47.0 60.3 69.0 2.2.4 One-way tables As mentioned in the first lesson, the tbl_summary function (from the gtsummary package) can be used to create a frequency table, in this case, the number of men and women. # Get formatted one-way frequency table tbl_summary( lesson1a %&gt;% select(sex), # Specify data to use and variables to include type = list(&quot;sex&quot; ~ &quot;categorical&quot;) # Show all levels of binary variables ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 3861 1 if woman, 0 if man 0 181 (47%) 1 205 (53%) 1 n (%) So there are 205 (53%) women and 181 (47%) men. 2.2.5 Two-way tables The tbl_summary function can also give a two-way table, for example, a table that shows where operations were done (remember that the variable y gives the part of the hospital) in men and women separately. In the last lesson, a 2-by-2 table was created, but tbl_summary can also create a two-way table with more than 2 rows or more than 2 columns. # Create a formatted two-way summary table tbl_summary( lesson1a %&gt;% select(sex, y), # Select both variables by = y, # The &quot;by&quot; option specifies which will be the column variable type = list(&quot;sex&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic campus, N = 2401 harding, N = 391 peds, N = 401 satellite, N = 671 1 if woman, 0 if man 0 115 (48%) 15 (38%) 19 (48%) 32 (48%) 1 125 (52%) 24 (62%) 21 (52%) 35 (52%) 1 n (%) This shows that, for example, there were 240 operations done at the main campus, 115 of these were done on men and 125 on women. This shows that 48% of the operations at the satellite were on men and 52% on women. You can use the add_overall function to add a column which shows the total across all sites. This is not generally advised - for instance, if the median age in the drug group is 65 and in the placebo group is 67, you dont need to be told that the median age in the cohort is somewhere near 66 - but there are sometimes reasons to report on the whole cohort as well. # Create a formatted two-way summary table and add column for all patients tbl_summary( lesson1a %&gt;% select(sex, y), by = y, type = list(&quot;sex&quot; ~ &quot;categorical&quot;) ) %&gt;% # Add a column with totals across all locations # &quot;last = TRUE&quot; puts the column on the right side of the table add_overall(last = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic campus, N = 2401 harding, N = 391 peds, N = 401 satellite, N = 671 Overall, N = 3861 1 if woman, 0 if man 0 115 (48%) 15 (38%) 19 (48%) 32 (48%) 181 (47%) 1 125 (52%) 24 (62%) 21 (52%) 35 (52%) 205 (53%) 1 n (%) Overall, 47% of the patients treated in the hospital were men and 53% were women. By default tbl_summary gives column percents (here, the percentage of patients who are men and women at each site). You can also get the row percents (for example, the percentage of women treated at each site) using the percent option and specifying row. # The two-way summary table can give you row percent instead of column percent tbl_summary( lesson1a %&gt;% select(sex, y), by = y, type = list(&quot;sex&quot; ~ &quot;categorical&quot;), percent = &quot;row&quot; # get the row percent instead of column percent ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qzjvxzfwte .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qzjvxzfwte .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qzjvxzfwte .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qzjvxzfwte .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qzjvxzfwte .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qzjvxzfwte .gt_column_spanner_outer:first-child { padding-left: 0; } #qzjvxzfwte .gt_column_spanner_outer:last-child { padding-right: 0; } #qzjvxzfwte .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qzjvxzfwte .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_from_md > :first-child { margin-top: 0; } #qzjvxzfwte .gt_from_md > :last-child { margin-bottom: 0; } #qzjvxzfwte .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qzjvxzfwte .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qzjvxzfwte .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qzjvxzfwte .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_sourcenote { font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_left { text-align: left; } #qzjvxzfwte .gt_center { text-align: center; } #qzjvxzfwte .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qzjvxzfwte .gt_font_normal { font-weight: normal; } #qzjvxzfwte .gt_font_bold { font-weight: bold; } #qzjvxzfwte .gt_font_italic { font-style: italic; } #qzjvxzfwte .gt_super { font-size: 65%; } #qzjvxzfwte .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic campus, N = 2401 harding, N = 391 peds, N = 401 satellite, N = 671 1 if woman, 0 if man 0 115 (64%) 15 (8.3%) 19 (10%) 32 (18%) 1 125 (61%) 24 (12%) 21 (10%) 35 (17%) 1 n (%) This shows that, for example, 8.3% of men and 12% of women had operations at the Harding site. 2.2.6 Subsetting Data Sometimes, you will want to subset your data - for instance, by keeping only the women from the full dataset. This can be done using the filter function. The filter function takes a condition, similar to an if_else statement. However, filter only keeps observations in the data that meet that condition. To start, we will count the number of observations in the full dataset, so we will be able to confirm whether we have subset correctly. Passing a dataset to the count function will count the number of total observations. # Count all patients in the dataset lesson1a %&gt;% count() ## # A tibble: 1 x 1 ## n ## &lt;int&gt; ## 1 386 In this example, we can use filter to count the number of women in the dataset, or the number of operations on women at the main campus. Dont forget that you need to use two equals signs here. # Count the number of women lesson1a %&gt;% filter(sex == 1) %&gt;% count() ## # A tibble: 1 x 1 ## n ## &lt;int&gt; ## 1 205 # Count the number of women treated at the main campus lesson1a %&gt;% filter(sex == 1 &amp; y == &quot;campus&quot;) %&gt;% count() ## # A tibble: 1 x 1 ## n ## &lt;int&gt; ## 1 125 Note that because we did not use the assignment operator (&lt;-) to save these datasets, we did not alter our original dataset. You can use the count function to confirm that lesson1a still contains all observations. 2.2.7 Graphing We wont be doing much on the graphical presentation of data in this course (this has been called graphicacy). The only reason we are doing it here is to get a visual impression of whether data are normally presented (not something youd want to publish). The following might sound a little complicated, but just follow it through and everything will be fine. First, run the following code. # This code creates a histogram of the &quot;age&quot; variable ggplot(data = lesson1a, aes(x = age)) + geom_histogram() ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ggplot indicates that you want to create a graph. The dataset lesson1a is specified in the data option, and aes(x = age) means that the variable on the x-axis should be age. geom_histogram takes this data and graphs it as a histogram. One of the things that R does is to choose the number of bars for you. Notice how the graph looks lumpy. The output also displays a message that tells you that the default number of bars (also called bins) is 30 and suggests to pick a better value. This is because you are breaking the data up into too many small pieces. You can pick the number of bars yourself by using the bins option. Try setting the number of bins to 20, which will break the data into fewer pieces. # Here is the same histogram, setting the number of bins to 20 ggplot(data = lesson1a, aes(x = age)) + geom_histogram(bins = 20) The following code will superimpose a curve for the normal distribution. # Here is the histogram with 20 bins and density curve overlay ggplot(data = lesson1a, aes(x = age)) + geom_histogram(aes(y = ..density..), bins = 20) + geom_density() 2.2.8 Further Reading Only read this if you are feeling really keen # The &quot;ci&quot; function is from the &quot;gmodels&quot; package # This gives the mean of age and 90% confidence interval ci(lesson1a$age, confidence = 0.90, na.rm = TRUE) ## Estimate CI lower CI upper Std. Error ## 49.4844560 48.3301266 50.6387853 0.7000938 This gives the mean of age, its standard error and its 90% confidence interval (Ill explain confidence intervals next week: one thing you might want to think about is to compare the two numbers given for the confidence interval with the 5% and 95% centile using quantile(lesson1a$age, na.rm = TRUE)). # The &quot;ci.binom&quot; function gives the same information as &quot;ci&quot; but is used for binary variables ci.binom(lesson1a$sex, na.rm = TRUE) ## Estimate CI lower CI upper Std. Error ## [1,] 0.5310881 0.4799345 0.5817614 0.02540009 For a binary variable, the function ci.binom from the gmodels package is used. This gives the proportion of women along with 95% confidence intervals (95% is the default, meaning if you dont specify a level, it assumes you want the 95% confidence interval.) 2.2.9 Using R as a calculator R can be used as a calculator: # Multiplication 7*7 ## [1] 49 log() is the natural logarithm (to base e) # Natural logarithm log(2.71828) ## [1] 0.9999993 exp() is the inverse natural logarithm, that is, if exp(x)=y, ey=x # Inverse natural logarithm exp(1) ## [1] 2.718282 log10() gives the log to base 10 # Base 10 logarithm log10(100) ## [1] 2 cos(45) gives the cosine of 45 # Cosine cos(45) ## [1] 0.525322 Some of the functions give useful statistical constants. pnorm(x) gives the probability that an observation will be less than mean + x standard deviations. # Probability that an observation will be less than mean + 1 standard deviations pnorm(1) ## [1] 0.8413447 # Probability that an observation will be less than mean - 0.5 standard deviations pnorm(-0.5) ## [1] 0.3085375 pnorm(1) gives 0.84 - this means that 84% of a normally distributed set of data will be less than one standard deviation above the mean. pnorm(-0.5) gives 0.31, meaning that 31% of a normally distributed set of data will be less than half a standard deviation below the mean. Therefore, if you had a data set where the pain score had a mean of 5 and a standard deviation of 2, you could predict that only 16% of patients would have pain scores of 7 or more (i.e. more than one standard deviation higher than the mean) and that 69% would have pain scores of 4 or more (i.e. more than half a standard deviation below the mean: 31% of observations are half a standard deviation or more less than the mean). # Probability that an observation will be less than mean + 1.96 pnorm(1.96) ## [1] 0.9750021 # Probability that an observation will be less than mean - 1.96 pnorm(-1.96) ## [1] 0.0249979 pnorm(1.96) gives 0.975 and pnorm(-1.96) gives 0.025. So 97.5% of observations are less than 1.96 standard deviations greater than the mean, and 2.5% are less than 1.96 standard deviations lower than the mean. In other words, 95% of observations are within 1.96 standard deviations of the mean. pnorm(0.675) gives 0.75 and pnorm(-0.675) gives 0.25, meaning that 50% of observations fall within approximately 2/3 of a standard deviation on either side of the mean. Almost all observations fall within 3 standard deviations of the mean, as shown by pnorm(3) and pnorm(-3), which give 0.9987 and 0.0013, respectively. This means that 99.7% of all observations fall into this range. 2.3 Assignments # Copy and paste this code to load the data for week 2 assignments lesson2a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2a.rds&quot;)) lesson2b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2b.rds&quot;)) lesson2c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2c.rds&quot;)) lesson2d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2d.rds&quot;)) lesson2e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2e.rds&quot;)) It seems like a lot of them, but the task shouldnt take you very long. However, a general rule in this class is: you dont have to do all the questions in the assignment. Try to do at least some (say, at least 2a and 2b), so that you know what we are talking about next week in class. Also, the more you do the more youll learn. However, dont drive yourself crazy trying to get them all done. I am phrasing the questions in ordinary English, pretty much as you would do if you were an investigator. For example, I ask you to summarize the data on race time in marathon runners, rather than say: provide the mean of the variable rt by typing skim(lesson2a$rt). But this means you are going to have to work out what the various variable codes are and what commands to use. All of these questions ask you to summarize data. In other words, how would you describe the data in a journal article (say, your table 1)? One quick clue here: I dont ever want the standard error, well talk more about that next week. lesson2a.rds: This is data from marathon runners: summarize age, sex, race time in minutes (i.e. how long it took them to complete the race) and favorite running shoe. lesson2b.rds: Postoperative pain (this is a similar dataset as you had before for the assignment for the first class). Summarize average pain after the operation. Imagine you had to draw a graph of time course of pain after surgery. What numbers would you use for pain at time 1, time 2, time 3 etc.? lesson2c.rds: This is data on 241 patients undergoing radical prostatectomy. Summarize age, stage, grade and PSA. lesson2d.rds: Cost of a minor medical procedure. Summarize cost. lesson2e.rds: Total cancer pain in one month in a group with chronic cancer pain. Summarize pain scores and number of days with pain. "],["week-3.html", "3 Week 3 3.1 Setting up 3.2 R Instructions 3.3 Assignments", " 3 Week 3 3.1 Setting up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # The &quot;trial&quot; and &quot;midwest&quot; datasets are available automatically # after you load the packages above # Load other data necessary to run Week 3 examples lesson1a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 1&quot;, &quot;lesson1a.rds&quot;)) example3a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;example3a.rds&quot;)) 3.2 R Instructions 3.2.1 Example Datasets Normally, to do an analysis in R, you will have to load in a dataset. However, R and some packages come with built-in example datasets. For example, there is a dataset called trial that comes built in with the gtsummary package. We will use the trial dataset for many examples, but you do not need to load it, as the trial dataset will automatically be loaded after you run library(gtsummary). 3.2.2 Hypothesis Testing For this weeks assignment, you will need to learn the following functions: t.test wilcox.test binom.test 3.2.2.1 t-test This is used to compare a continuous outcome (such as hemoglobin) in two groups (e.g. vegetarians and carnivores, or patients in a randomized trial receiving an anemia treatment or placebo). Now statisticians normally say that the t-test makes two assumptions: (1) data are normally distributed and (2) variances are equal. Dont worry about assumption (2) for now. Also, assumption (1) has an odd feature: it doesnt matter once sample sizes get large (for those of you who want to boast that you know a theorem, this is called the central limit theorem). Just how large is large is a matter of judgment, but generally speaking, it is said that you can feel okay using a t-test on non-normal data once the sample size is above 30 a group. As it turns out, the t-test is robust to non-normal data, even if sample sizes are low. Robust means that it gives similar results regardless of whether the data are normally distributed or not. So many people feel comfortable using the t-test for to compare a continuous outcome between two groups even if the data are pretty skewed. Different forms of the t-test The two main forms of the t-test are paired and unpaired. Unpaired is used when, for example, testing marker levels between two groups taking different drugs, as there are different patients in each group: # t-test for marker levels between treatment arms t.test(marker ~ trt, data = trial, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: marker by trt ## t = 1.5816, df = 188, p-value = 0.1154 ## alternative hypothesis: true difference in means between group Drug A and group Drug B is not equal to 0 ## 95 percent confidence interval: ## -0.04858916 0.44161134 ## sample estimates: ## mean in group Drug A mean in group Drug B ## 1.0173478 0.8208367 The first variable, marker, is the continuous endpoint that you are comparing by the two groups of the second variable, trt (Drug A vs Drug B). Next, you are telling R to get the data from the dataset called trial. paired = FALSE indicates that you want to perform an unpaired test. The last option (var.equal = TRUE) tells the t.test function to treat the two variances as being equal. For this course, you will need to include this option in two-group t.test commands but you do not need to know specific details about this concept. A paired test would be used for comparing blood pressure taken before and after an intervention, for example, because you are looking at two observations on the same patient. # paired t-test for blood pressure between &quot;before&quot; and &quot;after&quot; groups t.test(bp ~ when, data = example3a, paired = TRUE, var.equal = TRUE) ## ## Paired t-test ## ## data: bp by when ## t = -3.3372, df = 119, p-value = 0.00113 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -8.112776 -2.070557 ## sample estimates: ## mean of the differences ## -5.091667 Here, the code is the same as the last example, with bp as the continuous outcome, and when indicating the two groups. Since these are two measurements taken on the same patient, a paired t-test is necessary, so the option paired = TRUE must be included. A single sample test compares the mean of a group of observations with some hypothetical value, for example, is the average rate of college-educated adults in the midwest different than the national average of 32%? # t-test assessing whether the rate of college education is different than 32% t.test(midwest$percollege, mu = 32) ## ## One Sample t-test ## ## data: midwest$percollege ## t = -45.827, df = 436, p-value &lt; 2.2e-16 ## alternative hypothesis: true mean is not equal to 32 ## 95 percent confidence interval: ## 17.68400 18.86147 ## sample estimates: ## mean of x ## 18.27274 Lets look at the print out from a t-test in more detail: # t-test for difference in horsepower for manual vs automatic transmission t.test(hp ~ am, data = mtcars, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: hp by am ## t = 1.3733, df = 30, p-value = 0.1798 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -16.27768 83.11169 ## sample estimates: ## mean in group 0 mean in group 1 ## 160.2632 126.8462 This example is testing whether there is a difference in horsepower (hp) between cars with an automatic transmission (am == 0) vs manual transmission (am == 1). The t.test function reports the data and variables you are testing, followed by the t statistic (t), degrees of freedom (df) and p-value. Below that, it states the alternative hypothesis you are testing, prints the mean in each group, and gives the 95% confidence interval around the difference in group means. While for an unpaired test, the t.test command prints the group means in each group, you may want to report the difference between means. The group means are stored in the t.test results under estimate. # perform t-test and save out results as &quot;hp_test&quot; hp_test &lt;- t.test(hp ~ am, data = mtcars, paired = FALSE, var.equal = TRUE) # show the group means from &quot;hp_test&quot; hp_test$estimate ## mean in group 0 mean in group 1 ## 160.2632 126.8462 To calculate the difference in means between group 0 and group 1, you can use the estimate data to calculate this. The square brackets indicate which number (first mean or second mean) to take. This works to calculate the difference between group 0 and group 1, as well as between group 1 and group 0. # You can save out the means for each group # The first value is mean in group 0 # (&quot;mean in group 0&quot; is printed first in results) mean_group0 &lt;- hp_test$estimate[[1]] # The second value is mean in group 1 mean_group1 &lt;- hp_test$estimate[[2]] # Subtract the mean in group 1 from the mean in group 0 mean_group0 - mean_group1 ## [1] 33.417 # Subtract the mean in group 0 from the mean in group 1 mean_group1 - mean_group0 ## [1] -33.417 You dont need to worry about the t statistic or degrees of freedom (df). The numbers you are most interested in are the p-value, the group means, and the 95% confidence interval. Now we havent discussed the 95% confidence interval yet, but think of it in simple terms as a plausible range of true values of the difference between means. In this data, the average horsepower is 33.4 higher in cars with an automatic transmission, but it could be that, in fact, the true horsepower is between 16.3 lower or 83.1 higher in the automatic group vs the manual group. 3.2.2.2 Non-parametric methods These are used to compare continuous outcomes in two groups. There are no assumptions about normality or variance. Unpaired case, for example, do marker levels differ between the drug and placebo groups? # non-parametric test for difference in marker levels by treatment group wilcox.test(marker ~ trt, data = trial, paired = FALSE, exact = FALSE) ## ## Wilcoxon rank sum test with continuity correction ## ## data: marker by trt ## W = 5161.5, p-value = 0.08475 ## alternative hypothesis: true location shift is not equal to 0 The inputs for the wilcox.test function are very similar to the inputs for the t.test function. You will see here we are using the same example - comparing marker levels by treatment group, so the outcome variable (marker), the group variable (trt) and the dataset (trial) are all the same. This is still an unpaired test (paired = FALSE). Paired case, for example, does an intervention cause a change in a patients blood pressure? # paired non-parametric test for difference in &quot;before&quot; and &quot;after&quot; blood pressure measurements wilcox.test(bp ~ when, data = example3a, paired = FALSE) ## ## Wilcoxon rank sum test with continuity correction ## ## data: bp by when ## W = 5551, p-value = 0.002166 ## alternative hypothesis: true location shift is not equal to 0 Single sample, for example, is the rate of college education in the midwest different than the national average (32%)? # non-parametric test - is rate of college education different from 32%? wilcox.test(midwest$percollege, mu = 32) ## ## Wilcoxon signed rank test with continuity correction ## ## data: midwest$percollege ## V = 924, p-value &lt; 2.2e-16 ## alternative hypothesis: true location is not equal to 32 Note here that you dont get any parameters for the groups such as means, medians or standard deviations. You also dont get an estimate for the difference between groups. 3.2.2.3 The binomial test The binomial test compares a proportion to a hypothesized value. For example, what is the probability that an unbiased coin thrown 100 times would give a result as or more extreme than 60 heads? (This probability is equivalent to the p-value). The first argument of binom.test is the number of successes, then the number of total tests (total observations). The hypothesized probability is specified by the p = option - the default is 0.5 (50%). # Compare a proportion to a hypothesized value &quot;p&quot; binom.test(60, 100, p = 0.5) ## ## Exact binomial test ## ## data: 60 and 100 ## number of successes = 60, number of trials = 100, p-value = 0.05689 ## alternative hypothesis: true probability of success is not equal to 0.5 ## 95 percent confidence interval: ## 0.4972092 0.6967052 ## sample estimates: ## probability of success ## 0.6 You can also use binom.test on data from a dataset. For example, if we want to test whether the proportion of women (sex = 1) is different from 50%: # The &quot;sum&quot; function adds up the number of observations where sex == 1 (women) nwomen &lt;- sum(lesson1a$sex) nwomen ## [1] 205 # The &quot;nrow&quot; function (for &quot;number of rows&quot;) counts the total number of observations # The &quot;filter&quot; function is used to count only the number of observations where # &quot;sex&quot; is not missing (NA) ntotal &lt;- nrow(lesson1a %&gt;% filter(!is.na(sex))) ntotal ## [1] 386 # Compare a proportion of patients in a dataset to a hypothesized value &quot;p&quot; binom.test(nwomen, ntotal, p = 0.5) ## ## Exact binomial test ## ## data: nwomen and ntotal ## number of successes = 205, number of trials = 386, p-value = 0.2417 ## alternative hypothesis: true probability of success is not equal to 0.5 ## 95 percent confidence interval: ## 0.4799345 0.5817614 ## sample estimates: ## probability of success ## 0.5310881 Note that above, we used the filter function to only count those observations where sex was not missing (NA). The function is.na gives a value of TRUE if the data is missing (NA) and FALSE if the data is non-missing. The ! means is not in R, so that the statement !is.na(sex) is indicating that we want to keep the data where sex is not missing. In this dataset, there are no missing values for sex, but it is a good habit to include this condition so you are using the correct denominator if your dataset does have missing values. This tells you that you had 386 observations, and there were 205 where sex was coded as 1, an observation proportion of 0.53. Now the assumed proportion was 0.5, giving an expected number of 193 women. These two values are quite close and the p-value is 0.2. 3.3 Assignments # Copy and paste this code to load the data for week 3 assignments lesson3a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3a.rds&quot;)) lesson3b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3b.rds&quot;)) lesson3c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3c.rds&quot;)) lesson3d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3d.rds&quot;)) lesson3e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3e.rds&quot;)) lesson3f &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3f.rds&quot;)) Again, more questions than you need to do, unless youre keen (also, most wont take long). Try to do at least the first three. lesson3a.rds: These are data from over 1000 patients undergoing chemotherapy reporting a nausea and vomiting score from 0 to 10 on the day of treatment. Does previous chemotherapy increase nausea scores? What about sex? lesson3b.rds: Patients with wrist osteoarthritis are randomized to a new drug or placebo. Pain is measured before and two hours after taking a dose of the drug. Is the drug effective? lesson3c.rds: Some postoperative pain data again. Is pain on day 2 different than pain on day 1? Is pain on day 3 different from pain on day 2? lesson3d.rds: This is a single-arm, uncontrolled study of acupuncture for patients with neck pain. Does acupuncture increase range of motion? Just as many men as women get neck pain. Can we say anything about the sample chosen for this trial with respect to gender? The mean age of patients with neck pain is 58.2 years. Is the trial population representative with respect to age? lesson3e.rds: These data are length of stay from two different hospitals. One of the hospitals uses a new chemotherapy regimen that is said to reduce adverse events and therefore length of stay. Does the new regimen decrease length of stay? lesson3f.rds: These data are from a randomized trial on the effects of physiotherapy treatment on physical function in pediatric patients recovering from cancer surgery. Function is measured on a 100 point scale. Does physiotherapy help improve physical functioning? "],["week-4.html", "4 Week 4 4.1 Setting Up 4.2 R Instructions 4.3 Assignments", " 4 Week 4 4.1 Setting Up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Load data necessary to run Week 4 examples lesson2a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2a.rds&quot;)) lesson3a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3a.rds&quot;)) example4a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;example4a.rds&quot;)) 4.2 R Instructions Here are some of the commands you might use when analyzing epidemiological data or data that has a similar form. For example, if you had two variables diet (where 1 = high fat, 0 = low fat) and hypertension, you could use the same forms of analysis regardless of whether you were investigating a randomized trial (dietary advice assigned randomly to patients) or an epidemiological study (patients interviewed about eating habits). You can also use these methods for lab data (e.g. proportion of mice with a knockout versus wild type who develop a tumor). 4.2.1 Tables The first command is the tbl_summary function from the gtsummary package which makes a table. This was introduced in the week 1 lesson. We are interested in two-way tables. In other words, we are not interested in just how many people had hypertension, but in the number of people who had hypertension in each different category of diet. Ill use the dataset for assignment 3a (lesson3a.rds) to illustrate these points. This dataset includes patients who had prior chemotherapy, patient sex, and whether patients had postoperative nausea and vomiting. # Create twoway table of prior chemotherapy by sex tbl_summary( lesson3a %&gt;% select(pc, sex), by = sex, type = list(&quot;pc&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 5231 1, N = 5751 previous chemo:1 if yes 0 160 (51%) 161 (50%) 1 156 (49%) 162 (50%) Unknown 207 252 1 n (%) So, for example, we can see that there were 575 women, 162 had prior chemo and 161 had no prior chemo. You can see that 252 women were missing data on prior chemotherapy use. By default, the table shows the percent among all observations with non-missing data. This table also tells us that among men with prior chemotherapy data available, 51% had no prior chemo, and 49% had prior chemo. As mentioned in lesson 2, the tbl_summary command gives column percentages by default, but can also give row percents using the percent = \"row\" option: # Create twoway table with &quot;overall&quot; column and display row percents tbl_summary( lesson3a %&gt;% select(pc, sex), by = sex, type = list(&quot;pc&quot; ~ &quot;categorical&quot;), percent = &quot;row&quot; ) %&gt;% add_overall(last = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 5231 1, N = 5751 Overall, N = 1,0981 previous chemo:1 if yes 0 160 (50%) 161 (50%) 321 (100%) 1 156 (49%) 162 (51%) 318 (100%) Unknown 207 252 459 1 n (%) # Setting the &quot;last&quot; option to TRUE puts the column with statistics for the overall cohort in the last column of the table # The defaults etting, &quot;last = FALSE&quot;, would put this column first in the table So of the 318 patients who had previous chemo, 51% were women and 49% were men. Now lets use the marathon data (lesson2a.rds) to do something more interesting. First, I created a new category called subfourhour for those runners who completed the marathon in less than four hours. # Create a new variable that indicates whether patients had marathon time &lt;= 240 minutes lesson2a &lt;- lesson2a %&gt;% mutate(subfourhour = if_else(rt &lt;= 240, 1, 0)) The table function is a way to make very simple tables, which is useful for doing statistical tests, although these tables do not provide as much information (variable names, totals, percentages, etc.) as tbl_summary. # The first variable is the row variable # The second variable is the column variable table(lesson2a$subfourhour, lesson2a$sex) ## ## 0 1 ## 0 30 21 ## 1 36 11 We can compare sub-four hour marathons by sex using a chi-squared test (chisq.test function). The option correct = FALSE indicates that the default continuity correction should not be used. # Create the table and then perform the chi-squared test table(lesson2a$subfourhour, lesson2a$sex) %&gt;% chisq.test(correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: . ## X-squared = 3.513, df = 1, p-value = 0.06089 As a note, we can also use tbl_summary and the add_p function (also from gtsummary) to get the chi-squared p-value. In the add_p function, we specify that for the variable subfourhour we want to use a chi-squared test (chisq.test.no.correct). Specifying chisq.test.no.correct uses no continuity correction, and so gives the same result as the chisq.test function with the option correct = FALSE. # Create two-way table including chi-squared p-value tbl_summary( lesson2a %&gt;% select(subfourhour, sex), by = sex, type = list(&quot;subfourhour&quot; ~ &quot;categorical&quot;) ) %&gt;% add_p(test = list(&quot;subfourhour&quot; ~ &quot;chisq.test.no.correct&quot;)) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 661 1, N = 321 p-value2 subfourhour 0.061 0 30 (45%) 21 (66%) 1 36 (55%) 11 (34%) 1 n (%) 2 Pearson's Chi-squared test So whereas 55% of men completed the race in less than four hours, only 34% of women did so. The p-value here is 0.061. Should you categorize a continuous variable? If you are interested only: Remember that the p-value when we did a t-test (t.test(rt ~ sex, data = lesson2a, var.equal = TRUE)) was 0.032. That is, the p-value was lower when we kept race time as a continuous variable, than when we categorized it. The reason is that we are losing information: we are treating someone who ran the race in 2.5 hours the same as someone who ran it in 3.9 hours. So in general, you should avoid turning continuous variables into categorical variables for the purposes of statistical analysis. 4.2.2 Getting estimates: risk difference, risk ratio, odds ratio This table gives you a p-value, but not an estimate. For this, we need the epi.2by2 function from the epiR package. This function works for cohort studies and applies equally well to formal epidemiologic studies, retrospective analysis of datasets (such as in this marathon running example) or for randomized trials. You will give the epi.2by2 function the endpoint and the cohort (see below for more details). Endpoint will be something like cancer, response, progression, or running a marathon in under four hours. Cohort is what you think might make a difference, like a toxin, chemotherapy, a genetic mutation, or gender. The language weve been using is a little unusual for this example. A case is running a marathon in under four hours (i.e., subfourhour == 1). Exposed means that you are a woman (i.e. sex == 1). Risk means the proportion of patients who were a case. Odds, odds ratios, risk and relative risk The epi.2by2 function will give you a number of different estimates, including the odds, odds ratio, risk and relative risk. Note that in the epi.2by2 output, the risk is in the column \"Inc risk *\" and the relative risk is listed as Inc risk ratio under Point estimates and 95% CIs. The probability of something is defined as the number of times it occurs divided by the total number of observations. If you do a study of 1000 patients, of whom 250 experience a surgical complication, youd say that the probability of a complication was 250 ÷ 1000 = 25%. The odds of something is defined as the number of times it occurs divided by the number of times it doesnt occur. The odds of a complication are therefore 250 ÷ 750 = 1 ÷ 3 = 0.33. Here are some examples of probabilities and odds: html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qzjvxzfwte .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qzjvxzfwte .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qzjvxzfwte .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qzjvxzfwte .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qzjvxzfwte .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qzjvxzfwte .gt_column_spanner_outer:first-child { padding-left: 0; } #qzjvxzfwte .gt_column_spanner_outer:last-child { padding-right: 0; } #qzjvxzfwte .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qzjvxzfwte .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_from_md > :first-child { margin-top: 0; } #qzjvxzfwte .gt_from_md > :last-child { margin-bottom: 0; } #qzjvxzfwte .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qzjvxzfwte .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qzjvxzfwte .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qzjvxzfwte .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_sourcenote { font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_left { text-align: left; } #qzjvxzfwte .gt_center { text-align: center; } #qzjvxzfwte .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qzjvxzfwte .gt_font_normal { font-weight: normal; } #qzjvxzfwte .gt_font_bold { font-weight: bold; } #qzjvxzfwte .gt_font_italic { font-style: italic; } #qzjvxzfwte .gt_super { font-size: 65%; } #qzjvxzfwte .gt_footnote_marks { font-style: italic; font-size: 65%; } Probability of the event (e.g. surgical complication) Probability of no event (e.g. no complication) Odds of the event 50% 50% 1.000 25% 75% 0.3333 10% 90% 0.1111 90% 10% 9.000 5% 95% 0.0526 2% 98% 0.0204 1% 99% 0.0101 One thing you might notice is that when something doesnt happen very often, the odds and the probability are very similar. So, for example, something with a probability of 5% (0.05) has an odds of 0.0526. This has important implications for interpreting odds ratios. You will often see in the literature something like the odds ratio for stage was 1.26, so patients with high stage disease had a 26% higher risk of complications. This statement is wrong because if the odds ratio is 1.26 then the odds are 26% higher, not the risk. The odds ratio and relative risk will only be similar if the probability of an event is low. A doubling of risk from 1% to 2% is an increase in odds from 0.0101 to 0.0204, so very close to an odds ratio of 2. But a doubling of risk from 25% to 50% is an odds ratio of 3 (odds of 0.3333 to odds of 1.000). Coding epi.2by2 function The epi.2by2 function takes a two-way table with the endpoint and the cohort. We can create a very simple table using the table function with the cohort variable first (as rows), and the case variable second (as columns). # Create a two-way table table(lesson2a$sex, lesson2a$subfourhour) ## ## 0 1 ## 0 30 36 ## 1 21 11 However, for the epi.2by2 function, we need the first row to be the exposed group (in this case, sex == 1) and the first column be the case group (subfourhour == 1), so that we are comparing exposed to non-exposed, rather than comparing non-exposed to exposed. By default, R will sort the table numerically, so by default the first table row will be the non-exposed group (sex == 0) and the first column will be the control group (subfourhour == 0). Since the rows and columns are out of order, we will first convert the table to the correct format. You do not need to remember this code - you can simply copy and paste, and replace the dataset name (lesson2a) and variable names (sex, subfourhour) as necessary. # This code creates the table with the correct format matrix(rev(table(lesson2a$sex, lesson2a$subfourhour)), nrow = 2) ## [,1] [,2] ## [1,] 11 21 ## [2,] 36 30 # For those who are curious, here is a description of the functions above: # &quot;table&quot; - creates the two-way table above # &quot;rev&quot; - reverses the order of the table # &quot;matrix(..., nrow = 2)&quot; converts the reversed data back into a two-by-two table You will see here that now both the rows and the columns are reversed in this table. You can put this code directly into the epi.2by2 function. By default, the epi.2by2 function gives the p-value without any continuity correction. # Apply the epi.2by2 function to the table in the correct format epi.2by2(matrix(rev(table(lesson2a$sex, lesson2a$subfourhour)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 11 21 32 34.4 0.524 ## Exposed - 36 30 66 54.5 1.200 ## Total 47 51 98 48.0 0.922 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 0.63 (0.37, 1.07) ## Odds ratio 0.44 (0.18, 1.05) ## Attrib risk * -20.17 (-40.54, 0.20) ## Attrib risk in population * -6.59 (-22.15, 8.97) ## Attrib fraction in exposed (%) -58.68 (-168.76, 6.32) ## Attrib fraction in population (%) -13.73 (-29.44, 0.07) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 3.513 Pr&gt;chi2 = 0.06 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units So reading this table we get the following information: There were 32 women (Exposed + row, Total column) and 66 men (Exposed - row, Total column), a total of 98 patients (Total row and column) 11 of the women finished the race in under four hours (Exposed + row, Outcome + column), 21 did not (Exposed + row, Outcome - column). 36 of the men finished the race in under four hours (Exposed - row, Outcome + column), 30 did not (Exposed - row, Outcome - column) 34.4% of the women (Exposed + column, Inc risk * row) and 54.5% of the men (Exposed - column, Inc risk * row) finished in under four hours. 20% more men finished the race in under four hours (Attrib risk * under Point estimates and 95% CIs). This is the absolute difference in rates of sub-four hour marathon in men and women. After the estimate of the difference in rates is shown the 95% confidence interval around this difference: from 41% more to 0.20% less. The chance that a woman finishes the race in under four hours is 0.63 of that for a man (Inc risk ratio under Point estimates and 95% CIs). The 95% CI is 0.37 to 1.07 (i.e about one third as likely to 7% more likely). The odds ratio is reported in the second row under Point estimates and 95% CIs and indicates the relative difference in odds. Be aware that when interpreting a relative difference in risks, it is useful to know the absolute risk as well. A study may report that a drug reduces the risk of heart attack by 50%, but whether you choose to use the drug would depend on whether risk was reduced from 20% to 10% (a 50% relative difference and a 10% absolute difference) or whether risk was reduced from 2% to 1% (still a 50% relative difference but only a 1% absolute difference). Here is another one to look through: # Another example using &quot;epi.2by2&quot; function epi.2by2(matrix(rev(table(example4a$toxin, example4a$cancer)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 5 3 8 62.5 1.667 ## Exposed - 1 7 8 12.5 0.143 ## Total 6 10 16 37.5 0.600 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 5.00 (0.74, 33.78) ## Odds ratio 11.67 (0.92, 147.56) ## Attrib risk * 50.00 (9.37, 90.63) ## Attrib risk in population * 25.00 (-7.98, 57.98) ## Attrib fraction in exposed (%) 80.00 (-35.11, 97.04) ## Attrib fraction in population (%) 66.67 (-69.30, 93.44) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 4.267 Pr&gt;chi2 = 0.04 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units Here it is easier to see that the toxin is the exposure and cancer is whether you are a case. Exact statistics Now Ill explain what these are in more detail in the box below for whoever is interested. But for now, what everyone needs to now is that many statisticians, myself included, prefer exact statistics and if any of the cells in your table have five or fewer observations, all statisticians agree that you should use exact methods. A cell is one box in your table, such as the number of cancer patients who were not exposed to the toxin, or the number of non-cancer patients who were exposed to the toxin. The epi.2by2 function gives the chi-squared p-value. However, using the fisher.test function gives the exact p-value. You do not need to reverse the table for the fisher.test function. # Calculate p-value from fisher&#39;s exact test fisher.test(table(example4a$toxin, example4a$cancer)) ## ## Fisher&#39;s Exact Test for Count Data ## ## data: table(example4a$toxin, example4a$cancer) ## p-value = 0.1189 ## alternative hypothesis: true odds ratio is not equal to 1 ## 95 percent confidence interval: ## 0.6795665 625.2181311 ## sample estimates: ## odds ratio ## 9.760631 Similar to the chi-squared test, you can also get the Fishers exact p-value using the tbl_summary and add_p functions, by specifying test = \"fisher.test\" for the variable of interest. # Create formatted table with p-value from fisher&#39;s exact test tbl_summary( example4a %&gt;% select(toxin, cancer), by = cancer, type = list(&quot;toxin&quot; ~ &quot;categorical&quot;) ) %&gt;% add_p(test = list(&quot;toxin&quot; ~ &quot;fisher.test&quot;)) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pqsnuprvju .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pqsnuprvju .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pqsnuprvju .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #pqsnuprvju .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pqsnuprvju .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pqsnuprvju .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pqsnuprvju .gt_column_spanner_outer:first-child { padding-left: 0; } #pqsnuprvju .gt_column_spanner_outer:last-child { padding-right: 0; } #pqsnuprvju .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #pqsnuprvju .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #pqsnuprvju .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pqsnuprvju .gt_from_md > :first-child { margin-top: 0; } #pqsnuprvju .gt_from_md > :last-child { margin-bottom: 0; } #pqsnuprvju .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pqsnuprvju .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #pqsnuprvju .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pqsnuprvju .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #pqsnuprvju .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pqsnuprvju .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pqsnuprvju .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pqsnuprvju .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pqsnuprvju .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #pqsnuprvju .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_sourcenote { font-size: 90%; padding: 4px; } #pqsnuprvju .gt_left { text-align: left; } #pqsnuprvju .gt_center { text-align: center; } #pqsnuprvju .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pqsnuprvju .gt_font_normal { font-weight: normal; } #pqsnuprvju .gt_font_bold { font-weight: bold; } #pqsnuprvju .gt_font_italic { font-style: italic; } #pqsnuprvju .gt_super { font-size: 65%; } #pqsnuprvju .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 101 1, N = 61 p-value2 Toxin exposure 0.12 0 7 (70%) 1 (17%) 1 3 (30%) 5 (83%) 1 n (%) 2 Fisher's exact test For keen students only: Lets imagine that you and I each throw two coins. I throw two heads and you throw two tails. The p-value you get from a chi squared is 0.046, which seems strange as what we threw doesnt seem that unusual. The problem is that in chi squared analysis you compare the expected and observed values, add them up, get a value for chi, and then look this up on a table. Now this table is derived from a distribution based on large samples. It is an approximation that breaks down when numbers are very small (such as less than 5 in at least one cell). Exact statistics works out the probability of a certain result in a different way, without reference to distributions or approximations. The exact approach to the coin throwing problem would be to write out all the possible tables you could have with four observations, and then work out the probability of each under the null hypothesis. Then count what proportion of tables are as unlikely or more unlikely than the observed results and you get your p-value. It turns out that there are 9 possible outcomes for the coin throwing problem: 0 vs. 0; 0 vs 1; 0 vs. 2; 1 vs. 0; 1 vs. 1; 1 vs. 2; 2 vs. 0; 2 vs 1; 2 vs. 2. Two of these (0 vs. 2 and 2 vs. 0), are at least as extreme as the result we got, so that gives a p-value of 0.33. Other Commands You can use the filter command to select rows to perform t-tests on subgroups of your data. For example, to assess the association between nausea/vomiting and sex only among those patients who had a history of prior chemotherapy, you can use the following code: # Perform a t-test only among patients with prior chemotherapy t.test(nv ~ sex, data = lesson3a %&gt;% filter(pc == 1)) ## ## Welch Two Sample t-test ## ## data: nv by sex ## t = -0.078122, df = 251.57, p-value = 0.9378 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.5219692 0.4821391 ## sample estimates: ## mean in group 0 mean in group 1 ## 5.270161 5.290076 To perform the t-test on those without prior chemotherapy, switch the group you are filtering on: # t-test for patients without prior chemotherapy t.test(nv ~ sex, data = lesson3a %&gt;% filter(pc == 0)) ## ## Welch Two Sample t-test ## ## data: nv by sex ## t = 0.2822, df = 254.8, p-value = 0.778 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.4171295 0.5566757 ## sample estimates: ## mean in group 0 mean in group 1 ## 4.492537 4.422764 4.3 Assignments # Copy and paste this code to load the data for week 4 assignments lesson4a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4a.rds&quot;)) lesson4b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4b.rds&quot;)) lesson4c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4c.rds&quot;)) lesson4d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4d.rds&quot;)) lesson4e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4e.rds&quot;)) This weeks assignment concerns techniques developed to assess epidemiologic data. But remember that a number is just a number: the techniques for working out the relative risk of getting breast cancer if you has a silicone breast implant is exactly the same as working out the relative risk of death in transgenic mice exposed to a carcinogen. Try to do the ones in bold, get to the non-bolded ones if you can. lesson4a.rds: This is a dataset on fifteen patients recording whether they had problematic nausea or vomiting after chemotherapy (defined as grade 2 or higher for either nausea or vomiting) and whether they reported being prone to travel sickness. Does travel sickness predict chemotherapy nausea and vomiting? lesson4b.rds: An epidemiological study of meat consumption and hypertension in older Americans. Meat consumption was defined as low, medium or high depending on whether subjects ate less than 3, 3 to 7 or 7 + meals with meat in per week. Does meat consumption lead to hypertension? lesson4c.rds: This is a dataset from a chemotherapy study. The researchers think that a mutation of a certain gene may be associated with chemotherapy toxicity. Should clinicians test for the gene during pre-chemotherapy work up? lesson4d.rds: Patients with lung cancer are randomized to receive either chemotherapy regimen a or b and assessed for tumor response. Which regimen would you recommend to a patient? Do the treatments work differently depending on age or sex? lesson4e.rds: This is a lab study of two candidate tumor-suppressor genes (gene1 and gene2). Wild-type mice are compared with mice that have gene1 knocked-out, gene2 knocked-out or both. The presence of tumors is measured after 30 days. Do the genes suppress cancer? "],["week-5.html", "5 Week 5 5.1 Setting Up 5.2 R Instructions 5.3 Assignments", " 5 Week 5 5.1 Setting Up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Load data necessary to run Week 5 examples lesson2b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2b.rds&quot;)) lesson3d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3d.rds&quot;)) lesson4d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4d.rds&quot;)) lesson5a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5a.rds&quot;)) example5a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;example5a.rds&quot;)) example5b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;example5b.rds&quot;)) 5.2 R Instructions 5.2.1 Correlation Correlating two or more variables is very easy: just use the cor function and then the dataset and selected variables. For example, if you use the lesson2b.rds dataset and correlate the first four pain scores, you get the following table: # Display the correlation between variables l01, l02, l03 and l04 cor(lesson2b %&gt;% select(l01, l02, l03, l04)) ## l01 l02 l03 l04 ## l01 1.0000000 0.7900984 0.6270860 0.5395075 ## l02 0.7900984 1.0000000 0.8145025 0.7148299 ## l03 0.6270860 0.8145025 1.0000000 0.8383224 ## l04 0.5395075 0.7148299 0.8383224 1.0000000 This shows, for example, that the correlation between l01 and l02 is 0.79 and the correlation between l02 and l04 is 0.71. From the table you can easily see that pain scores taken on consecutive days are more strongly correlated than those taken two or three days apart. If the data are skewed, you can try a regression based on ranks, what is known as Spearmans rank correlation. What youd type is the same as above, but adding the option method = \"spearman\". # Calculate the Spearman correlation for skewed data cor(lesson2b %&gt;% select(l01, l02, l03, l04), method = &quot;spearman&quot;) ## l01 l02 l03 l04 ## l01 1.0000000 0.7799856 0.6220233 0.5443327 ## l02 0.7799856 1.0000000 0.8126008 0.7220277 ## l03 0.6220233 0.8126008 1.0000000 0.8324906 ## l04 0.5443327 0.7220277 0.8324906 1.0000000 5.2.2 Linear regression Linear regression is when you try to predict a continuous variable. The function to use is lm. The first variable is the dependent variable (e.g. blood pressure) and must be continuous. The other variables are the predictor variables and can be binary or continuous: in some cases you can use ordinal variables but you have to be careful. Well deal with categorical variables later in the course. The dependent and predictor variables are separated by a ~, and multiple predictor variables are separated by +. Lets use the data from lesson3d.rds as an example dataset. We want to see if we can predict a patients range of motion after treatment (variable a) in terms of their age, sex and pre-treatment range of motion (variable b). # Linear regression model for a, predictors are sex, age and b lm(a ~ sex + age + b, data = lesson3d) ## ## Call: ## lm(formula = a ~ sex + age + b, data = lesson3d) ## ## Coefficients: ## (Intercept) sex age b ## 138.7336 2.8524 -0.4359 0.6692 This gives you the very basic information from the regression, but you can get more information using the summary function: # Save out linear regression model rom_model &lt;- lm(a ~ sex + age + b, data = lesson3d) # Show additional model results summary(rom_model) ## ## Call: ## lm(formula = a ~ sex + age + b, data = lesson3d) ## ## Residuals: ## Min 1Q Median 3Q Max ## -60.135 -11.943 3.238 14.523 47.732 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 138.73363 29.50514 4.702 5.40e-05 *** ## sex 2.85241 10.25817 0.278 0.783 ## age -0.43589 0.27770 -1.570 0.127 ## b 0.66924 0.07816 8.563 1.49e-09 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 25.29 on 30 degrees of freedom ## Multiple R-squared: 0.7475, Adjusted R-squared: 0.7222 ## F-statistic: 29.6 on 3 and 30 DF, p-value: 4.241e-09 The first column of numbers listed under Coefficients are the coefficients. You can interpret this as follows: start with 138.7 degrees of range of motion (the intercept or constant). Then add 2.85 if the patient is a woman, and take away 0.436 degrees for every year of age. Finally, add 0.669 degrees for every degree of range of motion the patient had before the trial. Lets take a single patient: a 54 year old woman with a range of motion of 301 before treatment. Her predicted range of motion afterwards is 138.7 + 2.85 - 0.436*54 + 0.669*301 = 319.5. Her actual figure was 325, so we predicted quite well for this patient. You can get R to do this automatically using the augment function from the broom package. # The &quot;augment&quot; function creates a dataset of all patients included in the model # and all variables included in the model, as well as the predictions lesson3d_pred &lt;- augment(rom_model) # Print out new dataset to show output from &quot;augment&quot; # The &quot;.fitted&quot; column is your prediction # You can ignore all columns to the right of &quot;.fitted&quot; lesson3d_pred ## # A tibble: 34 x 10 ## a sex age b .fitted .resid .hat .sigma .cooksd .std.resid ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 247 1 24 263 307. -60.1 0.201 22.5 0.447 -2.66 ## 2 324 0 73 339 334. -9.79 0.129 25.7 0.00638 -0.415 ## 3 351 0 40 361 363. -11.9 0.0947 25.6 0.00639 -0.494 ## 4 232 0 74 234 263. -31.1 0.113 25.0 0.0540 -1.30 ## 5 328 0 51 329 337. -8.68 0.0542 25.7 0.00178 -0.353 ## 6 380 0 26 376 379. 0.966 0.164 25.7 0.0000853 0.0417 ## 7 302 0 54 297 314. -12.0 0.0411 25.6 0.00250 -0.483 ## 8 254 0 39 249 288. -34.4 0.0832 24.8 0.0457 -1.42 ## 9 250 1 65 244 277. -26.5 0.131 25.2 0.0480 -1.13 ## 10 252 0 81 246 268. -16.1 0.144 25.5 0.0197 -0.686 ## # ... with 24 more rows To get the number of observations, coefficients, 95% confidence interval and p-values printed in a table for all covariates, you can use the tbl_regression function from the gtsummary package: # Print formatted table of regression results tbl_regression(rom_model) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic Beta 95% CI1 p-value 1=female 2.9 -18, 24 0.8 age -0.44 -1.0, 0.13 0.13 range of motion before acupuncture 0.67 0.51, 0.83 1 CI = Confidence Interval For example, for sex, the 95% CI is -18 to 24, meaning that women might plausibly have a range of motion anywhere from 18 degrees less than men to 24 degrees more. In short, we dont have any strong evidence that sex has an effect on range of motion at all and we can see this reflected in the p-value, p=0.8. There are 34 patients included in this model. You can determine the number of observations included in the model using the nobs() function, or you can update the table to include this number in the header. # To get the number of observations in the model nobs(rom_model) ## [1] 34 # By default, the number of observations is not shown in &quot;tbl_regression&quot; # You can use the code below to print the number of observations in the table header tbl_regression(rom_model) %&gt;% modify_header( label ~ &quot;**Characteristic (N = {N})**&quot; ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic (N = 34) Beta 95% CI1 p-value 1=female 2.9 -18, 24 0.8 age -0.44 -1.0, 0.13 0.13 range of motion before acupuncture 0.67 0.51, 0.83 1 CI = Confidence Interval # Summary of linear regression results summary(rom_model) ## ## Call: ## lm(formula = a ~ sex + age + b, data = lesson3d) ## ## Residuals: ## Min 1Q Median 3Q Max ## -60.135 -11.943 3.238 14.523 47.732 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 138.73363 29.50514 4.702 5.40e-05 *** ## sex 2.85241 10.25817 0.278 0.783 ## age -0.43589 0.27770 -1.570 0.127 ## b 0.66924 0.07816 8.563 1.49e-09 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 25.29 on 30 degrees of freedom ## Multiple R-squared: 0.7475, Adjusted R-squared: 0.7222 ## F-statistic: 29.6 on 3 and 30 DF, p-value: 4.241e-09 At the bottom of the summary readout there are a few miscellaneous tidbits: The p-value next to the F-statistic on the last line tells you whether, as a whole, your model, including the constant and three variables, is a statistically significant predictor. The Multiple R-squared value (often referred to as just r squared) tells you how good a predictor it is on a scale from 0 to 1. Well discuss the meaning of r squared in more detail, but it is defined as the proportion of variation that you can explain using your model. 5.2.3 Graphing the data Graphing the data is done using the ggplot function from the ggplot2 package. In short, the main inputs for the ggplot function are your dataset, the x variable and the y variable. You can then create a number of different plots using this data. To create a scatterplot, the geom_point function is added to the ggplot function: # Create a scatterplot of race time by age ggplot(data = lesson5a, aes(x = age, y = rt)) + geom_point() This scatterplot from the lesson5a.rds data shows race time and age for every runner in the study. This is a useful way of getting a feel for the data before you start. 5.2.4 Logistic regression Logistic regression is used when the variable you wish to predict is binary (e.g. relapsed or not). The function to use is glm, with the option family = \"binomial\" to indicate that our outcome variable is binary. Again, the first variable is the dependent variable (e.g. hypertension) and must be binary. The other variables are the predictor variables and can be binary or continuous: again, in some cases you can use ordinal variables but you have to be careful. The variables are entered into the glm function the same way as the lm function (dependent ~ predictor1 + predictor2 + ). Well use the dataset lesson4d.rds as an example. # Create a logistic regression model for response, predictors are age, sex and group response_model &lt;- glm(response ~ age + sex + group, data = lesson4d, family = &quot;binomial&quot;) # Look at additional model results summary(response_model) ## ## Call: ## glm(formula = response ~ age + sex + group, family = &quot;binomial&quot;, ## data = lesson4d) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.3760 -1.0954 -0.9119 1.2366 1.5590 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.967546 0.447037 2.164 0.0304 * ## age -0.023270 0.009807 -2.373 0.0177 * ## sex -0.180196 0.234045 -0.770 0.4413 ## group -0.318300 0.205037 -1.552 0.1206 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 546.87 on 397 degrees of freedom ## Residual deviance: 538.18 on 394 degrees of freedom ## (2 observations deleted due to missingness) ## AIC: 546.18 ## ## Number of Fisher Scoring iterations: 4 By default, R gives the coefficients in logits for logistic regression models. To easily see the coefficients and 95% confidence intervals for all covariates as odds ratio, we can again use the tbl_regression function. In this case, we use the option exponentiate = TRUE, which indicates that odds ratios (not logits) should be presented. (You can also use this function to see the formatted logit results by using the exponentiate = FALSE option.) # Create logistic regression model glm(response ~ age + sex + group, data = lesson4d, family = &quot;binomial&quot;) %&gt;% # Pass to tbl_regression to show formatted table with odds ratios tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 0.98 0.96, 1.00 0.018 1 if woman, 0 if man 0.84 0.53, 1.32 0.4 1 if b, 0 if a 0.73 0.49, 1.09 0.12 1 OR = Odds Ratio, CI = Confidence Interval The key things here are the odds ratios: you can say that the odds of response is multiplied by 0.98 for a one year increase in age; that women have an odds of response 0.84 of that for the men, though this is not statistically significant, and that response is lower in group 1, with an odds of 0.73 (you would also cite the p-value and 95% CIs). The problem here is that you cant use any of these data to work out an individual patients chance of response. Now you can get R to do this for you using the augment function. For a binary outcome, you need to specify type.predict = \"response\" as an option so that you will get predicted probabilities (not log odds). # Get predictions from logistic regression model # type.predict = &quot;response&quot; gives predicted probabilities lesson4d_pred &lt;- augment(response_model, type.predict = &quot;response&quot;) # Look at the dataset containing predicted probabilities (.fitted variable) # You can ignore all columns to the right of &quot;.fitted&quot; lesson4d_pred ## # A tibble: 398 x 11 ## .rownames response age sex group .fitted .resid .std.resid .hat .sigma ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 1 47 0 0 0.469 1.23 1.24 0.00612 1.17 ## 2 2 0 47 0 0 0.469 -1.12 -1.13 0.00612 1.17 ## 3 3 1 25 0 0 0.595 1.02 1.03 0.0129 1.17 ## 4 4 0 53 0 1 0.358 -0.941 -0.945 0.00841 1.17 ## 5 5 1 64 0 0 0.372 1.41 1.42 0.0154 1.17 ## 6 6 0 50 0 1 0.374 -0.968 -0.972 0.00738 1.17 ## 7 7 1 34 0 1 0.465 1.24 1.24 0.00838 1.17 ## 8 8 0 68 0 1 0.282 -0.814 -0.822 0.0178 1.17 ## 9 9 0 49 0 0 0.457 -1.11 -1.11 0.00659 1.17 ## 10 10 0 44 0 1 0.407 -1.02 -1.03 0.00641 1.17 ## # ... with 388 more rows, and 1 more variable: .cooksd &lt;dbl&gt; NOTE: The lesson4d_pred dataset only includes 398 patients. If you look at the table above, you will see at the top that only 398 patients were included in the model. Any patients who are missing data for the outcome or any predictors will be excluded from the model, and will not be included in the predicted dataset. If you want to look at calculating predictions from logistic regression in more detail, youll need logit (see below). One thing to be careful about is categorical variables. Imagine that you had the patients age and cancer stage (1, 2, 3 or 4) and wanted to know whether they recurred. If you tried glm(recurrence ~ age + stage, ...), then stage would be treated as if the increase in risk going from stage 1 to 2 was exactly the same as that going from 2 to 3 and 3 to 4. To tell R that it is a categorical variable, you need to use the factor function with the categorical variable: # Create a model for recurrence using the categorical variable &quot;stage&quot; recurrence_model &lt;- glm(recurrence ~ age + factor(stage), data = example5a, family = &quot;binomial&quot;) # Show the results of this model summary(recurrence_model) ## ## Call: ## glm(formula = recurrence ~ age + factor(stage), family = &quot;binomial&quot;, ## data = example5a) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.8330 -0.8557 -0.5887 1.0807 2.1078 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -3.410438 0.309203 -11.030 &lt; 2e-16 *** ## age 0.042057 0.005531 7.604 2.87e-14 *** ## factor(stage)2 0.996064 0.152510 6.531 6.53e-11 *** ## factor(stage)3 1.655345 0.260107 6.364 1.96e-10 *** ## factor(stage)4 1.771858 0.292687 6.054 1.41e-09 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1369.7 on 1063 degrees of freedom ## Residual deviance: 1212.9 on 1059 degrees of freedom ## AIC: 1222.9 ## ## Number of Fisher Scoring iterations: 3 # Formatted to show odds ratios recurrence_model %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qzjvxzfwte .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qzjvxzfwte .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qzjvxzfwte .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qzjvxzfwte .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qzjvxzfwte .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qzjvxzfwte .gt_column_spanner_outer:first-child { padding-left: 0; } #qzjvxzfwte .gt_column_spanner_outer:last-child { padding-right: 0; } #qzjvxzfwte .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qzjvxzfwte .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_from_md > :first-child { margin-top: 0; } #qzjvxzfwte .gt_from_md > :last-child { margin-bottom: 0; } #qzjvxzfwte .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qzjvxzfwte .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qzjvxzfwte .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qzjvxzfwte .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_sourcenote { font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_left { text-align: left; } #qzjvxzfwte .gt_center { text-align: center; } #qzjvxzfwte .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qzjvxzfwte .gt_font_normal { font-weight: normal; } #qzjvxzfwte .gt_font_bold { font-weight: bold; } #qzjvxzfwte .gt_font_italic { font-style: italic; } #qzjvxzfwte .gt_super { font-size: 65%; } #qzjvxzfwte .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 1.04 1.03, 1.05 factor(stage) 1 &mdash; &mdash; 2 2.71 2.01, 3.66 3 5.23 3.16, 8.79 4 5.88 3.34, 10.6 1 OR = Odds Ratio, CI = Confidence Interval What you can see here is that stage is broken into categories. The odds ratio is given comparing each stage to stage 1 (the reference). So the odds of recurrence is 2.71 higher for stage 2 compared to stage 1, 5.23 for stage 3 compared to stage 1 and 5.88 for stage 4 compared to stage 1. For keen students only! Here we look at our response model on the logit scale. # Look at details of &quot;response&quot; logistic regression model summary(response_model) ## ## Call: ## glm(formula = response ~ age + sex + group, family = &quot;binomial&quot;, ## data = lesson4d) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.3760 -1.0954 -0.9119 1.2366 1.5590 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.967546 0.447037 2.164 0.0304 * ## age -0.023270 0.009807 -2.373 0.0177 * ## sex -0.180196 0.234045 -0.770 0.4413 ## group -0.318300 0.205037 -1.552 0.1206 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 546.87 on 397 degrees of freedom ## Residual deviance: 538.18 on 394 degrees of freedom ## (2 observations deleted due to missingness) ## AIC: 546.18 ## ## Number of Fisher Scoring iterations: 4 Firstly, note that the p-values are the same, what differs is the coefficients. Now if you are really smart, youll notice that the coefficient is the natural log of the odds ratios above. You can use the coefficients to work out an individuals probability of response. We start with the constant, and subtract 0.0233 for each year of age and then subtract an additional 0.18 if a woman and 0.318 if in group 1. Call this number l for the log of the odds. The probability is el / (1 + el). Take a 53 year old man on regimen b (group 1): l = 0.968 + -0.0233*53 + -0.318, gives -0.5841. To convert, type exp(-0.5841) / (exp(-0.5841)+1) to get a probability of 35.8%. 5.2.5 Getting the area-under-the-curve Using regression models is a way to try to predict outcome based on the data we have. After weve created a model, we want to know - is the prediction from this model any good? One way to do this is by assessing the discrimination. For logistic regression, where we have a binary endpoint, discrimination tells us how well the model distinguishes between patients who have the event and patients who do not have the event. Discrimination is measured using the area-under-the-curve (AUC) and varies between 0.5 (a coin flip) and 1 (perfect discrimination). Imagine that you wanted to know how well a blood marker predicted cancer. Note that the blood marker could be continuous (e.g. ng/ml) or binary (positive or negative such as in a test for circulating tumor cells), it doesnt matter for our purposes. # Calculate the AUC using the &quot;roc&quot; function roc(cancer ~ marker, data = example5b) ## ## Call: ## roc.formula(formula = cancer ~ marker, data = example5b) ## ## Data: marker in 1865 controls (cancer 0) &lt; 635 cases (cancer 1). ## Area under the curve: 0.8143 So the marker has an area under the curve of 0.814. The roc function is particularly useful if you want to know the area-under-the-curve with and without a marker. For instance, the code below could tell you how much the area-under-the-curve increases when you add a new marker to a model to predict cancer that already includes age. First, get the AUC for the model with age only: # Calculate AUC of original model with age roc(cancer ~ age, data = example5b) ## ## Call: ## roc.formula(formula = cancer ~ age, data = example5b) ## ## Data: age in 1865 controls (cancer 0) &lt; 635 cases (cancer 1). ## Area under the curve: 0.6354 The roc function can only take one predictor variable. For a univariate model, such as the model assessing age above, you can put age directly into the roc function. If you want to assess a model with multiple variables, you can use the predicted value: # Create the multivariable model marker_model &lt;- glm(cancer ~ age + marker, data = example5b, family = &quot;binomial&quot;) # Use &quot;augment&quot; to get predicted probability marker_pred &lt;- augment(marker_model, type.predict = &quot;response&quot;) Now, calculate the AUC for the model with age and the marker by using the predicted probability based on the multivariable model: # Calculate AUC of model with age and marker roc(cancer ~ .fitted, data = marker_pred) ## ## Call: ## roc.formula(formula = cancer ~ .fitted, data = marker_pred) ## ## Data: .fitted in 1865 controls (cancer 0) &lt; 635 cases (cancer 1). ## Area under the curve: 0.7996 The AUC for the model including both age and the marker value is higher than for age alone, so we can conclude that the marker adds important predictiveness to age. 5.3 Assignments # Copy and paste this code to load the data for week 5 assignments lesson5a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5a.rds&quot;)) lesson5b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5b.rds&quot;)) lesson5c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5c.rds&quot;)) lesson5d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5d.rds&quot;)) lesson5e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5e.rds&quot;)) lesson5f &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5f.rds&quot;)) lesson5g &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5g.rds&quot;)) lesson5h &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5h.rds&quot;)) lesson5i &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5i.rds&quot;)) Regression is a very important part of statistics: I probably do more regressions that any other type of analysis, apart from than calculating basic summary data such as medians, means and proportions. So, Ive given you lots of possibilities here. Ive coded them: you really should try to do the bold ones, do those in italics if you can, and if you get to the rest, well, the more the merrier. The reason I have included all this is so I can go over it in class. lesson5a.rds: These are data from marathon runners (again). Which of the following is associated with how fast runners complete the marathon: age, sex, training miles, weight? lesson5b.rds: These are data on patients with a disease that predisposes them to cancer. The disease causes precancerous lesions that can be surgically removed. A group of recently removed lesions are analyzed for a specific mutation. Does how long a patient has had the disease affect the chance that a new lesion will have a mutation? lesson5c.rds: These are data from Canadian provinces giving population, unemployment rates and male and female life expectancy. Which of these variables are associated? lesson5d.rds: These are data from mice inoculated with tumor cells and then treated with different doses of a drug. The growth rate of each animals tumor is then calculated. Is this drug effective? lesson5e.rds: These are data from a study of the use of complementary medicine (e.g. massage) by UK breast cancer patients. There are data for the womens age, time since diagnosis, presence of distant metastases, use of complementary medicine before diagnosis, whether they received a qualification after high school, the age they left education, whether usual employment is a manual trade, socioeconomic status. What predicts use of complementary medicine by women with breast cancer? lesson5f.rds: These are the distance records for Frisbee for various ages in males. What is the relationship between age and how far a man can throw a Frisbee? lesson5g.rds: Youve seen this dataset before. Patients with lung cancer are randomized to receive either chemotherapy regime a or b and assessed for tumor response. We know there is no statistically significant difference between regimens (you can test this if you like). However, do the treatments work differently depending on sex? Do they work differently by age? lesson5h.rds: PSA is used to screen for prostate cancer. In this dataset, the researchers are looking at various forms of PSA (e.g. nicked PSA). What variables should be used to try to predict cancer? How accurate would this test be? (NOTE: these data were taken from a real dataset, but I played around with them a bit, so please dont draw any conclusions about PSA testing from this assignment). lesson5i.rds: This is a randomized trial of behavioral therapy in cancer patients with depressed mood (note that higher score means better mood). Patients are randomized to no treatment (group 1), informal contact with a volunteer (group 2) or behavior therapy with a trained therapist (group 3). What would you conclude about the effectiveness of these treatments? "],["week-6.html", "6 Week 6 6.1 Setting Up 6.2 R Instructions 6.3 Assignments", " 6 Week 6 6.1 Setting Up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Load data necessary to run Week 6 examples example6a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;example6a.rds&quot;)) 6.2 R Instructions 6.2.1 Diagnostic Tests For this, we will use the epi.tests function from the epiR package. Imagine you want to calculate the sensitivity. If you already know the counts for disease-positive and disease-negative, and test-positive and test-negative, you can easily create a table and use the epi.tests function. # Enter the data in the following order to create the 2x2 table # Disease-positive, test-positive # Disease-negative, test-positive # Disease-positive, test-negative # Disease-negative, test-negative tbl_disease_test &lt;- as.table(matrix(c(670, 202, 74, 640), nrow = 2, byrow = TRUE)) # The matrix function allows you to enter in the numbers and convert to a table # &quot;nrow = 2&quot; indicates that there should be 2 rows in the table (test-positive and test-negative) # &quot;byrow = TRUE&quot; correctly assigns the columns as &quot;disease-positive&quot; first and &quot;disease-negative&quot; second # Use the &quot;epi.tests&quot; function with the new 2x2 table epi.tests(tbl_disease_test) ## Outcome + Outcome - Total ## Test + 670 202 872 ## Test - 74 640 714 ## Total 744 842 1586 ## ## Point estimates and 95 % CIs: ## --------------------------------------------------------- ## Apparent prevalence 0.55 (0.52, 0.57) ## True prevalence 0.47 (0.44, 0.49) ## Sensitivity 0.90 (0.88, 0.92) ## Specificity 0.76 (0.73, 0.79) ## Positive predictive value 0.77 (0.74, 0.80) ## Negative predictive value 0.90 (0.87, 0.92) ## Positive likelihood ratio 3.75 (3.32, 4.24) ## Negative likelihood ratio 0.13 (0.11, 0.16) ## --------------------------------------------------------- Your result in this case is that sensitivity is 90%, with a 95% CI 88%, 92%. For reasons that I am not quite sure, most investigators do not cite 95% CI with sensitivity, specificity, etc. so stating just 90% is probably fine. You can also use this function with a dataset that includes a binary variable indicating disease positive or negative, and a binary variable indicating test positive or negative. Similar to the epi.2by2 function from week 4 (also from the epiR package), the table needs to be flipped so the columns and rows are correctly ordered. You can simply copy the code below and replace the inputs to the table function with your dataset, test variable, and disease (outcome) variable. # This is the same code for week 4 that reverses the order of columns and rows tbl_example6a &lt;- matrix(rev(table(example6a$test, example6a$disease)), nrow = 2) # Calculate sensitivity and specificity from table above epi.tests(tbl_example6a) ## Outcome + Outcome - Total ## Test + 20 180 200 ## Test - 10 1820 1830 ## Total 30 2000 2030 ## ## Point estimates and 95 % CIs: ## --------------------------------------------------------- ## Apparent prevalence 0.10 (0.09, 0.11) ## True prevalence 0.01 (0.01, 0.02) ## Sensitivity 0.67 (0.47, 0.83) ## Specificity 0.91 (0.90, 0.92) ## Positive predictive value 0.10 (0.06, 0.15) ## Negative predictive value 0.99 (0.99, 1.00) ## Positive likelihood ratio 7.41 (5.55, 9.89) ## Negative likelihood ratio 0.37 (0.22, 0.61) ## --------------------------------------------------------- As you can see, epi.tests also provides other information. Specificity and positive and negative predictive value you should know (remember that sensitivity is the probability of a positive result if you have the disease; specificity is the probability of a negative result if you dont have the disease; positive predictive value is the probability you have the disease if you test positive; negative predictive value is the probability that you dont have the disease if you test negative). True prevalence is the proportion of patients with disease in the data set. Apparent prevalence is a pretty misleading term and is the proportion of patients who test positive. You can generally ignore that, it isnt a commonly used statistic. Positive and negative likelihood ratios are used in Bayesian approaches to diagnostic tests and arent taught on this course, so dont worry about those for now. See instructions from lecture 5 on how to get an area-under-the-curve. 6.3 Assignments # Copy and paste this code to load the data for week 6 assignments lesson6a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6a.rds&quot;)) lesson6b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6b.rds&quot;)) lesson6c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6c.rds&quot;)) lesson6d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6d.rds&quot;)) lesson6a.rds and lesson6b.rds: These are data on a blood test (creatine kinase) to detect a recent myocardial infarct. The two datasets are from a coronary care unit population (lesson6a.rds) and a general hospital population (lesson6b.rds). What is the sensitivity, specificity, positive predictive value and negative predictive value? lesson6c.rds: Here are the data from a study of a marker to predict the results of biopsy for cancer. There are 2000 patients, half of whom had a suspicious imaging result and were biopsied. It is known that only about half of patients with abnormal imaging actually have cancer and that is what is found in this study. The marker was measured in patients undergoing biopsy. Might the new marker help decide which patients with abnormal scans should receive biopsy? lesson6d.rds: This is a dataset of cancer patients undergoing surgery with the endpoint of recurrence within 5 years. Since this cohort was established, adjuvant therapy has been shown to be of benefit. Current guidelines are that adjuvant therapy should be considered in patients with stage 3 or high-grade disease. Recently, two new variables have been added to the dataset: levels of a novel tumor marker were obtained from banked tissue samples and preoperative imaging scans were retrieved and scored from 0 (no evidence of local extension) to 4 (definite evidence of local extension). Here are some questions about these data: How good is the current method for determining whether patients should be referred to adjuvant therapy? It has been suggested that a statistical model using stage and grade would be better than the current risk grouping. How good do you think this model would be? Does the marker add information to the model of stage and grade? Does imaging add information to the model including stage, grade and the marker? And now, a complete different type of question In this question, I give you an experimental set up but no data. What you have to do is give me an answer. Now obviously you cant give me any numbers because I didnt give you any. However, you can write an answer with some blanks. For example, if you hadnt been given any data, an answer to lesson5b.rds might be: ? of the ? (?%) patients on chemotherapy regime a responded compared to ? of the ? patients on regime b (?%). The difference between groups (?%, 95% CI ?, ?) was / was not statistically significant (p = ?). Response by sex and group is shown in the table. The interaction term for group and sex was / was not significant (p = ?). html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Chemotherapy Male Female Regime a ? of ? (?%) responded ? of ? (?%) responded Regime b ? of ? (?%) responded ? of ? (?%) responded So, I want you to give similar answers to the following research questions: lesson6e: Hospitalized neutropenic patients were randomized to receive drug a or placebo. Bloods were taken every day. The time until patients were no longer neutropenic was measured (all patients eventually did get better). lesson6f: A new lab machine sometimes fails to give a readout with the result that the sample is wasted. To try and get a handle on this problem, a researcher carefully documents the number of failures for the 516 samples that she analyzes in the month of September. lesson6g: Drug a appears to be effective against cancer cells in vitro. Researchers create two new drugs, b and c, by making slight molecular rearrangements of drug a. The three drugs are then added to tumor cells in the test tube and the degree of cell growth measured. "],["week-7.html", "7 Week 7 7.1 Setting Up 7.2 R Instructions 7.3 Assignments", " 7 Week 7 7.1 Setting Up # Load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Load data necessary to run Week 7 examples example7a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;example7a.rds&quot;)) 7.2 R Instructions 7.2.1 Introductory remarks on time-to-event analysis In a typical study of a cancer drug, patients are entered on the study and then followed until death. When the data are analyzed, some patients will have died but others will still be alive. For instance, if John Doe entered the study on 4/1/2017 and died on 3/31/2019, we know that he survived exactly two years on the drug. However, if Jane Doe entered the study on 7/1/2018 and was still alive on 6/30/2019, when the study was closed for analysis, we know that she lived for more than one year, but not how much longer. We say that Jane Doe was censored. When running statistical analyses, we cannot ignore the fact that Janes data point 1 year survival is actually &gt;1 year survival. This means that, for instance, we couldnt calculate the mean of Jane and Joes survival and say that average survival was 1.5 years. The approach used in time-to-event analysis is known as cumulative probability. One way to think about this is the fairy tale about the brave knight who has to complete a series of challenges set by the king in order to win the hand of the princess in marriage. Imagine that he has to climb the wall of death, cross the valley of mists and slay the dragon. We might estimate the probability that he will die on each task as, respectively, 20%, 10% and 30%. In other words, he has an 80% chance of climbing the wall of death, a 90% chance of getting across the valley of mists and a 70% chance of slaying the dragon. To calculate the probability that he lives to marry the princess, we multiply those probabilities together to get 80% × 90% × 70% = 50%. Now lets apply that to a cancer study. As a simple example, imagine that there are 10 patients and that one dies every month. After four months, four patients have died and so the probability of survival at four months is, obviously, 60%. But lets think about that using the same methods as we did for the fairy tale. There were 10 patients at the start of the trial, and one died at the end of the first month. Hence the chance of surviving the first month is 90%. Nine patients were alive at the start of the second month and 8 survived till the end of the month, giving a probability of surviving the second month as 8 ÷ 9 = 88.89%. We can do similar calculations for month 3 (7 ÷ 8 = 87.50%) and month 4 (6 ÷ 7 = 85.71%). If we multiply those probabilities together, we get 90% × 88.89% × 87.50% × 85.71% = 60% survival probability, exactly what we would expect. However, lets imagine that the research assistant comes back to us, saying that there has been a miscommunication. The patient who was said to have died after two months actually went back to her home country and we dont know anything more about her, so she didnt die, she was censored. Lets do the calculation again. The first month is unchanged: 9 out of 10 = 90% survival rate. Nine patients were alive at the start of the second month and all were alive at the end of the month, a 100% survival rate. At the start of the third month, we only have 8 patients (10 minus 1 who died and 1 who was censored), so the probability of surviving month 3 is 7 ÷ 8 = 87.5% and the probability of surviving month 4 is 6 ÷ 7 = 85.71%. Now when we multiply 90% × 100% × 87.50% × 85.71% we get 67.5%. Now lets imagine that the woman is actually found to be still alive, 8 months in. We now calculate the 4 months probability as 90% for month 1, 100% for month 2 (there were no deaths), 8 ÷ 9 = 88.89% for month 3 and 7 ÷ 8 = 87.50% for months 4, a survival probability of 90% × 100% × 88.89% × 87.50% = 70%. Here are some key takeaways. Time-to-event analysis is all about probabilities. Note that 3 patients died in both the second and third example, but it would be unsound to say Of the ten patients that entered the trial, 3 (30%) died. You would need to say instead, Three patients died. The probability of survival at four months was 67.5% / 70% for example 2 / 3. Survival probabilities dont change until there is a death. In example 2, for instance, there is a 100% chance of surviving the second month, so the survival probabilities at month 1 and 2 are the same. This is why survival curves look like steps, with the curve being flat (for periods when there are no deaths) and then a step down (when a death occurs). We dont always have death as an endpoint. It could be cancer progression, change in treatment or in fact anything that takes place over time (in engineering studies, for instance, we look at time to failure of a machine part). So the usual terminology is to talk about time to event and the number of events rather than survival analysis. 7.2.2 Time to event data You need at least two variables to describe a time to event dataset: how long the patients were followed (the time variable), and whether they had the event (e.g. were alive or dead) at last observation (the failure variable). The failure variable is coded 1 if the patient had the event (e.g. died, had a recurrence) and 0 otherwise. You can have any other variables (patient codes, stage of cancer, treatment, hair color, etc.) but these are not essential. For survival analyses, you need to indicate that your outcome is a time-to-event outcome by providing both the event status, such as death, and time to event, for example time from surgery to death or last followup. The function used to do this is the Surv function from the survival package. The function is of the form Surv(t, d) where t is the time variable and d is the failure variable (e.g. died if 1, alive at last follow-up if 0). The survfit function (also from the survival) package describes the survival data. It is common to report the median survival. # Calculate descriptive statistics on time to event data # The &quot;~ 1&quot; indicates that we want survival estimates for the entire group survfit(Surv(t, d) ~ 1, data = example7a) ## Call: survfit(formula = Surv(t, d) ~ 1, data = example7a) ## ## n events median 0.95LCL 0.95UCL ## 23 18 27 18 45 You often also report the median time of follow-up for survivors, which can easily be calculated manually. # Calculate median followup for survivors only example7a %&gt;% filter(d == 0) %&gt;% # Keep only the surviving patients skim(t) # Remember, &quot;p50&quot; indicates the median Table 7.1: Data summary Name Piped data Number of rows 5 Number of columns 6 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist t 0 1 52.6 61.89 13 16 28 45 161  You can also plot the survival curve by adding the plot function around your survfit function: # Plot survival curve plot(survfit(Surv(t, d) ~ 1, data = example7a)) Use ~ covariate instead of ~ 1 to plot survival curves by group: # Plot survival curve by group (drug vs no drug) # &quot;~ drug&quot; indicates to plot by &quot;drug&quot;, vs &quot;~ 1&quot; which plots for all patients plot(survfit(Surv(t, d) ~ drug, data = example7a)) As you may notice, this graph shows both lines in black, which makes it difficult to determine which line corresponds to which group. However, you can add color to the lines to differentiate them. The order of the colors corresponds to the order of the variable values - in this case, drug is 0 and 1, so the following code creates a graph where the placebo group (drug = 0) is plotted in blue and the drug group (drug = 1) is plotted in red. # Plot survival curve by group (drug vs no drug) with colors plot(survfit(Surv(t, d) ~ drug, data = example7a), col = c(&quot;blue&quot;, &quot;red&quot;)) Graphs can be saved out by using the Export option at the top of the Plots tab. The survdiff function compares survival for different groups. For example, the following code compares survival for each value of the variable drug (generally 0 and 1). # Compare survival between drug groups survdiff(Surv(t, d) ~ drug, data = example7a) ## Call: ## survdiff(formula = Surv(t, d) ~ drug, data = example7a) ## ## N Observed Expected (O-E)^2/E (O-E)^2/V ## drug=0 12 11 7.31 1.86 3.4 ## drug=1 11 7 10.69 1.27 3.4 ## ## Chisq= 3.4 on 1 degrees of freedom, p= 0.07 Using the summary function with survfit lists all available followup times along with survival probabilities (you get a 95% C.I. as well): # Survival probabilities for the entire cohort summary(survfit(Surv(t, d) ~ 1, data = example7a)) ## Call: survfit(formula = Surv(t, d) ~ 1, data = example7a) ## ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 5 23 2 0.9130 0.0588 0.8049 1.000 ## 8 21 2 0.8261 0.0790 0.6848 0.996 ## 9 19 1 0.7826 0.0860 0.6310 0.971 ## 12 18 1 0.7391 0.0916 0.5798 0.942 ## 13 17 1 0.6957 0.0959 0.5309 0.912 ## 18 14 1 0.6460 0.1011 0.4753 0.878 ## 23 13 2 0.5466 0.1073 0.3721 0.803 ## 27 11 1 0.4969 0.1084 0.3240 0.762 ## 30 9 1 0.4417 0.1095 0.2717 0.718 ## 31 8 1 0.3865 0.1089 0.2225 0.671 ## 33 7 1 0.3313 0.1064 0.1765 0.622 ## 34 6 1 0.2761 0.1020 0.1338 0.569 ## 43 5 1 0.2208 0.0954 0.0947 0.515 ## 45 4 1 0.1656 0.0860 0.0598 0.458 ## 48 2 1 0.0828 0.0727 0.0148 0.462 # You can also summarize the survival by group: summary(survfit(Surv(t, d) ~ drug, data = example7a)) ## Call: survfit(formula = Surv(t, d) ~ drug, data = example7a) ## ## drug=0 ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 5 12 2 0.8333 0.1076 0.6470 1.000 ## 8 10 2 0.6667 0.1361 0.4468 0.995 ## 12 8 1 0.5833 0.1423 0.3616 0.941 ## 23 6 1 0.4861 0.1481 0.2675 0.883 ## 27 5 1 0.3889 0.1470 0.1854 0.816 ## 30 4 1 0.2917 0.1387 0.1148 0.741 ## 33 3 1 0.1944 0.1219 0.0569 0.664 ## 43 2 1 0.0972 0.0919 0.0153 0.620 ## 45 1 1 0.0000 NaN NA NA ## ## drug=1 ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 9 11 1 0.909 0.0867 0.7541 1.000 ## 13 10 1 0.818 0.1163 0.6192 1.000 ## 18 8 1 0.716 0.1397 0.4884 1.000 ## 23 7 1 0.614 0.1526 0.3769 0.999 ## 31 5 1 0.491 0.1642 0.2549 0.946 ## 34 4 1 0.368 0.1627 0.1549 0.875 ## 48 2 1 0.184 0.1535 0.0359 0.944 The times option allows you to get survival probabilities for specific timepoints. For example, at 1 year, 2 years and 5 years: # Get survival probabilities for specific time points in full dataset # &quot;~ 1&quot; indicates all patients # &quot;t&quot; variable is in months, so 12, 24 and 60 months used for 1, 2 and 5 years summary(survfit(Surv(t, d) ~ 1, data = example7a), times = c(12, 24, 60)) ## Call: survfit(formula = Surv(t, d) ~ 1, data = example7a) ## ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 12 18 6 0.7391 0.0916 0.5798 0.942 ## 24 11 4 0.5466 0.1073 0.3721 0.803 ## 60 1 8 0.0828 0.0727 0.0148 0.462 The coxph function (from survival) is for regression analyses. For example, a univariate regression for the effects of drug on survival: # Create Cox regression model coxph(Surv(t, d) ~ drug, data = example7a) ## Call: ## coxph(formula = Surv(t, d) ~ drug, data = example7a) ## ## coef exp(coef) se(coef) z p ## drug -0.9155 0.4003 0.5119 -1.788 0.0737 ## ## Likelihood ratio test=3.38 on 1 df, p=0.06581 ## n= 23, number of events= 18 # You can use the tbl_regression function with Cox models to see the hazard ratios example7a_cox &lt;- coxph(Surv(t, d) ~ drug, data = example7a) tbl_regression(example7a_cox, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value drug 0.40 0.15, 1.09 0.074 1 HR = Hazard Ratio, CI = Confidence Interval The following multivariable model also includes some demographic and medical characteristics: # Create multivariable Cox regression model # You can use the pipe operator (%&gt;%) to show the tbl_regression table directly # without storing the Cox model coxph(Surv(t, d) ~ drug + age + sex + marker, data = example7a) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value drug 0.17 0.05, 0.65 0.010 age 1.01 0.97, 1.06 0.6 sex 2.76 0.88, 8.65 0.081 marker 0.45 0.19, 1.03 0.059 1 HR = Hazard Ratio, CI = Confidence Interval So, some typical code to analyze a dataset: # Get median survival and number of events for group # Use the &quot;surv&quot; function to indicate the event status and time to event survfit(Surv(t, d) ~ 1, data = example7a) ## Call: survfit(formula = Surv(t, d) ~ 1, data = example7a) ## ## n events median 0.95LCL 0.95UCL ## 23 18 27 18 45 # Get median followup for survivors example7a %&gt;% filter(d == 0) %&gt;% skim(t) Table 7.2: Data summary Name Piped data Number of rows 5 Number of columns 6 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist t 0 1 52.6 61.89 13 16 28 45 161  # Show a graph plot(survfit(Surv(t, d) ~ 1, data = example7a)) # Look at predictors of survival coxph(Surv(t, d) ~ drug + age + sex + marker, data = example7a) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value drug 0.17 0.05, 0.65 0.010 age 1.01 0.97, 1.06 0.6 sex 2.76 0.88, 8.65 0.081 marker 0.45 0.19, 1.03 0.059 1 HR = Hazard Ratio, CI = Confidence Interval 7.3 Assignments # Copy and paste this code to load the data for week 7 assignments lesson7a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7a.rds&quot;)) lesson7b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7b.rds&quot;)) lesson7c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7c.rds&quot;)) lesson7d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7d.rds&quot;)) Try to do at least lesson7a and lesson7b. lesson7a.rds: This is a large set of data on patients receiving adjuvant therapy after surgery for colon cancer. Describe this dataset and determine which, if any, variables are prognostic in this patient group. lesson7b.rds: These are time to recurrence data on forty patients with biliary cancer treated at one of two hospitals, one of which treats a large number of cancer patients and one of which does not. Do patients treated at a high volume hospital have a longer time to recurrence? lesson7c.rds: These are data from a randomized trial comparing no treatment, levamisole (an immune stimulant) and levamisole combined with 5FU (a chemotherapy agent) and in the adjuvant treatment of colon cancer. Describe the dataset. What conclusions would you draw about the effectiveness of the different treatments? lesson7d.rds: More data on time to recurrence by hospital volume. Given this dataset, determine whether patients treated at a high volume hospital have a longer time to recurrence. "],["week-8.html", "8 Week 8", " 8 Week 8 Please review this this powerpoint about statistical slipups. "],["assignment-answers.html", "9 Assignment Answers 9.1 Week 1 9.2 Week 2 9.3 Week 3 9.4 Week 4 9.5 Week 5 9.6 Week 6 9.7 Week 7", " 9 Assignment Answers 9.1 Week 1 # Week 1: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 1: load data lesson1a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 1&quot;, &quot;lesson1a.rds&quot;)) 9.1.1 lesson1a.rds This is data for 386 patients undergoing surgery. What type of data (e.g. continuous, binary, ordinal, nonsense) are each of the variables? The dataset has 11 variables: id is clearly a hospital record number. It doesnt matter what type of variable it is, because you only want to know the type of variable in order to summarize or analyze data, and youd never want to analyze or summarize patient id. sex is a binary variable age is continuous p1, p2, p3, p4 are the pain scores after surgery. They only take integer values between 0 and 6. They would therefore typically regarded as categorical, and because they are clearly ordered (i.e. pain score of 6 is higher than one of 4) these variables can be described are ordinal. However, many statisticians, myself included, would think it perfectly reasonable to treat these variables as continuous. t: total pain score takes on values between 0 and 24 and can thus be considered continuous x, y and z: should you attempt to summarize a variable if you dont know what it is? It is obvious for y, this is some kind of hospital location, and is a categorical variable. But what about x and z? As it happens, z looks ordinal but isnt: it is blood group coded 1=o, 2=a, 3=b, 4=ab. 9.2 Week 2 # Week 2: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 2: load data lesson2a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2a.rds&quot;)) lesson2b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2b.rds&quot;)) lesson2c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2c.rds&quot;)) lesson2d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2d.rds&quot;)) lesson2e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 2&quot;, &quot;lesson2e.rds&quot;)) 9.2.1 lesson2a.rds This is data from marathon runners: summarize age, sex, race time in minutes (i.e. how long it took them to complete the race) and favorite running shoe. Age is continuous and normally distributed (look at a graph or look at the centiles) and so it wouldnt be unreasonable to describe age in terms of mean and standard deviation (SD) by using lesson2a %&gt;% skim(age): mean of 42 years, SD of 10.2. By the way, dont just copy the readout from R: this would give mean age as 42.43 and implies we are interested in age within a few days. Sex is binary: use tbl_summary(lesson2a %&gt;% select(sex)) to get percentages. But note that the person who prepared the data didnt state how the variable was coded (someone with sex=1 is a woman or a man?). Now what you should do in this situation is ask, but here is another alternative: # Summary statistics for race time, separately by sex lesson2a %&gt;% group_by(sex) %&gt;% skim(rt) Table 9.1: Data summary Name Piped data Number of rows 98 Number of columns 6 _______________________ Column type frequency: numeric 1 ________________________ Group variables sex Variable type: numeric skim_variable sex n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist rt 0 0 1 243.23 49.85 158 214.25 236.0 268.75 414  rt 1 0 1 264.84 37.45 222 237.00 251.5 283.25 362  So sex==0 are running faster than the sex==1 and it would not be unreasonable to assume that sex==1 means women. Race time is continuous and looks pretty normal. Yes the data are skewed by a single outlier (a race time of 414 minutes) but the mean and median are pretty similar (250 v. 242 minutes) and the 5th and 95th centile are very close to the values expected by adding or subtracting 1.64 times the SD from the mean (5th centile is 176, expected value using means and SD is 173; 95th centile actual and expected values are 328 and 328). I would probably feel comfortable reporting a mean and SD if you wanted. Favorite running shoe: lesson2a %&gt;% skim(shoe) gives a mean of 3.08 and a median of 3. If you reported these, you need therapy: shoe is a categorical variable and you should report the percentage of runners that favor each shoe. AN ADDITIONAL IMPORTANT POINT: you should give the number of observations and the number of missing observations. n is 98 for all observations except for favorite running shoe, where there are 95 observations and 3 missing observations. So here is a model answer, suitable for publication (assuming that sex==1 is coded as female.) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #iwrgxmosvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #iwrgxmosvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #iwrgxmosvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #iwrgxmosvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #iwrgxmosvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #iwrgxmosvm .gt_column_spanner_outer:first-child { padding-left: 0; } #iwrgxmosvm .gt_column_spanner_outer:last-child { padding-right: 0; } #iwrgxmosvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #iwrgxmosvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #iwrgxmosvm .gt_from_md > :first-child { margin-top: 0; } #iwrgxmosvm .gt_from_md > :last-child { margin-bottom: 0; } #iwrgxmosvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #iwrgxmosvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #iwrgxmosvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #iwrgxmosvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #iwrgxmosvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #iwrgxmosvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #iwrgxmosvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #iwrgxmosvm .gt_sourcenote { font-size: 90%; padding: 4px; } #iwrgxmosvm .gt_left { text-align: left; } #iwrgxmosvm .gt_center { text-align: center; } #iwrgxmosvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #iwrgxmosvm .gt_font_normal { font-weight: normal; } #iwrgxmosvm .gt_font_bold { font-weight: bold; } #iwrgxmosvm .gt_font_italic { font-style: italic; } #iwrgxmosvm .gt_super { font-size: 65%; } #iwrgxmosvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 981 Age 42 (10) Women 32 (33%) Race time in minutes 250 (47) Favorite Running Shoe Asics 14 (15%) New Balance 7 (7.4%) Nike 31 (33%) Saucony 43 (45%) Unknown 3 1 Mean (SD); n (%) However, look at this. html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hlleqxdave .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hlleqxdave .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hlleqxdave .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hlleqxdave .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hlleqxdave .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hlleqxdave .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hlleqxdave .gt_column_spanner_outer:first-child { padding-left: 0; } #hlleqxdave .gt_column_spanner_outer:last-child { padding-right: 0; } #hlleqxdave .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hlleqxdave .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hlleqxdave .gt_from_md > :first-child { margin-top: 0; } #hlleqxdave .gt_from_md > :last-child { margin-bottom: 0; } #hlleqxdave .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hlleqxdave .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hlleqxdave .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hlleqxdave .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hlleqxdave .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hlleqxdave .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hlleqxdave .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hlleqxdave .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hlleqxdave .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hlleqxdave .gt_sourcenote { font-size: 90%; padding: 4px; } #hlleqxdave .gt_left { text-align: left; } #hlleqxdave .gt_center { text-align: center; } #hlleqxdave .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hlleqxdave .gt_font_normal { font-weight: normal; } #hlleqxdave .gt_font_bold { font-weight: bold; } #hlleqxdave .gt_font_italic { font-style: italic; } #hlleqxdave .gt_super { font-size: 65%; } #hlleqxdave .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 981 Age 43 (34, 48) Women 32 (33%) Race time in minutes 242 (222, 273) Favorite Running Shoe Asics 14 (15%) New Balance 7 (7.4%) Nike 31 (33%) Saucony 43 (45%) Unknown 3 1 Median (IQR); n (%) This really isnt much to distinguish between these tables. On the one hand using the mean and SD gives you more information (e.g. what proportion of patients are aged over 70?). On the other hand, I cant see anyone using a table 1 to do these types of calculation and the median and interquartile range give you some more immediately usable information (no multiplying by 1.64!). 9.2.2 lesson2b.rds Summarize average pain after the operation. Imagine you had to draw a graph of time course of pain after surgery. What numbers would you use for pain at time 1, time 2, time 3, etc.? This is data on postoperative pain. You were asked to summarize average pain after the operation. This is continuous, so by looking at the histogram, you can see that the data look skewed. I would be tempted to use the median (1.8) and quartiles (1.1, 2.6). # Create histogram to assess whether data look skewed ggplot(data = lesson2b, aes(x = t)) + geom_histogram() ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. However, using the mean and standard deviation doesnt get you far off. For normal data, 50% of the observations are within two-thirds of a standard deviations of the mean. So the interquartile range predicted from the mean and SD would be 1.9 - 1.1*0.67 and 1.9 + 1.1*0.67 which gives you 1.2 and 2.7. This is an interesting point: the data can look skewed (and if you are interested, a statistical test can tell you that the data are definitely non-normal) but it doesnt make much of a difference in practice. You were then asked to imagine that you had to draw a graph of time course of pain after surgery. What numbers would you use for time 1, time 2 etc? The first thing to note is that to draw the graph, which seems like a useful thing to do, you have to treat the data as continuous: you cant really graph a table very easily. This is another illustration of how something that seems technically incorrect gives you useful approximations. Now that we have continuous data we have to decide whether to use medians or means. As it turns out, normality of the data isnt even an issue. Here is what happens if you graph the median pain score at each time point. This makes it seem that postoperative pain doesnt change for four time points, then drops dramatically. A graph using means seems more illustrative of what is really going on. 9.2.3 lesson2c.rds This is data on 241 patients undergoing radical prostatectomy. Summarize age, stage, grade and PSA. One of the first things to look for here is missing data. If you type lesson2c %&gt;% skim(), youll see that there is no missing data for age, 9 missing observations for PSA and 41 for grade. You will notice that the stage variable is not included here, because it is a character variable, not a numeric variable. If you type tbl_summary(lesson2c %&gt;% select(stage)), youll see that all patients have a stage assigned (no NA values). A second issue is how to characterize the categorical variables. There are 8 different stages represented, many with very small numbers (like 2 for T4 and T1B, 4 for T3). It generally isnt very helpful to slice and dice data into very small categories, so I would consider grouping. For instance, we could group the T1s together, and group the T3 and T4 patients together to get something like: html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kqtxbhydst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kqtxbhydst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kqtxbhydst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kqtxbhydst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kqtxbhydst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kqtxbhydst .gt_column_spanner_outer:first-child { padding-left: 0; } #kqtxbhydst .gt_column_spanner_outer:last-child { padding-right: 0; } #kqtxbhydst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kqtxbhydst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kqtxbhydst .gt_from_md > :first-child { margin-top: 0; } #kqtxbhydst .gt_from_md > :last-child { margin-bottom: 0; } #kqtxbhydst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kqtxbhydst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kqtxbhydst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kqtxbhydst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kqtxbhydst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kqtxbhydst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kqtxbhydst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kqtxbhydst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kqtxbhydst .gt_sourcenote { font-size: 90%; padding: 4px; } #kqtxbhydst .gt_left { text-align: left; } #kqtxbhydst .gt_center { text-align: center; } #kqtxbhydst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kqtxbhydst .gt_font_normal { font-weight: normal; } #kqtxbhydst .gt_font_bold { font-weight: bold; } #kqtxbhydst .gt_font_italic { font-style: italic; } #kqtxbhydst .gt_super { font-size: 65%; } #kqtxbhydst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 2411 Stage T1 169 (70%) T2A 36 (15%) T2B 22 (9.1%) T2C 8 (3.3%) T3/4 6 (2.5%) 1 n (%) To get this table, I created a new variable called stage_category. The code below uses the case_when function, which is similar to the if_else function. Both functions take a condition and assign a value, but if_else can only assign two values (one if the condition is TRUE, the other if the condition is FALSE). case_when can assign as many values as youd like. In this case, the case_when function does the following: When the value of stage is one of the values in the list of T1A, T1B, or T1C, set the variable stage_category to T1. When the value of stage is T3 or T4, set the variable stage_category to T3/T4. In case_when, TRUE means every observation that didnt fall into any of the previous categories. Here, this means: for all observations that didnt fit into the previously specified T1 or T3/4 categories, use the value of the variable stage. In this case, these are the T2A, T2B and T2C values, which remain the same in both the stage and stage_category variables. # Create new variable for stage and save into &quot;lesson2c&quot; dataset lesson2c &lt;- lesson2c %&gt;% mutate( stage_category = case_when( stage %in% c(&quot;T1A&quot;, &quot;T1B&quot;, &quot;T1C&quot;) ~ &quot;T1&quot;, stage %in% c(&quot;T3&quot;, &quot;T4&quot;) ~ &quot;T3/4&quot;, TRUE ~ stage ) ) # You can use the &quot;count&quot; function to confirm that your variable was created correctly lesson2c %&gt;% count(stage_category, stage) ## # A tibble: 8 x 3 ## stage_category stage n ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 T1 T1A 3 ## 2 T1 T1B 2 ## 3 T1 T1C 164 ## 4 T2A T2A 36 ## 5 T2B T2B 22 ## 6 T2C T2C 8 ## 7 T3/4 T3 4 ## 8 T3/4 T4 2 There is a similar issue for grade, with few patients having grades 4, 5, 8 or 9. Now a key point is that what you decide to do in situations like this will often need to take into account your medical understanding. It might seems sensible to categorize grade as 6 or 7, or perhaps 4/5, 6, 7, 8/9. But as it turns out in prostate cancer, pathologists cant reliably grade a cancer as 4 or 5 and these cancers should really be grouped with grade 6. Grade 8, on the other hand, signifies very aggressive disease and really needs to be reported separately even if there are only a few patients with grade 8. So grade would probably be summarized as per the following table: html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qzjvxzfwte .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qzjvxzfwte .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qzjvxzfwte .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qzjvxzfwte .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qzjvxzfwte .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qzjvxzfwte .gt_column_spanner_outer:first-child { padding-left: 0; } #qzjvxzfwte .gt_column_spanner_outer:last-child { padding-right: 0; } #qzjvxzfwte .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qzjvxzfwte .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qzjvxzfwte .gt_from_md > :first-child { margin-top: 0; } #qzjvxzfwte .gt_from_md > :last-child { margin-bottom: 0; } #qzjvxzfwte .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qzjvxzfwte .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qzjvxzfwte .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qzjvxzfwte .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qzjvxzfwte .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qzjvxzfwte .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qzjvxzfwte .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qzjvxzfwte .gt_sourcenote { font-size: 90%; padding: 4px; } #qzjvxzfwte .gt_left { text-align: left; } #qzjvxzfwte .gt_center { text-align: center; } #qzjvxzfwte .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qzjvxzfwte .gt_font_normal { font-weight: normal; } #qzjvxzfwte .gt_font_bold { font-weight: bold; } #qzjvxzfwte .gt_font_italic { font-style: italic; } #qzjvxzfwte .gt_super { font-size: 65%; } #qzjvxzfwte .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 2411 Stage T1 169 (70%) T2A 36 (15%) T2B 22 (9.1%) T2C 8 (3.3%) T3/4 6 (2.5%) Grade 6 79 (40%) 7 112 (56%) 8 9 (4.5%) Unknown 41 Age 60 (56, 65) PSA 5.3 (4.0, 8.0) Unknown 9 1 n (%); Median (IQR) 9.2.4 lesson2d.rds Summarize cost. I asked you to summarize the cost. You can see from a graph that the data are not normally distributed. If we were to follow the rule book slavishly, we would report a median and interquartile range. But what use is a median for cost data? We want to know average cost so that we can predict, for example, how much we should budget for next year. This requires a mean. 9.2.5 lesson2e.rds Summarize total cancer pain in one month in a group of chronic cancer patients. The data are grossly non-normal and you could use the median pain score with interquartile range. As for summarizing the number of days in pain, almost everyone has 31 days of pain. So I would give proportions of patients who had pain for 31 days and then the number who, say, had pain at least 3 out of every 4 days and 2 out of 4 days. There are two ways of doing this. You could use tbl_summary(lesson2e %&gt;% select(f), type = list(\"f\" ~ \"categorical\")) and then combine some of the results. Or, and this is a little more complicated, you could create a new variable. # Create variable to categorize number of days in pain lesson2e &lt;- lesson2e %&gt;% mutate( days = case_when( f &lt;= 15 ~ 0, f &gt; 15 &amp; f &lt; 23 ~ 1, f &gt; 23 &amp; f &lt; 31 ~ 2, f == 31 ~ 3 ) ) In other words, create a new variable called days, and set it to 0 for anyone with 15 or less days of pain. Call anyone who has pain more than half the time (i.e. more than 15 days) a 1. Call anyone who has pain more than three quarter of the time (i.e. more than 23 days) a 2. Call anyone who has pain all the time a 3. # Print formatted table summarizing number of days in pain tbl_summary( lesson2e %&gt;% select(days) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pqsnuprvju .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pqsnuprvju .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pqsnuprvju .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #pqsnuprvju .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pqsnuprvju .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pqsnuprvju .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pqsnuprvju .gt_column_spanner_outer:first-child { padding-left: 0; } #pqsnuprvju .gt_column_spanner_outer:last-child { padding-right: 0; } #pqsnuprvju .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #pqsnuprvju .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #pqsnuprvju .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pqsnuprvju .gt_from_md > :first-child { margin-top: 0; } #pqsnuprvju .gt_from_md > :last-child { margin-bottom: 0; } #pqsnuprvju .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pqsnuprvju .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #pqsnuprvju .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pqsnuprvju .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #pqsnuprvju .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pqsnuprvju .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pqsnuprvju .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pqsnuprvju .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pqsnuprvju .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #pqsnuprvju .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pqsnuprvju .gt_sourcenote { font-size: 90%; padding: 4px; } #pqsnuprvju .gt_left { text-align: left; } #pqsnuprvju .gt_center { text-align: center; } #pqsnuprvju .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pqsnuprvju .gt_font_normal { font-weight: normal; } #pqsnuprvju .gt_font_bold { font-weight: bold; } #pqsnuprvju .gt_font_italic { font-style: italic; } #pqsnuprvju .gt_super { font-size: 65%; } #pqsnuprvju .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 1001 days 0 16 (17%) 1 7 (7.4%) 2 23 (24%) 3 48 (51%) Unknown 6 1 n (%) So you could report that, of the 94 patients with data on number of days with pain, 51% were in daily pain, 17% of patients had pain on less than half of days, 7.4% of patients had pain on more than half but less than 75% of days, 24% of patients had pain on more than 75% of days, but not every day. For keen students only! You could also try a log transformation of the pain scores. Create a new variable using log(pain). # Create a variable for log of the pain score lesson2e &lt;- lesson2e %&gt;% mutate(log = log(pain)) Analyze this variable and youll see it appears normally distributed. The mean of log is 5.42. You can transform the log back by calculating e5.42 (the function is exp(5.42)) to get 225, close to the median. Backtransforming the standard deviation is more complicated and cant really be done directly. What you need to do is make any calculations you need on the log transformed scale and then backtransform the results. Imagine you wanted a 95% confidence interval. A 95% confidence interval is the mean ± 1.96 standard deviations. The standard deviation of the log data is close to one. So the confidence interval is 3.45 to 7.39. Transforming this exp(3.45) and exp(7.39) gives a confidence interval on the original scale of 31.44 and 1614.07. This is a reasonable approximation to the 5th (50) and 95th centile (1319). 9.3 Week 3 # Week 3: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 3: load data lesson3a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3a.rds&quot;)) lesson3b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3b.rds&quot;)) lesson3c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3c.rds&quot;)) lesson3d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3d.rds&quot;)) lesson3e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3e.rds&quot;)) lesson3f &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 3&quot;, &quot;lesson3f.rds&quot;)) 9.3.1 lesson3a.rds These are data from over 1000 patients undergoing chemotherapy reporting a nausea and vomiting score from 0 to 10. Does previous chemotherapy increase nausea scores? What about sex? Hands up, who typed in t.test(nv ~ pc, data = lesson3a, paired = FALSE, var.equal = TRUE) without looking at the data? There are lots of missing data. There is a question as to whether you would actually analyze these data at all: could data be missing because patients were too ill to complete questionnaires? Could there have been bias in ascertaining who had prior chemotherapy? If you do decide to analyze, a t-test would be appropriate (t.test(nv ~ pc, data = lesson3a, paired = FALSE, var.equal = TRUE) and t.test(nv ~ sex, data = lesson3a, paired = FALSE, var.equal = TRUE)). A model answer might be: Details of prior chemotherapy were available for 512 of the 1098 patients with nausea scores. Mean nausea scores were approximately 20% higher in the 255 patients with prior experience of chemotherapy (5.3; SD 2.03) than in the 257 chemotherapy-naive patients (4.5; SD 1.99). The difference between groups was small (0.8, 95% C.I. 0.5, 1.2) but highly statistically significant (p&lt;0.001 by t-test), suggesting that prior chemotherapy increases nausea scores. Nausea scores were slightly lower in women (n=444; mean 4.7; SD 1.98) than men (n=434; mean 4.8; SD 2.1) but there were no statistically significant differences between the sexes (difference between means 0.1, 95% C.I. -0.2, 0.3; p=0.7 by t-test). However, far more women (131 / 575, 60%) than men (89 / 523, 40%) failed provide a nausea score (p=0.017 by chi squared), perhaps suggesting bias in reporting. Now, Ill explain what I did. First, I did the two t-tests: # t-test for nausea/vomiting by prior chemotherapy t.test(nv ~ pc, data = lesson3a, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: nv by pc ## t = -4.6275, df = 510, p-value = 4.7e-06 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -1.1699123 -0.4725841 ## sample estimates: ## mean in group 0 mean in group 1 ## 4.459144 5.280392 # t-test for nausea/vomiting by sex t.test(nv ~ sex, data = lesson3a, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: nv by sex ## t = 0.43835, df = 876, p-value = 0.6612 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.2100764 0.3308988 ## sample estimates: ## mean in group 0 mean in group 1 ## 4.782258 4.721847 While the t.test function gives the confidence interval around the difference in means, it does not calculate the difference in means for you. While you can cut and paste to calculate this manually, you can do it using by saving the estimates from the t-test like we did in the horsepower example in the lesson. # Save out the t-test to get the estimate ttest_nv_pc &lt;- t.test(nv ~ pc, data = lesson3a, paired = FALSE, var.equal = TRUE) ttest_nv_pc$estimate ## mean in group 0 mean in group 1 ## 4.459144 5.280392 # The first value is mean in group 0 # (&quot;mean in group 0&quot; is printed first in results) mean_group0 &lt;- ttest_nv_pc$estimate[[1]] # The second value is mean in group 1 mean_group1 &lt;- ttest_nv_pc$estimate[[2]] # Subtract the mean in group 1 from the mean in group 0 mean_group0 - mean_group1 ## [1] -0.8212482 If you would like to save out the confidence interval instead of copying and pasting, you can do this in the same way by accessing conf.int instead of estimate. # Confidence interval ttest_nv_pc$conf.int ## [1] -1.1699123 -0.4725841 ## attr(,&quot;conf.level&quot;) ## [1] 0.95 # Lower bound ttest_nv_pc$conf.int[[1]] ## [1] -1.169912 # Upper bound ttest_nv_pc$conf.int[[2]] ## [1] -0.4725841 Then I created a new variable for missing data on nausea and vomiting: # Create new variable to indicate whether &quot;nv&quot; variable is missing lesson3a &lt;- lesson3a %&gt;% mutate( missing = if_else(is.na(nv), 1, 0) ) And then the table: # Formatted table to look at rates of missingness in &quot;nv&quot; variable by sex tbl_summary( lesson3a %&gt;% select(missing, sex), by = sex, type = list(&quot;missing&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #opulaeyvxv .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #opulaeyvxv .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #opulaeyvxv .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #opulaeyvxv .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #opulaeyvxv .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #opulaeyvxv .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #opulaeyvxv .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #opulaeyvxv .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #opulaeyvxv .gt_column_spanner_outer:first-child { padding-left: 0; } #opulaeyvxv .gt_column_spanner_outer:last-child { padding-right: 0; } #opulaeyvxv .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #opulaeyvxv .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #opulaeyvxv .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #opulaeyvxv .gt_from_md > :first-child { margin-top: 0; } #opulaeyvxv .gt_from_md > :last-child { margin-bottom: 0; } #opulaeyvxv .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #opulaeyvxv .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #opulaeyvxv .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #opulaeyvxv .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #opulaeyvxv .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #opulaeyvxv .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #opulaeyvxv .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #opulaeyvxv .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #opulaeyvxv .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #opulaeyvxv .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #opulaeyvxv .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #opulaeyvxv .gt_sourcenote { font-size: 90%; padding: 4px; } #opulaeyvxv .gt_left { text-align: left; } #opulaeyvxv .gt_center { text-align: center; } #opulaeyvxv .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #opulaeyvxv .gt_font_normal { font-weight: normal; } #opulaeyvxv .gt_font_bold { font-weight: bold; } #opulaeyvxv .gt_font_italic { font-style: italic; } #opulaeyvxv .gt_super { font-size: 65%; } #opulaeyvxv .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 5231 1, N = 5751 missing 0 434 (83%) 444 (77%) 1 89 (17%) 131 (23%) 1 n (%) If you got that far: wow! (also, forget the course, you dont need it). If you didnt get that far, dont feel bad about it, but try to get a handle on the thought process. One other issue: the p-value for the first t-test (previous chemotherapy) is given as p-value = 4.709e-06. While this number is very close to 0, we cannot round to 0 - there is no such thing as a p-value of 0 for any hypothesis worth testing (there is a small but finite chance of every possible result, even throwing 100,000 tails in a row on an unbiased coin.) So do not report p=0.0000! You can round p-values for reporting - for example, 4.709e-06 can be rounded to &lt;0.0005. For more advanced students: The other thing you can do is to find out the precise p-value from the t value (which is given above the p-value: -4.6275). The function you need is pt(t value, degrees of freedom). This will give you the p-value for a one-sided test, so you must multiply by 2 to get the two-sided test p-value. # Find out p-value from t value pt(-4.6275, 510)*2 ## [1] 4.699746e-06 This p-value can also be read as 4.7 x 10-6. An interesting question though: is it important whether p is &lt;0.0005 or 4.7 x 10-6? What is degrees of freedom and how come it is 510? Think about it this way: You have a line of ten people outside your door. You know the mean age of this group. Each person comes in one-by-one, you try to guess their age and they tell you how old they actually are. As each person comes in, your guesses will get better and better (for example, if the first three people have ages less than the mean, you will guess the age of the fourth person as something above the mean). However, only when you have the ages of the first nine people will you be able to guess for sure the age of the next (and last) person. In other words, the ages of the first nine people are free, the age of the last person is constrained. So degrees of freedom is the sample size minus one. Little catch though: for an unpaired test (such a straight drug v. placebo trial), you have two different groups and two different means. You would therefore be able to predict the scores of two observations (the last patient in each group). Degrees of freedom in an unpaired test is therefore the total sample size minus two (or, put another way, the sample size in group a minus one plus the sample size in group b minus one). 9.3.2 lesson3b.rds Patients with wrist osteoarthritis are randomized to a new drug or placebo. Pain is measured before and after treatment. Is the drug effective? The most obvious thing to do would be to do: # t-test for pain after treatment, by group t.test(p ~ g, data = lesson3b, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: p by g ## t = 1.9731, df = 34, p-value = 0.05665 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.01930642 1.30819531 ## sample estimates: ## mean in group 0 mean in group 1 ## 0.55555555 -0.08888889 This gives a p-value of 0.057 and you might conclude that although the difference wasnt statistically significant, there was some evidence that the drug works. However, the t-test assumes that the data are independent. In the present case, this assumption does not hold: each patient contributes data from two wrists, and the pain scores from each wrist are correlated. There are several ways around the problem. The most obvious is to say: These data are not independent, I am not going to analyze them. Call in a statistician. However, if you are really keen, you could try the following: You could analyze the data from each wrist separately by creating new variables as shown below (lines with # are comments). # Analyze data separately by wrist lesson3b &lt;- lesson3b %&gt;% # Create a new variable called &quot;pright&quot; equivalent to &quot;p&quot; # (the pain score for the right wrist (site 2) only) mutate( pright = case_when(site == 2 ~ p) # By default, any observations that do not fall into the specified conditions # in the &quot;case_when&quot; statement will be set to missing (NA) ) %&gt;% # Create a new variable called &quot;pleft&quot; for pain scores for the left wrist mutate( pleft = case_when(site == 1 ~ p) ) # t-test for pain in right and left wrists separately t.test(pright ~ g, data = lesson3b, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: pright by g ## t = 1.6818, df = 16, p-value = 0.112 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.2055046 1.7832823 ## sample estimates: ## mean in group 0 mean in group 1 ## 0.6555555 -0.1333333 t.test(pleft ~ g, data = lesson3b, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: pleft by g ## t = 1.0418, df = 16, p-value = 0.313 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.5174209 1.5174209 ## sample estimates: ## mean in group 0 mean in group 1 ## 0.45555555 -0.04444445 You could also analyze the data by taking the average of the two wrists. You can create a new value for the average using the mean function. The distinct function from dplyr allows you to drop duplicate observations. Since there are two observations per patient (one for the left wrist and one for the right wrist), we will take the average and then drop the duplicate observation so that each patient is included only once. lesson3b_avg &lt;- lesson3b %&gt;% # Grouping by patient id so that each patient ends up with the average of their own two wrist scores group_by(id) %&gt;% # Calculate the mean pain score between wrists for each patient mutate( meanpain = mean(p, na.rm = TRUE) ) %&gt;% # Only keep the patient ID, group variable and mean pain score select(id, g, meanpain) %&gt;% # Drop duplicates so you don&#39;t count each patient twice # Here we only want one observation per patient since we are assessing the average pain between the two wrists distinct() %&gt;% # Ungroup the data ungroup() # t-test for average pain between both wrists t.test(meanpain ~ g, data = lesson3b_avg, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: meanpain by g ## t = 1.4286, df = 16, p-value = 0.1723 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -0.3118365 1.6007254 ## sample estimates: ## mean in group 0 mean in group 1 ## 0.55555555 -0.08888889 9.3.3 lesson3c.rds Some postoperative pain data again. Is pain on day 2 different than pain on day 1? Is pain on day 3 different from pain on day 2? The most obvious issue here is that you are measuring the same patients on two occasions, so you are going to want a paired test. Should you do a paired t-test? Many statisticians would prefer a non-parametric method given that the data take only five different values and that the number of observations is small. The following command gives you the Wilcoxon signed rank test: # Non-parametric test comparing day 1 and day 2 pain wilcox.test(lesson3c$t1, lesson3c$t2, paired = TRUE) ## Warning in wilcox.test.default(lesson3c$t1, lesson3c$t2, paired = TRUE): cannot ## compute exact p-value with ties ## Warning in wilcox.test.default(lesson3c$t1, lesson3c$t2, paired = TRUE): cannot ## compute exact p-value with zeroes ## ## Wilcoxon signed rank test with continuity correction ## ## data: lesson3c$t1 and lesson3c$t2 ## V = 41.5, p-value = 0.1446 ## alternative hypothesis: true location shift is not equal to 0 If you run this code, you will notice you get a warning in yellow text that states that the exact p-value cannot be calculated. In R, warnings are notes that indicate you may want to look more closely at your code, but wont stop the code from running - as you can see, this code still gives a p-value - but R is also flagging this result to tell you that this is not an exact p-value (you will learn more about exact p-values later). You should always take note of warnings when they occur, but sometimes you may not need to make any changes to the code. (By the way: I know this because that is what it says on the read out. If you had asked me yesterday, I doubt I would have remembered the name of a non-parametric paired test, another reason to think in concepts rather than remembering statistical techniques). The p-value you get is p=0.14. We cannot conclude that pain scores are different. But is that all we want to say? The number of patients is small, maybe we failed to spot a difference. So lets try a t-test: # paired t-test comparing day 1 and day 2 pain t.test(lesson3c$t1, lesson3c$t2, paired = TRUE, var.equal = TRUE) ## ## Paired t-test ## ## data: lesson3c$t1 and lesson3c$t2 ## t = 1.5467, df = 21, p-value = 0.1369 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -0.09395838 0.63941292 ## sample estimates: ## mean of the differences ## 0.2727273 The p-value you get (p=0.14) is very similar to the non-parametric method and you get a confidence interval for the difference between means of -0.09, 0.64. What I would conclude from this is that pain is unlikely to be worse on day 2 than day 1 but any decrease in pain is probably not important. What about normality of the data? Doesnt that figure into whether you assess by t-test or non-parametric? Well if you type look at the distribution of t1 and t2, you find that neither are normally distributed. But a paired t-test does not depend on the assumption that each set of data in a pair is distributed but that the differences between pairs are normally distributed. So you would have to create a new variable and look at that: # Create a variable containing the difference in pain scores between days 1 and 2 lesson3c &lt;- lesson3c %&gt;% mutate(delta12 = t2 - t1) # Summarize change in pain scores skim(lesson3c$delta12) Table 9.2: Data summary Name lesson3c$delta12 Number of rows 22 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 -0.27 0.83 -2 -1 0 0 1  As it turns out, the distribution of differences between pain scores are normally distributed even though pain at time 2 does not have a normal distribution. In fact, this is almost always the case. Now lets compare t2 and t3. Again, no significant difference. Does this mean that pain does not decrease after an operation? Of course, we know that pain does indeed get better. This illustrates two points: first, dont ask questions you know the answer to; second, asking lots of questions (is pain on day 2 better than on day 1?; is pain on day 3 better on day 2?) is not as good as just asking one question: does pain decrease over time? Well discuss how to answer this question later on in the course. 9.3.4 lesson3d.rds This is a single-arm, uncontrolled study of acupuncture for patients with neck pain. Does acupuncture increase range of motion? Just as many men as women get neck pain. Can we say anything about the sample chosen for this trial with respect to gender? The mean age of patients with neck pain is 58.2 years. Is the trial population representative with respect to age? This is before and after data, so again youll want a paired test. The data are continuous, so a paired t-test is an option (if you are worried about normality, do both the parametric and non-parametric test and compare the results.) There are two ways of doing the t-test: Test whether the baseline scores are different from the post-treatment scores: # paired t-test for before and after pain scores t.test(lesson3d$b, lesson3d$a, paired = TRUE, var.equal = TRUE) ## ## Paired t-test ## ## data: lesson3d$b and lesson3d$a ## t = -4.4912, df = 33, p-value = 8.19e-05 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -35.17110 -13.24067 ## sample estimates: ## mean of the differences ## -24.20588 Test whether the difference between scores is different from zero: # t-test for whether difference between before and after scores is different than zero t.test(lesson3d$d, mu = 0) ## ## One Sample t-test ## ## data: lesson3d$d ## t = 4.4912, df = 33, p-value = 8.19e-05 ## alternative hypothesis: true mean is not equal to 0 ## 95 percent confidence interval: ## 13.24067 35.17110 ## sample estimates: ## mean of x ## 24.20588 Both methods give you an identical p-value of &lt;0.001. But note, I didnt ask for the p-value. I asked Does acupuncture increase range of motion? Given that this is an uncontrolled trial, it may be that range of motion has improved naturally over time. So in fact you cant answer the question about whether acupuncture increases range of motion from these data! BTW: for those who are interested, acupuncture has been shown to improve neck pain and range of motion in a controlled trial, see: Irnich, Behrens et al., Immediate effects of dry needling and acupuncture at distant points in chronic neck pain: results of a randomized, double-blind, sham-controlled crossover trial. # Test whether proportion of women is different from 50% binom.test(sum(lesson3d$sex), nrow(lesson3d %&gt;% filter(!is.na(sex))), p = 0.5) ## ## Exact binomial test ## ## data: sum(lesson3d$sex) and nrow(lesson3d %&gt;% filter(!is.na(sex))) ## number of successes = 9, number of trials = 34, p-value = 0.009041 ## alternative hypothesis: true probability of success is not equal to 0.5 ## 95 percent confidence interval: ## 0.1288174 0.4436154 ## sample estimates: ## probability of success ## 0.2647059 Only about a quarter of the patients are women, and the binomial test gives a p-value of 0.009, suggesting that men are over-represented in this trial. But is this important? # t-test for whether age is significantly different from 58.2 t.test(lesson3d$age, mu = 58.2) ## ## One Sample t-test ## ## data: lesson3d$age ## t = -2.261, df = 33, p-value = 0.03048 ## alternative hypothesis: true mean is not equal to 58.2 ## 95 percent confidence interval: ## 46.30921 57.57315 ## sample estimates: ## mean of x ## 51.94118 Similarly, this t-test for age gives a p-value of 0.030, but I doubt anyone would call a mean age of 52 much different from a mean age of 58, so youd probably want to say that, ok, the trial patients are younger than we might expect, but not by much. 9.3.5 lesson3e.rds These data are length of stay from two different hospitals. One of the hospitals uses a new chemotherapy regime that is said to reduce adverse events and therefore length of stay. Does the new regime decrease length of stay? Well, before running off and doing t-tests, lets have a look at the data: # Summarize data by hospital lesson3e %&gt;% group_by(hospital) %&gt;% skim() Table 9.3: Data summary Name Piped data Number of rows 57 Number of columns 2 _______________________ Column type frequency: numeric 1 ________________________ Group variables hospital Variable type: numeric skim_variable hospital n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist los a 0 1 44.86 13.57 30 34.00 41 55.0 79  los b 0 1 45.14 10.85 28 39.25 45 50.5 70  This shows us the mean, median, etc. for length of stay by hospital. The two sets of data look very similar. Regardless of whether we do a t-test or non-parametric test, we do not see a difference between groups, p is &gt;0.9 or 0.7. Interesting question: should you report a 95% confidence interval for the difference between groups? This shows, for example, that the new regimen could reduce length of stay by up to six days, surely important in cost terms. On the other hand, this is not a randomized trial. There might be all sorts of differences between the hospitals other than the different chemotherapy regime, such as the mix of patients, discharge policies etc. So you would have to be careful in stating that the chemotherapy regime could reduce hospital stay by as much as six days or some such. For advanced students only: The data are non-normally distributed so you could try a log transform: # Create variable for log of length of stay lesson3e &lt;- lesson3e %&gt;% mutate(loglos = log(los)) The distribution of this new variable for both groups combined is normal, therefore data in each group will be normal. Try a t-test: # paired t-test using log of length of stay as outcome t.test(loglos ~ hospital, data = lesson3e, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: loglos by hospital ## t = -0.29426, df = 55, p-value = 0.7697 ## alternative hypothesis: true difference in means between group a and group b is not equal to 0 ## 95 percent confidence interval: ## -0.1594693 0.1186343 ## sample estimates: ## mean in group a mean in group b ## 3.762733 3.783150 The p-value is similar to the untransformed analyses. Now, look at the difference between means -0.02 and 95% confidence interval (-0.16, 0.12). To backtransform these values, you have to remember that addition on a log scale is the same as multiplication on an untransformed scale. Backtransform -0.02 using exp(-0.02) and you get 1.0. In other words, length of stay in hospital a is 98% more (or 2.0% less) compared to hospital b. Do the same things with the upper and lower bounds of the confidence interval and you might conclude that the difference in length of stay is between 15% less in hospital a to 13% less in hospital b. If you wanted to convert these numbers to actual days, just multiply by the mean hospital stay in group b by 1.0, 0.85 and 1.13. 9.3.6 lesson3f.rds These data are from a randomized trial on the effects of physiotherapy treatment on function in pediatric patients recovering from cancer surgery. Function is measured on a 100 point scale. Does physiotherapy help improve function? You will want to do an unpaired t-test or non-parametric test on these data. # unpaired t-test for change in pain by physiotherapy group t.test(delta ~ physio, data = lesson3f, paired = FALSE, var.equal = TRUE) ## ## Two Sample t-test ## ## data: delta by physio ## t = -1.4868, df = 110, p-value = 0.1399 ## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0 ## 95 percent confidence interval: ## -16.668572 2.378662 ## sample estimates: ## mean in group 0 mean in group 1 ## 11.70690 18.85185 This gives a p-value of 0.14 (incidentally, dont say p &gt; 0.05 or p=0.1399, which are under- and over-precise, respectively). Given a p-value greater than 5%, we would say that we found no evidence that the treatment was effective. But is this really the case? Look at the read out from the t-test again, particularly the means for each group and the difference. The improvements in the treatment group was about 50% greater than in controls. The 95% confidence interval for the difference includes a possible 17 point improvement on physiotherapy, more than twice that of controls. So physiotherapy might well be a clinically important treatment in this population, even if we failed to prove it was better than control in this trial. Whatever your conclusion, dont just report the p-value: report the means and standard deviations in each group separately plus the difference between means and a 95% confidence interval. If I was writing this up for a journal, I might say: Mean improvement in function was greater in the 54 physiotherapy group patients (18.9 points, SD 24.6) than in the 58 controls (11.7, SD 26.1). Although by t-test the difference between groups (7.1) was not statistically significant (p=0.14), the 95% confidence interval (-2.4, 33.3) includes clinically relevant effects. This suggests that the trial may have been underpowered to detect meaningful differences between groups. An alternative conclusion, which I think I actually prefer, would be to focus on the difference between groups of 7.1, deciding whether this is clinically significant. 9.4 Week 4 # Week 4: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 4: load data lesson4a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4a.rds&quot;)) lesson4b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4b.rds&quot;)) lesson4c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4c.rds&quot;)) lesson4d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4d.rds&quot;)) lesson4e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 4&quot;, &quot;lesson4e.rds&quot;)) 9.4.1 lesson4a.rds This is a dataset on fifteen patients recording whether they had problematic nausea or vomiting after chemotherapy (defined as grade 2 or higher for either nausea or vomiting) and whether they reported being prone to travel sickness. Does travel sickness predict chemotherapy nausea and vomiting? To have a quick look at the data, create a two-by-two table: # Create formatted table of nausea/vomiting by car sickness history tbl_summary( lesson4a %&gt;% select(nv, cs), by = cs, type = list(&quot;nv&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #zlxeaoptgx .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #zlxeaoptgx .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zlxeaoptgx .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #zlxeaoptgx .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #zlxeaoptgx .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zlxeaoptgx .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zlxeaoptgx .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #zlxeaoptgx .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #zlxeaoptgx .gt_column_spanner_outer:first-child { padding-left: 0; } #zlxeaoptgx .gt_column_spanner_outer:last-child { padding-right: 0; } #zlxeaoptgx .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #zlxeaoptgx .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #zlxeaoptgx .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #zlxeaoptgx .gt_from_md > :first-child { margin-top: 0; } #zlxeaoptgx .gt_from_md > :last-child { margin-bottom: 0; } #zlxeaoptgx .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #zlxeaoptgx .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #zlxeaoptgx .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zlxeaoptgx .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #zlxeaoptgx .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zlxeaoptgx .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #zlxeaoptgx .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #zlxeaoptgx .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zlxeaoptgx .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zlxeaoptgx .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #zlxeaoptgx .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zlxeaoptgx .gt_sourcenote { font-size: 90%; padding: 4px; } #zlxeaoptgx .gt_left { text-align: left; } #zlxeaoptgx .gt_center { text-align: center; } #zlxeaoptgx .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #zlxeaoptgx .gt_font_normal { font-weight: normal; } #zlxeaoptgx .gt_font_bold { font-weight: bold; } #zlxeaoptgx .gt_font_italic { font-style: italic; } #zlxeaoptgx .gt_super { font-size: 65%; } #zlxeaoptgx .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 61 1, N = 91 grade 2 or above nausea 1 =yes 0 4 (67%) 4 (44%) 1 2 (33%) 5 (56%) 1 n (%) This shows, for example, 56% of those who get car sick reported problematic nausea compared to only 33% of those who arent prone to car sickness. To find out whether this is statistically significant (it certainly seems clinically significant), you can use the chisq.test or the fisher.test function. For the chisq.test function, remember to use the correct = FALSE option to get the p-value without continuity correction. # Chi squared test chisq.test(table(lesson4a$nv, lesson4a$cs), correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: table(lesson4a$nv, lesson4a$cs) ## X-squared = 0.71429, df = 1, p-value = 0.398 # Fisher&#39;s exact test fisher.test(table(lesson4a$nv, lesson4a$cs)) ## ## Fisher&#39;s Exact Test for Count Data ## ## data: table(lesson4a$nv, lesson4a$cs) ## p-value = 0.6084 ## alternative hypothesis: true odds ratio is not equal to 1 ## 95 percent confidence interval: ## 0.1989474 39.4980687 ## sample estimates: ## odds ratio ## 2.348722 chisq.test gives the p-value from a chi-squared test, fisher.test is a special form of this test when any of the numbers in the table are small, say 10 or below in any cell. The p-value is about 0.6. You now have 3 options: Declare the result non-statistically significant, and conclude that you have failed to reject the null hypothesis of no difference between groups. Say that, though differences between groups were not statistically significant, sample size was too small. Say that differences between groups were not statistically significant, and that the study was too small, but try to quantify a plausible range of possible differences between groups. For point 3, you need the confidence interval. You get this by using the epi.2by2 command. # Confidence interval for difference between groups epi.2by2(matrix(rev(table(lesson4a$cs, lesson4a$nv)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 5 4 9 55.6 1.250 ## Exposed - 2 4 6 33.3 0.500 ## Total 7 8 15 46.7 0.875 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 1.67 (0.47, 5.96) ## Odds ratio 2.50 (0.29, 21.40) ## Attrib risk * 22.22 (-27.54, 71.99) ## Attrib risk in population * 13.33 (-32.06, 58.72) ## Attrib fraction in exposed (%) 40.00 (-114.41, 83.21) ## Attrib fraction in population (%) 28.57 (-78.75, 71.46) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 0.714 Pr&gt;chi2 = 0.40 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units This gives a risk ratio (same as relative risk) of 1.67 with a 95% CI 0.47, 5.96. A model answer might be: Five of the nine patients (56%) who reported prior car sickness had grade 2 or higher nausea and vomiting compared to two of the six (33%) who reported no prior car sickness. Though differences between groups were not statistically significant (p=0.6 by Fishers exact test), the sample size was small and the 95% confidence interval for the difference between groups includes differences of clinical relevance (relative risk 1.67; 95% CI 0.47, 5.96). It may be, for example, that problematic nausea and vomiting is up to six times more common in patients reporting prior car sickness than in those who do not. 9.4.2 lesson4b.rds An epidemiological study of meat consumption and hypertension. Meat consumption was defined as low, medium or high depending on whether subjects ate less than 3, 3 to 7 or 7 + meals with meat per week. Does meat consumption lead to hypertension? There are three levels of meat consumption. The outcome (hypertension) is binary, either 1 or 0. So we will have a 3 by 2 table. Lets start with a quick look: # Formatted table of meat consumption by hypertension status tbl_summary( lesson4b %&gt;% select(meat, hbp), by = hbp ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #hgemkgngwa .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #hgemkgngwa .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hgemkgngwa .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #hgemkgngwa .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #hgemkgngwa .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hgemkgngwa .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #hgemkgngwa .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #hgemkgngwa .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #hgemkgngwa .gt_column_spanner_outer:first-child { padding-left: 0; } #hgemkgngwa .gt_column_spanner_outer:last-child { padding-right: 0; } #hgemkgngwa .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #hgemkgngwa .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #hgemkgngwa .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #hgemkgngwa .gt_from_md > :first-child { margin-top: 0; } #hgemkgngwa .gt_from_md > :last-child { margin-bottom: 0; } #hgemkgngwa .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #hgemkgngwa .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #hgemkgngwa .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hgemkgngwa .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #hgemkgngwa .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #hgemkgngwa .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #hgemkgngwa .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #hgemkgngwa .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #hgemkgngwa .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hgemkgngwa .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #hgemkgngwa .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #hgemkgngwa .gt_sourcenote { font-size: 90%; padding: 4px; } #hgemkgngwa .gt_left { text-align: left; } #hgemkgngwa .gt_center { text-align: center; } #hgemkgngwa .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #hgemkgngwa .gt_font_normal { font-weight: normal; } #hgemkgngwa .gt_font_bold { font-weight: bold; } #hgemkgngwa .gt_font_italic { font-style: italic; } #hgemkgngwa .gt_super { font-size: 65%; } #hgemkgngwa .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 351 1, N = 711 consumption 1=lo, 2=med, 3=hi 1 16 (46%) 16 (23%) 2 10 (29%) 13 (18%) 3 9 (26%) 42 (59%) 1 n (%) This would tell you, for example, that of the patients with hypertension, 59% ate a lot of meat and only 23% ate a little. I find this a less helpful statistic than presenting the data in terms of rates of hypertension for level of meat consumption. One other thing to notice is that the rates of hypertension are high, suggesting this is a selected population. You also could have created this table: # Formatted table of meat consumption by hypertension status (row percents) tbl_summary( lesson4b %&gt;% select(meat, hbp), by = hbp, percent = &quot;row&quot; ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vnsfmmrbvs .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vnsfmmrbvs .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vnsfmmrbvs .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vnsfmmrbvs .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vnsfmmrbvs .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vnsfmmrbvs .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vnsfmmrbvs .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vnsfmmrbvs .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vnsfmmrbvs .gt_column_spanner_outer:first-child { padding-left: 0; } #vnsfmmrbvs .gt_column_spanner_outer:last-child { padding-right: 0; } #vnsfmmrbvs .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vnsfmmrbvs .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vnsfmmrbvs .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vnsfmmrbvs .gt_from_md > :first-child { margin-top: 0; } #vnsfmmrbvs .gt_from_md > :last-child { margin-bottom: 0; } #vnsfmmrbvs .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vnsfmmrbvs .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vnsfmmrbvs .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vnsfmmrbvs .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vnsfmmrbvs .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vnsfmmrbvs .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vnsfmmrbvs .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vnsfmmrbvs .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vnsfmmrbvs .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vnsfmmrbvs .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vnsfmmrbvs .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vnsfmmrbvs .gt_sourcenote { font-size: 90%; padding: 4px; } #vnsfmmrbvs .gt_left { text-align: left; } #vnsfmmrbvs .gt_center { text-align: center; } #vnsfmmrbvs .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vnsfmmrbvs .gt_font_normal { font-weight: normal; } #vnsfmmrbvs .gt_font_bold { font-weight: bold; } #vnsfmmrbvs .gt_font_italic { font-style: italic; } #vnsfmmrbvs .gt_super { font-size: 65%; } #vnsfmmrbvs .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 351 1, N = 711 consumption 1=lo, 2=med, 3=hi 1 16 (50%) 16 (50%) 2 10 (43%) 13 (57%) 3 9 (18%) 42 (82%) 1 n (%) These tables show the number and percentages of patients with hypertension in each category of meat eating. Rates of hypertension are 50%, 57% and 82% in the low, medium and high meat consumption groups, respectively. To assess statistical significance, use the chisq.test function with the hypertension by meat consumption table as the input. # Chi squared test for association between meat consumption and hypertension chisq.test(table(lesson4b$hbp, lesson4b$meat), correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: table(lesson4b$hbp, lesson4b$meat) ## X-squared = 10.759, df = 2, p-value = 0.004611 The p-value is p=0.005. How to interpret this? The formal statistical interpretation is that we can reject the null hypothesis that rates of hypertension are the same in each group. To demonstrate this, try renumbering the labels for the variable meat: # Change values of meat consumption variable lesson4b_changed &lt;- lesson4b %&gt;% mutate( meat = case_when( meat == 3 ~ 0.98573, meat == 2 ~ 60, meat == 1 ~ 643 ) ) # Re-run chi squared test chisq.test(table(lesson4b_changed$hbp, lesson4b_changed$meat), correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: table(lesson4b_changed$hbp, lesson4b_changed$meat) ## X-squared = 10.759, df = 2, p-value = 0.004611 You get exactly the same result. This demonstrates that: a) the numbers you use for meat consumption act only as labels; b) the order is unimportant: you get the same p-value if you arrange the columns low med hi as hi low med. So it might be useful to do what are called pairwise comparisons: what difference is there in the rate of hypertension between low and medium meat eaters? What about high and low? Though there are three possible comparisons (hi v. lo; hi v. med; med v. lo), it is more usual to chose either the highest or lowest category and compare everything to that. The way to do these analyses is to create new variables. The code is given below (the #s are comments that are ignored by R). # Create a new variable &quot;c1&quot; which is &quot;1&quot; if meat consumption is high and &quot;0&quot; if it is medium # &quot;c1&quot; is missing for low meat consumption: these patients are left out of the analysis lesson4b &lt;- lesson4b %&gt;% mutate( c1 = case_when( meat == 2 ~ 0, meat == 3 ~ 1 ) ) # Test for difference between medium and high meat consumption epi.2by2(matrix(rev(table(lesson4b$c1, lesson4b$hbp)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 42 9 51 82.4 4.67 ## Exposed - 13 10 23 56.5 1.30 ## Total 55 19 74 74.3 2.89 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 1.46 (1.00, 2.13) ## Odds ratio 3.59 (1.20, 10.73) ## Attrib risk * 25.83 (3.03, 48.63) ## Attrib risk in population * 17.80 (-4.77, 40.37) ## Attrib fraction in exposed (%) 31.37 (-0.39, 53.08) ## Attrib fraction in population (%) 23.95 (-1.91, 43.25) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 5.542 Pr&gt;chi2 = 0.02 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units # Compare high vs low consumption # &quot;c2&quot; is &quot;1&quot; if meat consumption is high and &quot;0&quot; if it is low # &quot;c2&quot; is missing for medium meat consumption: these patients are left out of the analysis lesson4b &lt;- lesson4b %&gt;% mutate( c2 = case_when( meat == 1 ~ 0, meat == 3 ~ 1 ) ) # Test for difference between low and high meat consumption epi.2by2(matrix(rev(table(lesson4b$c2, lesson4b$hbp)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 42 9 51 82.4 4.67 ## Exposed - 16 16 32 50.0 1.00 ## Total 58 25 83 69.9 2.32 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 1.65 (1.14, 2.38) ## Odds ratio 4.67 (1.72, 12.68) ## Attrib risk * 32.35 (12.11, 52.59) ## Attrib risk in population * 19.88 (-0.06, 39.82) ## Attrib fraction in exposed (%) 39.29 (12.19, 58.02) ## Attrib fraction in population (%) 28.45 (6.12, 45.47) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 9.778 Pr&gt;chi2 = 0.00 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units What these commands do is to create new variables (c1 and c2) that are used instead of the variable meat in analyses. These are set to 1 or 0 or missing depending on the pairwise comparison that you want to do. A model answer might be as follows: The results of the study are shown in the table. Differences in rates of hypertension between categories of meat consumption are statistically significant (p=0.005). Rates of hypertension rise with increasing meat consumption: patients with the highest meat consumption had a risk of hypertension 1.5 times greater than those with intermediate meat consumption (95% CI 1.0, 2.1, p=0.019) and 1.6 times greater than those with the lowest levels of meat consumption (95% CI 1.1, 2.4, p=0.002). Rates of hypertension were similar between medium and low meat consumption (relative risk 1.1; 95% CI 0.69, 1.9, p=0.6). html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #gfhbrxnasc .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #gfhbrxnasc .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gfhbrxnasc .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #gfhbrxnasc .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #gfhbrxnasc .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gfhbrxnasc .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gfhbrxnasc .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #gfhbrxnasc .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #gfhbrxnasc .gt_column_spanner_outer:first-child { padding-left: 0; } #gfhbrxnasc .gt_column_spanner_outer:last-child { padding-right: 0; } #gfhbrxnasc .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #gfhbrxnasc .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #gfhbrxnasc .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #gfhbrxnasc .gt_from_md > :first-child { margin-top: 0; } #gfhbrxnasc .gt_from_md > :last-child { margin-bottom: 0; } #gfhbrxnasc .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #gfhbrxnasc .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #gfhbrxnasc .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gfhbrxnasc .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #gfhbrxnasc .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gfhbrxnasc .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #gfhbrxnasc .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #gfhbrxnasc .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gfhbrxnasc .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gfhbrxnasc .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #gfhbrxnasc .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gfhbrxnasc .gt_sourcenote { font-size: 90%; padding: 4px; } #gfhbrxnasc .gt_left { text-align: left; } #gfhbrxnasc .gt_center { text-align: center; } #gfhbrxnasc .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #gfhbrxnasc .gt_font_normal { font-weight: normal; } #gfhbrxnasc .gt_font_bold { font-weight: bold; } #gfhbrxnasc .gt_font_italic { font-style: italic; } #gfhbrxnasc .gt_super { font-size: 65%; } #gfhbrxnasc .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic No Hypertension, N = 351 Hypertension, N = 711 Overall, N = 1061 Meat Consumption Low 16 (50%) 16 (50%) 32 (100%) Medium 10 (43%) 13 (57%) 23 (100%) High 9 (18%) 42 (82%) 51 (100%) 1 n (%) You might note that I chose to compare low and medium meat consumption, that is, give all three pairwise comparisons rather than just high v. low and high v. medium. This is probably the exception rather than the rule: in this particular case, it seems worth reporting because the low and medium groups seem very comparable compared to high meat consumption. And now, the key point You may have noticed that my model answer did not actually answer the question. The question was does meat consumption lead to hypertension? I only answered in terms of rates of hypertension rising with increased meat consumption and the like. This is because you cannot use statistics to prove causality without thinking about the research design. If you go out and ask how much meat people eat and then measure their blood pressure, you cannot assume that any associations are causal. It may be, for example, that meat eaters tend to smoke more and it is smoking, not meat, that causes hypertension. 9.4.3 lesson4c.rds This is a dataset from a chemotherapy study. The researchers think that a mutation of a certain gene may be associated with chemotherapy toxicity. Should clinicians test for the gene during pre-chemotherapy work up? It is immediately obvious from this table that there are very few patients who are homozygous mutant type. # Formatted two-way table of genes by toxicity outcome tbl_summary( lesson4c %&gt;% select(gene, toxicity), by = toxicity ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tlnsbgwbeq .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tlnsbgwbeq .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tlnsbgwbeq .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tlnsbgwbeq .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #tlnsbgwbeq .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tlnsbgwbeq .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tlnsbgwbeq .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tlnsbgwbeq .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tlnsbgwbeq .gt_column_spanner_outer:first-child { padding-left: 0; } #tlnsbgwbeq .gt_column_spanner_outer:last-child { padding-right: 0; } #tlnsbgwbeq .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #tlnsbgwbeq .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #tlnsbgwbeq .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #tlnsbgwbeq .gt_from_md > :first-child { margin-top: 0; } #tlnsbgwbeq .gt_from_md > :last-child { margin-bottom: 0; } #tlnsbgwbeq .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tlnsbgwbeq .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #tlnsbgwbeq .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tlnsbgwbeq .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #tlnsbgwbeq .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tlnsbgwbeq .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tlnsbgwbeq .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tlnsbgwbeq .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tlnsbgwbeq .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tlnsbgwbeq .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #tlnsbgwbeq .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tlnsbgwbeq .gt_sourcenote { font-size: 90%; padding: 4px; } #tlnsbgwbeq .gt_left { text-align: left; } #tlnsbgwbeq .gt_center { text-align: center; } #tlnsbgwbeq .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tlnsbgwbeq .gt_font_normal { font-weight: normal; } #tlnsbgwbeq .gt_font_bold { font-weight: bold; } #tlnsbgwbeq .gt_font_italic { font-style: italic; } #tlnsbgwbeq .gt_super { font-size: 65%; } #tlnsbgwbeq .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 2041 1, N = 1001 0=homozygous wild type; 1=heterozygous; 2 = homozygous mutant 0 134 (66%) 80 (80%) 1 65 (32%) 19 (19%) 2 5 (2.5%) 1 (1.0%) 1 n (%) It would seem appropriate to combine heterozygotes and homozygous mutant type into a single category. You might be tempted to type lesson4c %&gt;% mutate(gene = if_else(gene == 2, 1, gene)). But you should avoid changing raw data in this way: it would be preferable to create a new variable as follows: # Create binary variable grouping the values of &quot;1&quot; and &quot;2&quot; for gene lesson4c &lt;- lesson4c %&gt;% mutate( mutant = case_when( gene == 1 | gene == 2 ~ 1, gene == 0 ~ 0 ) ) Moreover, it would be worth reporting the results of an analysis using all three groups, to investigate whether the conclusions change. This is sometimes called a sensitivity analysis. The results of the study are shown in the table. Very few participants (6 (2.0%)) were homozygous mutant. For the purposes of analysis therefore, data for these participants was combined with those heterozygous for the gene. Patients with any mutant allele (i.e. heterozygous or homozygous mutant) had lower rates of toxicity (20% vs 80%, p=0.010 by chi squared). The relative risk of toxicity is 0.59 compared to patients with the wild-type (95% CI 0.39, 0.91). This conclusion is not sensitive to the method of analysis: analysis of the table keeping participants in three groups gives p=0.033 by an exact test. These findings should be confirmed in a larger series. In particular, it would be interesting to know whether patients who are homozygous mutant are at particularly increased risk. html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #bixqbsxufc .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #bixqbsxufc .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bixqbsxufc .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #bixqbsxufc .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #bixqbsxufc .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bixqbsxufc .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bixqbsxufc .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #bixqbsxufc .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #bixqbsxufc .gt_column_spanner_outer:first-child { padding-left: 0; } #bixqbsxufc .gt_column_spanner_outer:last-child { padding-right: 0; } #bixqbsxufc .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #bixqbsxufc .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #bixqbsxufc .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #bixqbsxufc .gt_from_md > :first-child { margin-top: 0; } #bixqbsxufc .gt_from_md > :last-child { margin-bottom: 0; } #bixqbsxufc .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #bixqbsxufc .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #bixqbsxufc .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bixqbsxufc .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #bixqbsxufc .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bixqbsxufc .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #bixqbsxufc .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #bixqbsxufc .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bixqbsxufc .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bixqbsxufc .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #bixqbsxufc .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bixqbsxufc .gt_sourcenote { font-size: 90%; padding: 4px; } #bixqbsxufc .gt_left { text-align: left; } #bixqbsxufc .gt_center { text-align: center; } #bixqbsxufc .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #bixqbsxufc .gt_font_normal { font-weight: normal; } #bixqbsxufc .gt_font_bold { font-weight: bold; } #bixqbsxufc .gt_font_italic { font-style: italic; } #bixqbsxufc .gt_super { font-size: 65%; } #bixqbsxufc .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic No Grade III/IV Toxicity, N = 2041 Grade III/IV Toxicity, N = 1001 Overall, N = 3041 Gene Homozygous wild type 134 (63%) 80 (37%) 214 (100%) Heterozygous 65 (77%) 19 (23%) 84 (100%) Homozygous mutant 5 (83%) 1 (17%) 6 (100%) 1 n (%) Genetics type people: note that this gene is in Hardy Weinberg equilibrium! One thing to note is my conclusion, the answer to the question. It would be a little premature to start changing clinical practice on the basis of a single study with a moderate number of patients and a less than overwhelming strength of evidence. Also, it is questionable whether you should start using a test just because it is predictive: you should use a test if it improves clinical outcome. 9.4.4 lesson4d.rds Patients are given chemotherapy regimen a or b and assessed for tumor response. Which regimen would you recommend to a patient? Do the treatments work differently depending on age or sex? The first thing we want to do is compare response by group. But using epi.2by2 with response and chemo doesnt work. This is because the exposure variable has to be numeric (for example, 0 and 1), not a or b. So you need to use the group variable instead of the chemo variable. This gives response rates of 48% on regimen a and 40% on regimen b, a relative risk of 0.84 and a p-value of 0.11. Should we conclude that there is no difference between groups and that you should feel free to use either regimen? Imagine you are a patient. You are told that you have a 50:50 chance of response on one regimen but only a 40% chance on the other. Unless there are good reasons to choose between the regimes (e.g. toxicity), which would you choose? The point here is that statistical significance does not really inform choices between similar alternatives. Assuming that toxicity, cost and inconvenience are similar between the regimes, I would recommend regimen a, even though the difference is not statistically significant. The confidence interval here is absolutely critical: the 95% C.I. for the risk difference is -18%, 1.7%. In other words, the response rate could be 18% higher on regimen a (e.g. 55% vs. 37%) or 2% lower (e.g. 50% vs. 52%). So you might do a lot better with regimen a, you are unlikely to do much worse. The sub-group analyses A common mistake would be to use epi.2by2 with response and sex. However, this would examine whether, regardless of chemotherapy regimen used, men and women had different tumor outcome. What we want to see if the difference between treatment a and b changes depending on whether male or female patients are being treated. To do this analysis, we first need to split the dataset up into two groups, one dataset including only men and the other including only women. You can use the filter function that youve previously seen to separate out males and females into different data sets. Here, sex is categorized as 0 for male and 1 for female. # Use &quot;filter&quot; to select only male patients lesson4d_males &lt;- lesson4d %&gt;% filter(sex == 0) # To confirm: table(lesson4d_males$sex) ## ## 0 ## 294 # Use &quot;filter&quot; to select only female patients lesson4d_females &lt;- lesson4d %&gt;% filter(sex == 1) # To confirm: table(lesson4d_females$sex) ## ## 1 ## 106 # Males (sex == 0) epi.2by2(matrix(rev(table(lesson4d_males$group, lesson4d_males$response)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 54 84 138 39.1 0.643 ## Exposed - 80 76 156 51.3 1.053 ## Total 134 160 294 45.6 0.838 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 0.76 (0.59, 0.99) ## Odds ratio 0.61 (0.38, 0.97) ## Attrib risk * -12.15 (-23.46, -0.85) ## Attrib risk in population * -5.70 (-15.40, 3.99) ## Attrib fraction in exposed (%) -31.05 (-69.67, -1.23) ## Attrib fraction in population (%) -12.51 (-24.99, -1.28) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 4.359 Pr&gt;chi2 = 0.04 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units # Females (sex == 1) epi.2by2(matrix(rev(table(lesson4d_females$group, lesson4d_females$response)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 27 35 62 43.5 0.771 ## Exposed - 17 27 44 38.6 0.630 ## Total 44 62 106 41.5 0.710 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 1.13 (0.71, 1.80) ## Odds ratio 1.23 (0.56, 2.69) ## Attrib risk * 4.91 (-14.04, 23.87) ## Attrib risk in population * 2.87 (-14.30, 20.05) ## Attrib fraction in exposed (%) 11.28 (-41.66, 44.44) ## Attrib fraction in population (%) 6.92 (-24.07, 30.17) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 0.256 Pr&gt;chi2 = 0.61 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units What you get is a statistically significant difference between treatment groups for men (many more respond on regimen a) but not women (actually a few more respond on regimen b). How to interpret this? In the literature, this might well be trumpeted as showing that though either regimen could be used for women, regimen a is better for men. My own view is that sub-group analyses are hypothesis generating not hypothesis testing. In particular, is there any reason to believe that response to chemotherapy might depend on sex? I dont think there are any cases of this. Testing age is a little more difficult as it is a continuous variable. One typical approach might be to create two sub-groups depending on the median. First, quantile(lesson4d$age, c(0.5), na.rm = TRUE) gives a median age of 42. So: # Use &quot;filter&quot; again to select age lesson4d_younger &lt;- lesson4d %&gt;% filter(age &lt;= 42) lesson4d_older &lt;- lesson4d %&gt;% filter(age &gt; 42) # Younger patients epi.2by2(matrix(rev(table(lesson4d_younger$group, lesson4d_younger$response)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 44 52 96 45.8 0.846 ## Exposed - 56 47 103 54.4 1.191 ## Total 100 99 199 50.3 1.010 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 0.84 (0.64, 1.12) ## Odds ratio 0.71 (0.41, 1.24) ## Attrib risk * -8.54 (-22.39, 5.32) ## Attrib risk in population * -4.12 (-15.98, 7.75) ## Attrib fraction in exposed (%) -18.62 (-57.01, 10.38) ## Attrib fraction in population (%) -8.19 (-22.47, 4.42) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 1.448 Pr&gt;chi2 = 0.23 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units # Older patients epi.2by2(matrix(rev(table(lesson4d_older$group, lesson4d_older$response)), nrow = 2)) ## Outcome + Outcome - Total Inc risk * Odds ## Exposed + 36 66 102 35.3 0.545 ## Exposed - 41 56 97 42.3 0.732 ## Total 77 122 199 38.7 0.631 ## ## Point estimates and 95% CIs: ## ------------------------------------------------------------------- ## Inc risk ratio 0.84 (0.59, 1.19) ## Odds ratio 0.75 (0.42, 1.32) ## Attrib risk * -6.97 (-20.49, 6.54) ## Attrib risk in population * -3.57 (-15.51, 8.36) ## Attrib fraction in exposed (%) -19.76 (-70.10, 15.68) ## Attrib fraction in population (%) -9.24 (-28.78, 7.33) ## ------------------------------------------------------------------- ## Test that OR = 1: chi2(1) = 1.019 Pr&gt;chi2 = 0.31 ## Wald confidence limits ## CI: confidence interval ## * Outcomes per 100 population units You get no difference between groups for either older or younger patients. As it turns out, this is not a very efficient method of testing for age differences. A better technique will be discussed in the class on regression. Interaction or sub-group analysis? There is a further problem here: we have one question (do effects differ between men and women?) and two p-values (one for men and one for women). What you really want is one p-value to answer one question. The correct statistical technique for looking at whether the effects of treatment differ between sub-groups is called interaction. We will look at this later in the course. In the meantime, if you are interested, you can read some brief articles at: Statistics Notes: Interaction 1: heterogeneity of effects Statistics Notes: Interaction 2: compare effect sizes not p-values Statistics Notes: Interaction 3: How to examine heterogeneity 9.4.5 lesson4e.rds This is a lab study of two candidate tumor-suppressor genes (gene1 and gene2). Wild-type mice are compared with mice that have gene1 knocked-out, gene2 knocked-out or both. The presence of tumors is measured after 30 days. Do the genes suppress cancer? The obvious thing to do would be to use epi.2by2 with cancer and gene1, and then with cancer and gene2. Superficially this would suggest that gene1 is a tumor suppressor gene and gene2 is not. However, dont get too fixated on p-values. The proportion of cancer in mice with gene2 knocked out is over twice that of controls. Remember that animal experiments tend to use a very small number of observations (a typical clinical trial has hundreds of patients, a typical lab study has maybe a dozen mice). So you might want to say that there is good evidence that gene1 is a tumor suppressor gene but that whilst evidence is suggestive for gene2, more research is needed. A BIG HOWEVER - have a look at the data or this table: # Formatted table of gene1 by gene2 tbl_summary( lesson4e %&gt;% select(gene1, gene2), by = gene2, type = list(&quot;gene1&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jrfpnysbvm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jrfpnysbvm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jrfpnysbvm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jrfpnysbvm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #jrfpnysbvm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jrfpnysbvm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jrfpnysbvm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jrfpnysbvm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jrfpnysbvm .gt_column_spanner_outer:first-child { padding-left: 0; } #jrfpnysbvm .gt_column_spanner_outer:last-child { padding-right: 0; } #jrfpnysbvm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #jrfpnysbvm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #jrfpnysbvm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #jrfpnysbvm .gt_from_md > :first-child { margin-top: 0; } #jrfpnysbvm .gt_from_md > :last-child { margin-bottom: 0; } #jrfpnysbvm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jrfpnysbvm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #jrfpnysbvm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jrfpnysbvm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #jrfpnysbvm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jrfpnysbvm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jrfpnysbvm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jrfpnysbvm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jrfpnysbvm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jrfpnysbvm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #jrfpnysbvm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jrfpnysbvm .gt_sourcenote { font-size: 90%; padding: 4px; } #jrfpnysbvm .gt_left { text-align: left; } #jrfpnysbvm .gt_center { text-align: center; } #jrfpnysbvm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jrfpnysbvm .gt_font_normal { font-weight: normal; } #jrfpnysbvm .gt_font_bold { font-weight: bold; } #jrfpnysbvm .gt_font_italic { font-style: italic; } #jrfpnysbvm .gt_super { font-size: 65%; } #jrfpnysbvm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 121 1, N = 121 gene1 0 6 (50%) 6 (50%) 1 6 (50%) 6 (50%) 1 n (%) The experimental design was to knockout no genes in some animals, gene1 in some animals, gene2 in other animals and both genes in a final set of animals. This is known as a factorial or Latin-square design. Analyzing rates of cancer for mice without gene1 or gene2, as suggested above, ignores this experimental design. Presumably the design was implemented because the researchers wanted to know if the effects of gene1 differed depending on whether gene2 had been knocked-out and vice versa. Now you could start doing separate sub-groups (e.g. using epi.2by2 for cancer and gene1, filtering by gene2==0 and gene2==1 separately) but this produces somewhat unhelpful results. For example, it suggests that gene1 has an effect for wild-type gene2 (p=0.046) but maybe not for knocked out gene2 (p=0.079). This has all the look and feel of a spurious sub-group analysis, however. We will discuss some regression approaches to this problem later in the lecture series. 9.5 Week 5 # Week 5: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 5: load data lesson5a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5a.rds&quot;)) lesson5b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5b.rds&quot;)) lesson5c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5c.rds&quot;)) lesson5d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5d.rds&quot;)) lesson5e &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5e.rds&quot;)) lesson5f &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5f.rds&quot;)) lesson5g &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5g.rds&quot;)) lesson5h &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5h.rds&quot;)) lesson5i &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5i.rds&quot;)) 9.5.1 lesson5a.rds These are data from marathon runners (again). Which of the following is associated with how fast runners complete the marathon: age, sex, training miles, weight? My guess here is that we are going to want to do a regression analysis. This would allow us to quantify the association between the various predictor variables and race time. For example, it would be interesting to know not only that number of weekly training miles is correlated with race time, but by how much you can reduce your race time if you increased your training by a certain amount. Our dependent variable is rt (race time in minutes), so we could type: # Create linear regression model for race time rt_model &lt;- lm(rt ~ age + sex + tr + wt, data = lesson5a) # Results of linear regression model summary(rt_model) ## ## Call: ## lm(formula = rt ~ age + sex + tr + wt, data = lesson5a) ## ## Residuals: ## Min 1Q Median 3Q Max ## -100.066 -26.311 -3.977 20.682 165.336 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 256.48412 18.29679 14.018 &lt; 2e-16 *** ## age 0.80819 0.25451 3.175 0.001719 ** ## sex 23.16076 6.02247 3.846 0.000159 *** ## tr -1.48529 0.20717 -7.169 1.23e-11 *** ## wt 0.04766 0.17133 0.278 0.781145 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 39.36 on 212 degrees of freedom ## (45 observations deleted due to missingness) ## Multiple R-squared: 0.2605, Adjusted R-squared: 0.2465 ## F-statistic: 18.67 on 4 and 212 DF, p-value: 3.677e-13 The p-values for all the predictor variables apart from weight are very low. A model answer might be: There were 262 runners in the dataset; full data were available for 217. Summary data for these 217 are given in table 1. Predictors of race time are shown in table 2. Age, sex and number of training miles were all statistically significant predictors of race time; weight is unlikely to have an important effect. Table 1 html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jgoecrbkrg .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jgoecrbkrg .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jgoecrbkrg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jgoecrbkrg .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #jgoecrbkrg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jgoecrbkrg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jgoecrbkrg .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jgoecrbkrg .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jgoecrbkrg .gt_column_spanner_outer:first-child { padding-left: 0; } #jgoecrbkrg .gt_column_spanner_outer:last-child { padding-right: 0; } #jgoecrbkrg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #jgoecrbkrg .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #jgoecrbkrg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #jgoecrbkrg .gt_from_md > :first-child { margin-top: 0; } #jgoecrbkrg .gt_from_md > :last-child { margin-bottom: 0; } #jgoecrbkrg .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jgoecrbkrg .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #jgoecrbkrg .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jgoecrbkrg .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #jgoecrbkrg .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jgoecrbkrg .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jgoecrbkrg .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jgoecrbkrg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jgoecrbkrg .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jgoecrbkrg .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #jgoecrbkrg .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jgoecrbkrg .gt_sourcenote { font-size: 90%; padding: 4px; } #jgoecrbkrg .gt_left { text-align: left; } #jgoecrbkrg .gt_center { text-align: center; } #jgoecrbkrg .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jgoecrbkrg .gt_font_normal { font-weight: normal; } #jgoecrbkrg .gt_font_bold { font-weight: bold; } #jgoecrbkrg .gt_font_italic { font-style: italic; } #jgoecrbkrg .gt_super { font-size: 65%; } #jgoecrbkrg .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 2171 Age (years) 42 (11) Female 61 (28%) Training miles per week 36 (13) Race time (minutes) 246 (45) Weight (kg) 76 (16) 1 Mean (SD); n (%) Table 2 html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mafemqyuoy .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mafemqyuoy .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mafemqyuoy .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mafemqyuoy .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mafemqyuoy .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mafemqyuoy .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mafemqyuoy .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mafemqyuoy .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mafemqyuoy .gt_column_spanner_outer:first-child { padding-left: 0; } #mafemqyuoy .gt_column_spanner_outer:last-child { padding-right: 0; } #mafemqyuoy .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mafemqyuoy .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mafemqyuoy .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mafemqyuoy .gt_from_md > :first-child { margin-top: 0; } #mafemqyuoy .gt_from_md > :last-child { margin-bottom: 0; } #mafemqyuoy .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mafemqyuoy .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mafemqyuoy .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mafemqyuoy .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mafemqyuoy .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mafemqyuoy .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mafemqyuoy .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mafemqyuoy .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mafemqyuoy .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mafemqyuoy .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mafemqyuoy .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mafemqyuoy .gt_sourcenote { font-size: 90%; padding: 4px; } #mafemqyuoy .gt_left { text-align: left; } #mafemqyuoy .gt_center { text-align: center; } #mafemqyuoy .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mafemqyuoy .gt_font_normal { font-weight: normal; } #mafemqyuoy .gt_font_bold { font-weight: bold; } #mafemqyuoy .gt_font_italic { font-style: italic; } #mafemqyuoy .gt_super { font-size: 65%; } #mafemqyuoy .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic Beta 95% CI1 p-value Age (years) 0.81 0.31, 1.3 0.002 Female 23 11, 35 Training miles per week -1.5 -1.9, -1.1 Weight (kg) 0.05 -0.29, 0.39 0.8 1 CI = Confidence Interval A real-life decision you could take away from this is that every additional mile you run in training would be predicted to cut about 1.5 minutes from your marathon time: add a couple of extra five mile runs per week and youll shave a quarter of an hour off your time. A couple of thoughts. First, you will note that I didnt remove weight from the model (that is, use a step wise approach) then report the coefficients and p-values for the new model (by typing lm(rt ~ age + sex + tr, data = lesson5a)). Second, race time is not normally distributed and the textbooks would have us believe that this invalidates a regression analysis. Lets try: # Create variable for log of race time lesson5a &lt;- lesson5a %&gt;% mutate( lt = log(rt) ) # Create linear regression model for log of race time rtlog_model &lt;- lm(lt ~ age + sex + tr + wt, data = lesson5a) # Results of linear regression model summary(rtlog_model) ## ## Call: ## lm(formula = lt ~ age + sex + tr + wt, data = lesson5a) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.44858 -0.10750 -0.00080 0.09165 0.58183 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 5.5305274 0.0729321 75.831 &lt; 2e-16 *** ## age 0.0033135 0.0010145 3.266 0.00127 ** ## sex 0.0980829 0.0240060 4.086 6.23e-05 *** ## tr -0.0063758 0.0008258 -7.721 4.51e-13 *** ## wt 0.0003336 0.0006829 0.488 0.62570 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.1569 on 212 degrees of freedom ## (45 observations deleted due to missingness) ## Multiple R-squared: 0.2893, Adjusted R-squared: 0.2759 ## F-statistic: 21.58 on 4 and 212 DF, p-value: 5.978e-15 This creates a new variable called lt that is the log of race time. You can use the skim function to see that it is normally distributed. Now lets look at the results of the regression analysis: the p-values are almost exactly the same. This suggests that the non-normality of race time is not important in this setting. For advanced students only It might be interesting to compare the coefficients from the untransformed and log transformed models. For example, women are predicted to run about 23 minutes slower on the untransformed model; the coefficient in the log model is 0.098. Backtransform by typing exp(0.098) and you get 1.10. Remember that backtransforming gives you a proportion. So to work out the difference between men and women in race time, first work out the average mens time: # Get the average time for men lesson5a %&gt;% filter(sex == 0) %&gt;% # Select only males skim(rt) Table 9.4: Data summary Name Piped data Number of rows 190 Number of columns 6 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist rt 1 0.99 238.57 46.63 155 205 235 268 414  Then multiply the mens average (238.6) by 1.10 to get the womens time, which gives 263.2. Subtract one from the other to get 24.6 minutes difference in race time between the sexes. This is very close to the value from the untransformed model. 9.5.2 lesson5b.rds These are data on patients with a disease that predisposes them to cancer. The disease causes precancerous lesions that can be surgically removed. A group of recently removed lesions are analyzed for a specific mutation. Does how long a patient has had the disease affect the chance that a new lesion will have a mutation? What you are trying to predict here is binary (mutation / no mutation). You are predicting with a continuous variable (length of disease). So a logistic regression would work nicely. Try: # Create logistic regression model mutate_model &lt;- glm(mutation ~ c, data = lesson5b, family = &quot;binomial&quot;) # Formatted results with odds ratios tbl_regression(mutate_model, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #rbpbdnnbet .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #rbpbdnnbet .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rbpbdnnbet .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #rbpbdnnbet .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #rbpbdnnbet .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rbpbdnnbet .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rbpbdnnbet .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #rbpbdnnbet .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #rbpbdnnbet .gt_column_spanner_outer:first-child { padding-left: 0; } #rbpbdnnbet .gt_column_spanner_outer:last-child { padding-right: 0; } #rbpbdnnbet .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #rbpbdnnbet .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #rbpbdnnbet .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #rbpbdnnbet .gt_from_md > :first-child { margin-top: 0; } #rbpbdnnbet .gt_from_md > :last-child { margin-bottom: 0; } #rbpbdnnbet .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #rbpbdnnbet .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #rbpbdnnbet .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rbpbdnnbet .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #rbpbdnnbet .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rbpbdnnbet .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #rbpbdnnbet .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #rbpbdnnbet .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rbpbdnnbet .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rbpbdnnbet .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #rbpbdnnbet .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rbpbdnnbet .gt_sourcenote { font-size: 90%; padding: 4px; } #rbpbdnnbet .gt_left { text-align: left; } #rbpbdnnbet .gt_center { text-align: center; } #rbpbdnnbet .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #rbpbdnnbet .gt_font_normal { font-weight: normal; } #rbpbdnnbet .gt_font_bold { font-weight: bold; } #rbpbdnnbet .gt_font_italic { font-style: italic; } #rbpbdnnbet .gt_super { font-size: 65%; } #rbpbdnnbet .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value c 0.99 0.96, 1.02 0.7 1 OR = Odds Ratio, CI = Confidence Interval If you get a p-value of around 0.7, you havent been inspecting your data. One patient has apparently had the disease for 154 years. Either this is a freak of nature or the study assistant meant to type 14 or 15. You need to delete this observation from the dataset and try the model again: # Use &quot;filter&quot; to exclude patients with outlying disease duration lesson5b &lt;- lesson5b %&gt;% filter(c &lt;= 50) # Create logistic regression model mutate_model &lt;- glm(mutation ~ c, data = lesson5b, family = &quot;binomial&quot;) # Formatted results with odds ratios tbl_regression(mutate_model, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jrdysgpclz .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jrdysgpclz .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jrdysgpclz .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jrdysgpclz .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #jrdysgpclz .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jrdysgpclz .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jrdysgpclz .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jrdysgpclz .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jrdysgpclz .gt_column_spanner_outer:first-child { padding-left: 0; } #jrdysgpclz .gt_column_spanner_outer:last-child { padding-right: 0; } #jrdysgpclz .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #jrdysgpclz .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #jrdysgpclz .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #jrdysgpclz .gt_from_md > :first-child { margin-top: 0; } #jrdysgpclz .gt_from_md > :last-child { margin-bottom: 0; } #jrdysgpclz .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jrdysgpclz .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #jrdysgpclz .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jrdysgpclz .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #jrdysgpclz .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jrdysgpclz .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jrdysgpclz .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jrdysgpclz .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jrdysgpclz .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jrdysgpclz .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #jrdysgpclz .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jrdysgpclz .gt_sourcenote { font-size: 90%; padding: 4px; } #jrdysgpclz .gt_left { text-align: left; } #jrdysgpclz .gt_center { text-align: center; } #jrdysgpclz .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jrdysgpclz .gt_font_normal { font-weight: normal; } #jrdysgpclz .gt_font_bold { font-weight: bold; } #jrdysgpclz .gt_font_italic { font-style: italic; } #jrdysgpclz .gt_super { font-size: 65%; } #jrdysgpclz .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value c 1.14 1.03, 1.27 0.014 1 OR = Odds Ratio, CI = Confidence Interval # Formatted results in logits tbl_regression(mutate_model, exponentiate = FALSE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tusbkbxopk .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tusbkbxopk .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tusbkbxopk .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tusbkbxopk .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #tusbkbxopk .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tusbkbxopk .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tusbkbxopk .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tusbkbxopk .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tusbkbxopk .gt_column_spanner_outer:first-child { padding-left: 0; } #tusbkbxopk .gt_column_spanner_outer:last-child { padding-right: 0; } #tusbkbxopk .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #tusbkbxopk .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #tusbkbxopk .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #tusbkbxopk .gt_from_md > :first-child { margin-top: 0; } #tusbkbxopk .gt_from_md > :last-child { margin-bottom: 0; } #tusbkbxopk .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tusbkbxopk .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #tusbkbxopk .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tusbkbxopk .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #tusbkbxopk .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tusbkbxopk .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tusbkbxopk .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tusbkbxopk .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tusbkbxopk .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tusbkbxopk .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #tusbkbxopk .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tusbkbxopk .gt_sourcenote { font-size: 90%; padding: 4px; } #tusbkbxopk .gt_left { text-align: left; } #tusbkbxopk .gt_center { text-align: center; } #tusbkbxopk .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tusbkbxopk .gt_font_normal { font-weight: normal; } #tusbkbxopk .gt_font_bold { font-weight: bold; } #tusbkbxopk .gt_font_italic { font-style: italic; } #tusbkbxopk .gt_super { font-size: 65%; } #tusbkbxopk .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic log(OR)1 95% CI1 p-value c 0.13 0.03, 0.24 0.014 1 OR = Odds Ratio, CI = Confidence Interval After fixing the data, you will now find an association (p=0.014). Using the tbl_regression function, you get an odds ratio of 1.14, meaning that the odds of having a mutation increase by 1.14 each year. You can get the constant or intercept term from the tbl_regression function by using the intercept = TRUE option, and the coefficients in logits using the exponentiate = FALSE option. # Results in logits # The &quot;intercept = TRUE&quot; option includes the constant in the table tbl_regression(mutate_model, exponentiate = FALSE, intercept = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mbchtzpmbb .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mbchtzpmbb .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mbchtzpmbb .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mbchtzpmbb .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mbchtzpmbb .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mbchtzpmbb .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mbchtzpmbb .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mbchtzpmbb .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mbchtzpmbb .gt_column_spanner_outer:first-child { padding-left: 0; } #mbchtzpmbb .gt_column_spanner_outer:last-child { padding-right: 0; } #mbchtzpmbb .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mbchtzpmbb .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mbchtzpmbb .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mbchtzpmbb .gt_from_md > :first-child { margin-top: 0; } #mbchtzpmbb .gt_from_md > :last-child { margin-bottom: 0; } #mbchtzpmbb .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mbchtzpmbb .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mbchtzpmbb .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mbchtzpmbb .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mbchtzpmbb .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mbchtzpmbb .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mbchtzpmbb .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mbchtzpmbb .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mbchtzpmbb .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mbchtzpmbb .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mbchtzpmbb .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mbchtzpmbb .gt_sourcenote { font-size: 90%; padding: 4px; } #mbchtzpmbb .gt_left { text-align: left; } #mbchtzpmbb .gt_center { text-align: center; } #mbchtzpmbb .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mbchtzpmbb .gt_font_normal { font-weight: normal; } #mbchtzpmbb .gt_font_bold { font-weight: bold; } #mbchtzpmbb .gt_font_italic { font-style: italic; } #mbchtzpmbb .gt_super { font-size: 65%; } #mbchtzpmbb .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic log(OR)1 95% CI1 p-value (Intercept) -0.94 -2.0, 0.08 0.076 c 0.13 0.03, 0.24 0.014 1 OR = Odds Ratio, CI = Confidence Interval This gives a coefficient of 0.13 and a constant of -0.94. This can be used to make a specific prediction using the equation below (l stands for the log odds). \\(p = e^l / (e^l+1)\\) Take someone who has had the disease for 10 years. Their logit is 10 times the coefficient of 0.13 minus the constant -0.94 to give 0.37. Plug 0.37 into the equation (exp(0.37)/(exp(0.37)+1)) and you get 59%. Someone who has had the disease for 3 years has a logit of -0.55 giving a risk (exp(-0.55)/(exp(-0.55)+1)) of 37%. If you wanted to get flashy, you could work out the risk for each year between 2 and 18 and get a graph. But R can do this automatically for you: you can create a variable with the risk of mutation for each observation based on the duration of disease using the augment function. The column that contains the risk is called .fitted. Since this is a logistic regression model, we also need to specify type.predict = \"response\" to get the predicted probabilities. # Create predictions lesson5b_pred &lt;- augment(mutate_model, type.predict = &quot;response&quot;) # Show resulting dataset lesson5b_pred ## # A tibble: 124 x 8 ## mutation c .fitted .resid .std.resid .hat .sigma .cooksd ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 11 0.623 0.973 0.978 0.0101 1.16 0.00313 ## 2 0 6 0.462 -1.11 -1.12 0.0163 1.16 0.00723 ## 3 1 12 0.653 0.923 0.929 0.0126 1.16 0.00344 ## 4 1 9 0.559 1.08 1.08 0.00862 1.16 0.00345 ## 5 0 13 0.682 -1.51 -1.53 0.0161 1.15 0.0178 ## 6 1 9 0.559 1.08 1.08 0.00862 1.16 0.00345 ## 7 0 8 0.527 -1.22 -1.23 0.00984 1.15 0.00559 ## 8 1 6 0.462 1.24 1.25 0.0163 1.15 0.00984 ## 9 0 11 0.623 -1.40 -1.40 0.0101 1.15 0.00852 ## 10 0 4 0.397 -1.01 -1.02 0.0275 1.16 0.00958 ## # ... with 114 more rows # Graph over disease duration # Tells the plot what data to use, and what variables correspond # to the x and y axes ggplot(data = lesson5b_pred, aes(x = c, y = .fitted)) + # Creates the line portion of the graph geom_line() + # Creates the points along the line geom_point() + # Labels the x and y axes labs( x = &quot;Disease duration&quot;, y = &quot;Risk of mutation&quot; ) You can also use the augment function for linear regression and multivariable models. One other interesting thing you can do is to make out of sample predictions. Try this: # Reopen lesson5b dataset lesson5b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 5&quot;, &quot;lesson5b.rds&quot;)) # Use original logistic regression model tbl_regression(mutate_model, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #yzwkzlhjln .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #yzwkzlhjln .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #yzwkzlhjln .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #yzwkzlhjln .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #yzwkzlhjln .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #yzwkzlhjln .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #yzwkzlhjln .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #yzwkzlhjln .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #yzwkzlhjln .gt_column_spanner_outer:first-child { padding-left: 0; } #yzwkzlhjln .gt_column_spanner_outer:last-child { padding-right: 0; } #yzwkzlhjln .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #yzwkzlhjln .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #yzwkzlhjln .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #yzwkzlhjln .gt_from_md > :first-child { margin-top: 0; } #yzwkzlhjln .gt_from_md > :last-child { margin-bottom: 0; } #yzwkzlhjln .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #yzwkzlhjln .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #yzwkzlhjln .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #yzwkzlhjln .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #yzwkzlhjln .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #yzwkzlhjln .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #yzwkzlhjln .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #yzwkzlhjln .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #yzwkzlhjln .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #yzwkzlhjln .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #yzwkzlhjln .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #yzwkzlhjln .gt_sourcenote { font-size: 90%; padding: 4px; } #yzwkzlhjln .gt_left { text-align: left; } #yzwkzlhjln .gt_center { text-align: center; } #yzwkzlhjln .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #yzwkzlhjln .gt_font_normal { font-weight: normal; } #yzwkzlhjln .gt_font_bold { font-weight: bold; } #yzwkzlhjln .gt_font_italic { font-style: italic; } #yzwkzlhjln .gt_super { font-size: 65%; } #yzwkzlhjln .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value c 1.14 1.03, 1.27 0.014 1 OR = Odds Ratio, CI = Confidence Interval # Create new values for &quot;c&quot; (disease duration) lesson5b_new &lt;- lesson5b %&gt;% mutate(c = 1:n()/3) # &quot;1:n()&quot; gives the observation number for each observation # Replace c with observation number / 3 gives a list of simulated # disease durations between 0.33 and 42.33. # Predict risk of mutation # The &quot;newdata&quot; option allows you to get predictions for a dataset # other than the dataset that was used to create the model lesson5b_pred_new &lt;- augment(mutate_model, newdata = lesson5b_new, type.predict = &quot;response&quot;) # Create graph ggplot(data = lesson5b_pred_new, aes(x = c, y = .fitted)) + geom_line() 9.5.3 lesson5c.rds These are data from Canadian provinces giving population, unemployment rates and male and female life expectancy. Which of these variables are associated? A key first question: what are we likely to be interested in? For example, total population and unemployment rate will have no illuminating relationship whatsoever and we wouldnt want to analyze the association between these two. The link between unemployment and life expectancy seems more interesting. Before we start doing the analysis however, we need to look at the data. # Open up dataset to view observations View(lesson5c) It seems that there are not only data for each province separately but for Canada as a whole. Clearly we would have to delete this row as it is not an independent observation. # Remove the observation for all of Canada from dataset lesson5c_fixed &lt;- lesson5c %&gt;% filter(place != &quot;Canada&quot;) Now, we could just correlate the three variables together: # Calculate correlation between unemployment and male/female life expectancy # There are missing values for unemployment, # so we need to indicate that we only want to use &quot;complete observations&quot; cor(lesson5c_fixed %&gt;% select(unemp, mlife, flife), use = &quot;complete.obs&quot;) ## unemp mlife flife ## unemp 1.0000000 -0.7413079 -0.6152419 ## mlife -0.7413079 1.0000000 0.7619491 ## flife -0.6152419 0.7619491 1.0000000 This tells you that unemployment rates are negatively correlated with life expectancy (i.e. the higher the unemployment rate, the lower the life expectancy), that this effect seems stronger for men than for women and that male and female life expectancy are strongly correlated. We might also want to go on and do some regressions. We probably wouldnt ever want to predict the unemployment rate on the basis of life expectancy, but the opposite case is indeed of interest: we might want to know, for example, what effect a 1% drop in unemployment rate might have on life expectancy. Try these regression models: # Create linear regression model for male life expectancy mlife_model &lt;- lm(mlife ~ unemp, data = lesson5c_fixed) tbl_regression(mlife_model) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #gnbvekovad .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #gnbvekovad .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gnbvekovad .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #gnbvekovad .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #gnbvekovad .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gnbvekovad .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gnbvekovad .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #gnbvekovad .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #gnbvekovad .gt_column_spanner_outer:first-child { padding-left: 0; } #gnbvekovad .gt_column_spanner_outer:last-child { padding-right: 0; } #gnbvekovad .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #gnbvekovad .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #gnbvekovad .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #gnbvekovad .gt_from_md > :first-child { margin-top: 0; } #gnbvekovad .gt_from_md > :last-child { margin-bottom: 0; } #gnbvekovad .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #gnbvekovad .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #gnbvekovad .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gnbvekovad .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #gnbvekovad .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #gnbvekovad .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #gnbvekovad .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #gnbvekovad .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gnbvekovad .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gnbvekovad .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #gnbvekovad .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gnbvekovad .gt_sourcenote { font-size: 90%; padding: 4px; } #gnbvekovad .gt_left { text-align: left; } #gnbvekovad .gt_center { text-align: center; } #gnbvekovad .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #gnbvekovad .gt_font_normal { font-weight: normal; } #gnbvekovad .gt_font_bold { font-weight: bold; } #gnbvekovad .gt_font_italic { font-style: italic; } #gnbvekovad .gt_super { font-size: 65%; } #gnbvekovad .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic Beta 95% CI1 p-value % 15+ population unemployed, 1995 -0.10 -0.18, -0.03 0.014 1 CI = Confidence Interval # Create linear regression model for female life expectancy flife_model &lt;- lm(flife ~ unemp, data = lesson5c_fixed) tbl_regression(flife_model) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kijudtsfwn .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kijudtsfwn .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kijudtsfwn .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kijudtsfwn .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kijudtsfwn .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kijudtsfwn .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kijudtsfwn .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kijudtsfwn .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kijudtsfwn .gt_column_spanner_outer:first-child { padding-left: 0; } #kijudtsfwn .gt_column_spanner_outer:last-child { padding-right: 0; } #kijudtsfwn .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kijudtsfwn .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kijudtsfwn .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kijudtsfwn .gt_from_md > :first-child { margin-top: 0; } #kijudtsfwn .gt_from_md > :last-child { margin-bottom: 0; } #kijudtsfwn .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kijudtsfwn .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kijudtsfwn .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kijudtsfwn .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kijudtsfwn .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kijudtsfwn .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kijudtsfwn .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kijudtsfwn .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kijudtsfwn .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kijudtsfwn .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kijudtsfwn .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kijudtsfwn .gt_sourcenote { font-size: 90%; padding: 4px; } #kijudtsfwn .gt_left { text-align: left; } #kijudtsfwn .gt_center { text-align: center; } #kijudtsfwn .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kijudtsfwn .gt_font_normal { font-weight: normal; } #kijudtsfwn .gt_font_bold { font-weight: bold; } #kijudtsfwn .gt_font_italic { font-style: italic; } #kijudtsfwn .gt_super { font-size: 65%; } #kijudtsfwn .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic Beta 95% CI1 p-value % 15+ population unemployed, 1995 -0.08 -0.17, 0.00 0.058 1 CI = Confidence Interval The coefficients you get (-0.10 for men and -0.08 for women) suggest that a 5% drop in unemployment is associated with about a 6 month increase in life expectancy, in other words, a small effect. Interesting question: should you also report a p-value and 95% confidence interval for the coefficients? The answer is no. This is because Canadian provinces are not some random sample from a large theoretical population of Canadian provinces. You have all the data. So questions of inference (i.e. p-values) and uncertainty (i.e. 95% confidence intervals) dont come into it. Even more interesting question: the conclusion of a 5% drop in unemployment being associated with a 6 month increase in life expectancy is based on a causal relationship, that is, we believe that changes in unemployment cause changes in life expectancy. This is not implausible: unemployment leads to poverty and depression, both of which reduce life expectancy. However, a causal relationship cannot be assumed. For example, it may be that life expectancy is lower in certain areas of the country (due to eating patterns or ethnic differences) that also happen to suffer higher unemployment. 9.5.4 lesson5d.rds These are data from mice inoculated with tumor cells and then treated with different doses of a drug. The growth rate of each animals tumor is then calculated. Is this drug effective? This is a straightforward linear regression that shows a significant decrease in log tumor size with increasing dose. # Create linear regression model for tumor size tumorsize_model &lt;- lm(s ~ dose, data = lesson5d) summary(tumorsize_model) ## ## Call: ## lm(formula = s ~ dose, data = lesson5d) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.026182 -0.010515 -0.005768 0.009948 0.050698 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 5.272e-02 5.376e-03 9.807 1.19e-07 *** ## dose -7.986e-05 2.674e-05 -2.986 0.00982 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.01793 on 14 degrees of freedom ## Multiple R-squared: 0.3891, Adjusted R-squared: 0.3454 ## F-statistic: 8.916 on 1 and 14 DF, p-value: 0.00982 A couple of thoughts. Firstly, this rather obvious analysis is not often conducted in lab research. Typically, researchers present pairwise comparisons between each dose and control. For example, see the following typical diagram. Each of the p-values compares the dose to control. The problem with such an approach is that you end up with multiple p-values (instead of just one) and that each test takes place in a vacuum: the p-value of a comparison between no treatment and, say, dose level 3, is the same regardless of whether there were 2 dose levels in the experiment, or 100, and whether all other dose levels showed an effect or did not. A regression analysis gives you a single p-value and uses all data in one analysis. A second thought: should you report the coefficient of -0.00008? This can be interpreted as for each increase in dose of one unit, increase in log tumor size is less by -0.00008. I would argue that this coefficient might be misleading because you only have a few doses and they are widely spaced. Also, dose-response is often non-linear: it generally takes a sigmoidal curve (see below). In short, you might have too few data to be confident about a linear prediction. Finally, it is rare that you really want to estimate the effects of a treatment on a mouse: generally, laboratory studies are about testing hypotheses. My model answer would be: Mean increase in log tumor size per day by dose is given in the table. Higher doses were associated with lower growth rates (p=0.010 by linear regression). html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #bvxaujwtra .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #bvxaujwtra .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bvxaujwtra .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #bvxaujwtra .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #bvxaujwtra .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bvxaujwtra .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bvxaujwtra .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #bvxaujwtra .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #bvxaujwtra .gt_column_spanner_outer:first-child { padding-left: 0; } #bvxaujwtra .gt_column_spanner_outer:last-child { padding-right: 0; } #bvxaujwtra .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #bvxaujwtra .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #bvxaujwtra .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #bvxaujwtra .gt_from_md > :first-child { margin-top: 0; } #bvxaujwtra .gt_from_md > :last-child { margin-bottom: 0; } #bvxaujwtra .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #bvxaujwtra .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #bvxaujwtra .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bvxaujwtra .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #bvxaujwtra .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bvxaujwtra .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #bvxaujwtra .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #bvxaujwtra .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bvxaujwtra .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bvxaujwtra .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #bvxaujwtra .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bvxaujwtra .gt_sourcenote { font-size: 90%; padding: 4px; } #bvxaujwtra .gt_left { text-align: left; } #bvxaujwtra .gt_center { text-align: center; } #bvxaujwtra .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #bvxaujwtra .gt_font_normal { font-weight: normal; } #bvxaujwtra .gt_font_bold { font-weight: bold; } #bvxaujwtra .gt_font_italic { font-style: italic; } #bvxaujwtra .gt_super { font-size: 65%; } #bvxaujwtra .gt_footnote_marks { font-style: italic; font-size: 65%; } Dose Mean (SD) 0 0.069 (0.025) 4 0.046 (0.016) 40 0.039 (0.001) 400 0.022 (0.009) 9.5.5 lesson5e.rds These are data from a study of the use of complementary medicine (e.g. massage) by UK breast cancer patients. There are data for the womens age, time since diagnosis, presence of distant metastases, use of complementary medicine before diagnosis, whether they received a qualification after high school, the age they left education, whether usual employment is a manual trade, socioeconomic status. What predicts use of complementary medicine by women with breast cancer? This is a fairly simple analysis: the outcome is binary and as we want to make predictions we are going to want a logistic regression. It would be tempting just to throw all the variables into the analysis: # Create multivariable logistic regression model for CAM cam_model1 &lt;- glm(CAM ~ age + t + mets + u + q18 + e + m + ses, data = lesson5e, family = &quot;binomial&quot;) tbl_regression(cam_model1, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #oedswpdpir .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #oedswpdpir .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #oedswpdpir .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #oedswpdpir .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #oedswpdpir .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #oedswpdpir .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #oedswpdpir .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #oedswpdpir .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #oedswpdpir .gt_column_spanner_outer:first-child { padding-left: 0; } #oedswpdpir .gt_column_spanner_outer:last-child { padding-right: 0; } #oedswpdpir .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #oedswpdpir .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #oedswpdpir .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #oedswpdpir .gt_from_md > :first-child { margin-top: 0; } #oedswpdpir .gt_from_md > :last-child { margin-bottom: 0; } #oedswpdpir .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #oedswpdpir .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #oedswpdpir .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #oedswpdpir .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #oedswpdpir .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #oedswpdpir .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #oedswpdpir .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #oedswpdpir .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #oedswpdpir .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #oedswpdpir .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #oedswpdpir .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #oedswpdpir .gt_sourcenote { font-size: 90%; padding: 4px; } #oedswpdpir .gt_left { text-align: left; } #oedswpdpir .gt_center { text-align: center; } #oedswpdpir .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #oedswpdpir .gt_font_normal { font-weight: normal; } #oedswpdpir .gt_font_bold { font-weight: bold; } #oedswpdpir .gt_font_italic { font-style: italic; } #oedswpdpir .gt_super { font-size: 65%; } #oedswpdpir .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 0.97 0.95, 0.99 0.004 time since diagnosis 1.02 0.91, 1.15 0.7 distant metastases? 1.45 0.12, 15.3 0.8 used CAM before diagnosis? 7.40 4.23, 13.5 qualifications after 18? 2.07 1.16, 3.73 0.015 age left education 0.93 0.83, 1.02 0.2 manual trade? 1.19 0.39, 3.61 0.8 socioeconomic status 1 - 5 0.81 0.54, 1.22 0.3 1 OR = Odds Ratio, CI = Confidence Interval This would suggest that the strongest predictor is whether women used complementary medicine before diagnosis and that two other variables are predictive: women with a qualification after leaving high school are more likely to use complementary medicine, but use declines with age (older people are more conservative, or alternatively, wiser, depending on your point of view.) However Should we just throw everything in the model? For example, only 6 patients have distant metastases. Secondly, many of the variables seem highly correlated. For example, age at which the patient left education and whether they received a qualification after the age of 18 are highly correlated as are socioeconomic status and whether the patients job is a manual trade. In clinical terms, you wouldnt need to know the age that someone left education if you already knew whether they had a post-high school qualification. And as would be intuitive, regression does not deal well with correlated variables. To take an extreme example, take two variables x which is equal to height, and y which is equal to height plus 1 inch. These have a correlation of one. Regressing just variable x or y on shoe size you get: \\(shoesize = 0.6*x - 30\\) or \\(shoesize = 0.6*y - 31\\) What would you get for regressing x and y? Any of the following are possible: \\(shoesize = 0.3*x + 0.3*y - 30.5\\) \\(shoesize = 0.4*x + 0.2*y - 30.5\\) \\(shoesize = 0.1*x + 0.5*y - 30.5\\) There is no way of telling these apart in terms of regression. Bottom line: care is needed with correlated variables both in a clinical / scientific sense (you dont need both of two correlated variables in a model) and a statistical sense (regression results can be misleading). So I would start with the full model and then remove the least predictive of socioeconomic status and manual trade, and the least predictive of qualification and age left education. You end up with: # Create logistic regression model for CAM removing &quot;e&quot; and &quot;m&quot; cam_model2 &lt;- glm(CAM ~ age + t + mets + u + q18 + ses, data = lesson5e, family = &quot;binomial&quot;) tbl_regression(cam_model2, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tnlmxmpshf .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tnlmxmpshf .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tnlmxmpshf .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tnlmxmpshf .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #tnlmxmpshf .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tnlmxmpshf .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tnlmxmpshf .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tnlmxmpshf .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tnlmxmpshf .gt_column_spanner_outer:first-child { padding-left: 0; } #tnlmxmpshf .gt_column_spanner_outer:last-child { padding-right: 0; } #tnlmxmpshf .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #tnlmxmpshf .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #tnlmxmpshf .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #tnlmxmpshf .gt_from_md > :first-child { margin-top: 0; } #tnlmxmpshf .gt_from_md > :last-child { margin-bottom: 0; } #tnlmxmpshf .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tnlmxmpshf .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #tnlmxmpshf .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tnlmxmpshf .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #tnlmxmpshf .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tnlmxmpshf .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tnlmxmpshf .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tnlmxmpshf .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tnlmxmpshf .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tnlmxmpshf .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #tnlmxmpshf .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tnlmxmpshf .gt_sourcenote { font-size: 90%; padding: 4px; } #tnlmxmpshf .gt_left { text-align: left; } #tnlmxmpshf .gt_center { text-align: center; } #tnlmxmpshf .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tnlmxmpshf .gt_font_normal { font-weight: normal; } #tnlmxmpshf .gt_font_bold { font-weight: bold; } #tnlmxmpshf .gt_font_italic { font-style: italic; } #tnlmxmpshf .gt_super { font-size: 65%; } #tnlmxmpshf .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 0.97 0.95, 0.99 0.004 time since diagnosis 1.02 0.91, 1.15 0.7 distant metastases? 1.36 0.11, 14.8 0.8 used CAM before diagnosis? 7.21 4.16, 12.9 qualifications after 18? 1.71 1.04, 2.80 0.033 socioeconomic status 1 - 5 0.88 0.73, 1.07 0.2 1 OR = Odds Ratio, CI = Confidence Interval Now it appears that q18 is predictive but not ses. So try removing one of these from the model in turn: # Create logistic regression model for CAM removing &quot;q18&quot; cam_model3 &lt;- glm(CAM ~ age + t + mets + u + ses, data = lesson5e, family = &quot;binomial&quot;) tbl_regression(cam_model3, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #sjkurdayvt .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #sjkurdayvt .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #sjkurdayvt .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #sjkurdayvt .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #sjkurdayvt .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #sjkurdayvt .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #sjkurdayvt .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #sjkurdayvt .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #sjkurdayvt .gt_column_spanner_outer:first-child { padding-left: 0; } #sjkurdayvt .gt_column_spanner_outer:last-child { padding-right: 0; } #sjkurdayvt .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #sjkurdayvt .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #sjkurdayvt .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #sjkurdayvt .gt_from_md > :first-child { margin-top: 0; } #sjkurdayvt .gt_from_md > :last-child { margin-bottom: 0; } #sjkurdayvt .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #sjkurdayvt .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #sjkurdayvt .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #sjkurdayvt .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #sjkurdayvt .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #sjkurdayvt .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #sjkurdayvt .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #sjkurdayvt .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #sjkurdayvt .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #sjkurdayvt .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #sjkurdayvt .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #sjkurdayvt .gt_sourcenote { font-size: 90%; padding: 4px; } #sjkurdayvt .gt_left { text-align: left; } #sjkurdayvt .gt_center { text-align: center; } #sjkurdayvt .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #sjkurdayvt .gt_font_normal { font-weight: normal; } #sjkurdayvt .gt_font_bold { font-weight: bold; } #sjkurdayvt .gt_font_italic { font-style: italic; } #sjkurdayvt .gt_super { font-size: 65%; } #sjkurdayvt .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 0.97 0.95, 0.99 0.002 time since diagnosis 1.04 0.93, 1.17 0.5 distant metastases? 1.23 0.10, 13.4 0.9 used CAM before diagnosis? 7.65 4.45, 13.6 socioeconomic status 1 - 5 0.78 0.66, 0.93 0.005 1 OR = Odds Ratio, CI = Confidence Interval # Create logistic regression model for CAM removing &quot;ses&quot; cam_model4 &lt;- glm(CAM ~ age + t + mets + u + q18, data = lesson5e, family = &quot;binomial&quot;) tbl_regression(cam_model4, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #ajfhjtutgr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ajfhjtutgr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ajfhjtutgr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ajfhjtutgr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #ajfhjtutgr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ajfhjtutgr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ajfhjtutgr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ajfhjtutgr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ajfhjtutgr .gt_column_spanner_outer:first-child { padding-left: 0; } #ajfhjtutgr .gt_column_spanner_outer:last-child { padding-right: 0; } #ajfhjtutgr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #ajfhjtutgr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #ajfhjtutgr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ajfhjtutgr .gt_from_md > :first-child { margin-top: 0; } #ajfhjtutgr .gt_from_md > :last-child { margin-bottom: 0; } #ajfhjtutgr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ajfhjtutgr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #ajfhjtutgr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ajfhjtutgr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #ajfhjtutgr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ajfhjtutgr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ajfhjtutgr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ajfhjtutgr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ajfhjtutgr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ajfhjtutgr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #ajfhjtutgr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ajfhjtutgr .gt_sourcenote { font-size: 90%; padding: 4px; } #ajfhjtutgr .gt_left { text-align: left; } #ajfhjtutgr .gt_center { text-align: center; } #ajfhjtutgr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ajfhjtutgr .gt_font_normal { font-weight: normal; } #ajfhjtutgr .gt_font_bold { font-weight: bold; } #ajfhjtutgr .gt_font_italic { font-style: italic; } #ajfhjtutgr .gt_super { font-size: 65%; } #ajfhjtutgr .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value age 0.96 0.94, 0.97 time since diagnosis 1.01 0.92, 1.12 0.8 distant metastases? 0.85 0.08, 6.83 0.9 used CAM before diagnosis? 7.32 4.48, 12.3 qualifications after 18? 1.90 1.28, 2.82 0.002 1 OR = Odds Ratio, CI = Confidence Interval It turns out that both are predictive independently, but not together. When you think about this, it is because socioeconomic status is correlated with education. The most sensible thing to do is to leave q18 in the model as a) it is slightly more predictive and b) it is easier to ask about; c) there are fewer missing data. As such, my model answer might be: There were responses from 714 women, of whom 651 had data adequate for analysis. There were more missing data for socioeconomic status but this was not included in the final model. In a multivariable model, use of complementary medicine before diagnosis was the strongest predictor of complementary medicine use in women with breast cancer, odds ratio 7.32 (95% CI 4.48, 12.3; p&lt;0.001). Complementary medicine use was related to education. The odds of a woman with a qualification received after the age of 18 using complementary medicine were 1.90 (95% CI 1.28, 2.82; p=0.002) those of women without a qualification after high school. In a univariate model, higher socioeconomic status predicted use of complementary medicine, but this was dropped from the multivariable model due to collinearity with educational achievement. Older women were less likely to use complementary medicine (odds ratio 0.96 for a one-year increase in age; 95% CI 0.94, 0.97, p&lt;0.001). There was no statistically significant effect of time since diagnosis (odds ratio 1.01 per year; 95% CI 0.92, 1.12, p=0.8). This suggests that breast cancer patients who use complementary medicine are likely to start doing so shortly after diagnosis. 9.5.6 lesson5f.rds These are the distance records for Frisbee for various ages in males. What is the relationship between age and how far a man can throw a Frisbee? Well the obvious thing to do would be a linear regression: # Create linear regression model for distance frisbee_model &lt;- lm(distance ~ age, data = lesson5f) summary(frisbee_model) ## ## Call: ## lm(formula = distance ~ age, data = lesson5f) ## ## Residuals: ## Min 1Q Median 3Q Max ## -90.772 -53.291 4.797 43.120 105.031 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 88.165 20.447 4.312 0.000717 *** ## age 1.623 0.673 2.412 0.030187 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 56.94 on 14 degrees of freedom ## Multiple R-squared: 0.2935, Adjusted R-squared: 0.243 ## F-statistic: 5.816 on 1 and 14 DF, p-value: 0.03019 You get a coefficient of 1.62, meaning that the furthest a man can throw a Frisbee increases by 1.62 meters every year. But of course this is nonsense: you cant throw further and further each year, athletic ability starts to decline with age. You can see this on a graph: # Scatterplot of distance by age ggplot(data = lesson5f, aes(x = age, y = distance)) + geom_point() In other words, there is not a linear relationship between your age and the distance you can throw a Frisbee. There are two options. You can either do two linear regressions, one for age up to 30 and one for age &gt;30. But this is a little sloppy: better, you could try including non-linear terms (see below). In either case, remember not to report p-values or 95% confidence intervals: these are meaningless because there is only one record per distance. For advanced students only: Often the relationship between an \\(x\\) and a \\(y\\) does not follow a straight line. You may remember from high school that one way to get a curve is to have a quadratic equation including both \\(x\\) and \\(x^2\\). So you have to create a new variable called age2 using mutate(age2 = age^2) and regress: # Create new variable for age squared lesson5f &lt;- lesson5f %&gt;% mutate( age2 = age^2 ) # Create linear regression model using age and age squared frisbee_model2 &lt;- lm(distance ~ age + age2, data = lesson5f) summary(frisbee_model2) ## ## Call: ## lm(formula = distance ~ age + age2, data = lesson5f) ## ## Residuals: ## Min 1Q Median 3Q Max ## -38.530 -18.159 1.256 19.124 37.573 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 8.13134 13.41881 0.606 0.555 ## age 11.60072 1.29513 8.957 6.36e-07 *** ## age2 -0.14906 0.01886 -7.905 2.55e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 24.52 on 13 degrees of freedom ## Multiple R-squared: 0.8783, Adjusted R-squared: 0.8596 ## F-statistic: 46.92 on 2 and 13 DF, p-value: 1.132e-06 This model (distance = 11.6*age - 0.149*age^2 + 8.13) fits extremely well (r2 of 0.88 vs 0.29 for the linear model). If you really remember your high school math, consider that for a regression equation \\(y = ax + bx^2 + c\\) you can work out the maximum \\(y\\) as \\(-a/2b\\). We predict that the world record for distance will be held by a man who is -11.6/(2 * -0.149) = 38.9 years old. Here is the predicted fit from the model using age and age2: ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; Note: while adding a quadratic term (here, the squared term) fit this data well, statisticians do not often use quadratic terms to model non-linear associations. There are a number of other methods for creating models for a non-linear association, but these will not be covered in this course. 9.5.7 lesson5g.rds Youve seen this dataset before. Patients with lung cancer are randomized to receive either chemotherapy regime a or b and assessed for tumor response. We know there is no difference between regimes (you can test this if you like). However, do the treatments work differently depending on age or sex? The first thing to do here is to do the sub-group analysis, just to get a feel for the data. Try this: # For men tbl_summary( lesson5g %&gt;% filter(sex == 0) %&gt;% select(response, chemo), by = chemo, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #snrxyyasnx .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #snrxyyasnx .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #snrxyyasnx .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #snrxyyasnx .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #snrxyyasnx .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #snrxyyasnx .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #snrxyyasnx .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #snrxyyasnx .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #snrxyyasnx .gt_column_spanner_outer:first-child { padding-left: 0; } #snrxyyasnx .gt_column_spanner_outer:last-child { padding-right: 0; } #snrxyyasnx .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #snrxyyasnx .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #snrxyyasnx .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #snrxyyasnx .gt_from_md > :first-child { margin-top: 0; } #snrxyyasnx .gt_from_md > :last-child { margin-bottom: 0; } #snrxyyasnx .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #snrxyyasnx .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #snrxyyasnx .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #snrxyyasnx .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #snrxyyasnx .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #snrxyyasnx .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #snrxyyasnx .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #snrxyyasnx .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #snrxyyasnx .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #snrxyyasnx .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #snrxyyasnx .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #snrxyyasnx .gt_sourcenote { font-size: 90%; padding: 4px; } #snrxyyasnx .gt_left { text-align: left; } #snrxyyasnx .gt_center { text-align: center; } #snrxyyasnx .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #snrxyyasnx .gt_font_normal { font-weight: normal; } #snrxyyasnx .gt_font_bold { font-weight: bold; } #snrxyyasnx .gt_font_italic { font-style: italic; } #snrxyyasnx .gt_super { font-size: 65%; } #snrxyyasnx .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 1381 1, N = 1561 1 = response to treatment, 0 = failure 0 84 (61%) 76 (49%) 1 54 (39%) 80 (51%) 1 n (%) # For women tbl_summary( lesson5g %&gt;% filter(sex == 1) %&gt;% select(response, chemo), by = chemo, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #ktgliozlwc .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ktgliozlwc .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ktgliozlwc .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ktgliozlwc .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #ktgliozlwc .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ktgliozlwc .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ktgliozlwc .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ktgliozlwc .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ktgliozlwc .gt_column_spanner_outer:first-child { padding-left: 0; } #ktgliozlwc .gt_column_spanner_outer:last-child { padding-right: 0; } #ktgliozlwc .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #ktgliozlwc .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #ktgliozlwc .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ktgliozlwc .gt_from_md > :first-child { margin-top: 0; } #ktgliozlwc .gt_from_md > :last-child { margin-bottom: 0; } #ktgliozlwc .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ktgliozlwc .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #ktgliozlwc .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ktgliozlwc .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #ktgliozlwc .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ktgliozlwc .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ktgliozlwc .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ktgliozlwc .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ktgliozlwc .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ktgliozlwc .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #ktgliozlwc .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ktgliozlwc .gt_sourcenote { font-size: 90%; padding: 4px; } #ktgliozlwc .gt_left { text-align: left; } #ktgliozlwc .gt_center { text-align: center; } #ktgliozlwc .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ktgliozlwc .gt_font_normal { font-weight: normal; } #ktgliozlwc .gt_font_bold { font-weight: bold; } #ktgliozlwc .gt_font_italic { font-style: italic; } #ktgliozlwc .gt_super { font-size: 65%; } #ktgliozlwc .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 621 1, N = 441 1 = response to treatment, 0 = failure 0 35 (56%) 27 (61%) 1 27 (44%) 17 (39%) 1 n (%) # Here, the &quot;summarize&quot; function stores out the p-values for the chi-squared test by sex lesson5g %&gt;% group_by(sex) %&gt;% summarize(p = chisq.test(response, chemo, correct = FALSE)$p.value) ## # A tibble: 2 x 2 ## sex p ## * &lt;dbl&gt; &lt;dbl&gt; ## 1 0 0.0368 ## 2 1 0.613 This shows that regime b is better for men (51% vs 39% response rate, p=0.037). For women, there doesnt seem to be a difference between groups. The next thing to check is whether sex in general makes a difference to response: # Create two-way table of response by sex tbl_summary( lesson5g %&gt;% select(response, sex), by = sex, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #zjxtfnqgfo .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #zjxtfnqgfo .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zjxtfnqgfo .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #zjxtfnqgfo .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #zjxtfnqgfo .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zjxtfnqgfo .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zjxtfnqgfo .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #zjxtfnqgfo .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #zjxtfnqgfo .gt_column_spanner_outer:first-child { padding-left: 0; } #zjxtfnqgfo .gt_column_spanner_outer:last-child { padding-right: 0; } #zjxtfnqgfo .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #zjxtfnqgfo .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #zjxtfnqgfo .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #zjxtfnqgfo .gt_from_md > :first-child { margin-top: 0; } #zjxtfnqgfo .gt_from_md > :last-child { margin-bottom: 0; } #zjxtfnqgfo .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #zjxtfnqgfo .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #zjxtfnqgfo .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zjxtfnqgfo .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #zjxtfnqgfo .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zjxtfnqgfo .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #zjxtfnqgfo .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #zjxtfnqgfo .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zjxtfnqgfo .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zjxtfnqgfo .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #zjxtfnqgfo .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zjxtfnqgfo .gt_sourcenote { font-size: 90%; padding: 4px; } #zjxtfnqgfo .gt_left { text-align: left; } #zjxtfnqgfo .gt_center { text-align: center; } #zjxtfnqgfo .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #zjxtfnqgfo .gt_font_normal { font-weight: normal; } #zjxtfnqgfo .gt_font_bold { font-weight: bold; } #zjxtfnqgfo .gt_font_italic { font-style: italic; } #zjxtfnqgfo .gt_super { font-size: 65%; } #zjxtfnqgfo .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 2941 1, N = 1061 1 = response to treatment, 0 = failure 0 160 (54%) 62 (58%) 1 134 (46%) 44 (42%) 1 n (%) # Test for a difference in response by sex using chi-squared test table(lesson5g$response, lesson5g$sex) %&gt;% chisq.test(correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: . ## X-squared = 0.52224, df = 1, p-value = 0.4699 This shows similar response rates (around 40-45%) for men and women. Now we want to test for interaction between chemo regime and sex in a multivariable regression. You can put the interaction directly into the multivariable model: # Create logistic regression model for response including interaction between sex and chemo sex_int_model &lt;- glm(response ~ sex + chemo + sex*chemo, data = lesson5g, family = &quot;binomial&quot;) tbl_regression(sex_int_model, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #zlejpcnofh .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #zlejpcnofh .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zlejpcnofh .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #zlejpcnofh .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #zlejpcnofh .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zlejpcnofh .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zlejpcnofh .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #zlejpcnofh .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #zlejpcnofh .gt_column_spanner_outer:first-child { padding-left: 0; } #zlejpcnofh .gt_column_spanner_outer:last-child { padding-right: 0; } #zlejpcnofh .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #zlejpcnofh .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #zlejpcnofh .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #zlejpcnofh .gt_from_md > :first-child { margin-top: 0; } #zlejpcnofh .gt_from_md > :last-child { margin-bottom: 0; } #zlejpcnofh .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #zlejpcnofh .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #zlejpcnofh .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zlejpcnofh .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #zlejpcnofh .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zlejpcnofh .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #zlejpcnofh .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #zlejpcnofh .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zlejpcnofh .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zlejpcnofh .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #zlejpcnofh .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zlejpcnofh .gt_sourcenote { font-size: 90%; padding: 4px; } #zlejpcnofh .gt_left { text-align: left; } #zlejpcnofh .gt_center { text-align: center; } #zlejpcnofh .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #zlejpcnofh .gt_font_normal { font-weight: normal; } #zlejpcnofh .gt_font_bold { font-weight: bold; } #zlejpcnofh .gt_font_italic { font-style: italic; } #zlejpcnofh .gt_super { font-size: 65%; } #zlejpcnofh .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value 1 if female 1.20 0.65, 2.20 0.6 0 for regime a, 1 for regime b 1.64 1.03, 2.61 0.037 1 if female * 0 for regime a, 1 for regime b 0.50 0.20, 1.24 0.14 1 OR = Odds Ratio, CI = Confidence Interval By the way, dont try glm(response ~ sex*chemo, ...), that is, including only the interaction term. This would involve a non-randomized comparison between men and women who received the same chemotherapy treatment. You can repeat this for age by creating a new variable based on the median age: # First, get the median age skim(lesson5g$age) Table 9.5: Data summary Name lesson5g$age Number of rows 400 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 2 1 42.46 10.58 17 34.25 42.5 49 71  # Then, create a category variable based on median age lesson5g &lt;- lesson5g %&gt;% mutate( hiage = if_else(age &gt; 42.5, 1, 0) ) Then do the subgroup analysis as above: # For younger patients tbl_summary( lesson5g %&gt;% filter(hiage == 0) %&gt;% select(response, chemo), by = chemo, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #daegbisqwz .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #daegbisqwz .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #daegbisqwz .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #daegbisqwz .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #daegbisqwz .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #daegbisqwz .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #daegbisqwz .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #daegbisqwz .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #daegbisqwz .gt_column_spanner_outer:first-child { padding-left: 0; } #daegbisqwz .gt_column_spanner_outer:last-child { padding-right: 0; } #daegbisqwz .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #daegbisqwz .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #daegbisqwz .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #daegbisqwz .gt_from_md > :first-child { margin-top: 0; } #daegbisqwz .gt_from_md > :last-child { margin-bottom: 0; } #daegbisqwz .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #daegbisqwz .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #daegbisqwz .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #daegbisqwz .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #daegbisqwz .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #daegbisqwz .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #daegbisqwz .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #daegbisqwz .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #daegbisqwz .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #daegbisqwz .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #daegbisqwz .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #daegbisqwz .gt_sourcenote { font-size: 90%; padding: 4px; } #daegbisqwz .gt_left { text-align: left; } #daegbisqwz .gt_center { text-align: center; } #daegbisqwz .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #daegbisqwz .gt_font_normal { font-weight: normal; } #daegbisqwz .gt_font_bold { font-weight: bold; } #daegbisqwz .gt_font_italic { font-style: italic; } #daegbisqwz .gt_super { font-size: 65%; } #daegbisqwz .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 961 1, N = 1031 1 = response to treatment, 0 = failure 0 52 (54%) 47 (46%) 1 44 (46%) 56 (54%) 1 n (%) # For older patients tbl_summary( lesson5g %&gt;% filter(hiage == 1) %&gt;% select(response, chemo), by = chemo, type = list(&quot;response&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tifwvoyvwi .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tifwvoyvwi .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tifwvoyvwi .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tifwvoyvwi .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #tifwvoyvwi .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tifwvoyvwi .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tifwvoyvwi .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tifwvoyvwi .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tifwvoyvwi .gt_column_spanner_outer:first-child { padding-left: 0; } #tifwvoyvwi .gt_column_spanner_outer:last-child { padding-right: 0; } #tifwvoyvwi .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #tifwvoyvwi .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #tifwvoyvwi .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #tifwvoyvwi .gt_from_md > :first-child { margin-top: 0; } #tifwvoyvwi .gt_from_md > :last-child { margin-bottom: 0; } #tifwvoyvwi .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tifwvoyvwi .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #tifwvoyvwi .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tifwvoyvwi .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #tifwvoyvwi .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tifwvoyvwi .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tifwvoyvwi .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tifwvoyvwi .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tifwvoyvwi .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tifwvoyvwi .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #tifwvoyvwi .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tifwvoyvwi .gt_sourcenote { font-size: 90%; padding: 4px; } #tifwvoyvwi .gt_left { text-align: left; } #tifwvoyvwi .gt_center { text-align: center; } #tifwvoyvwi .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tifwvoyvwi .gt_font_normal { font-weight: normal; } #tifwvoyvwi .gt_font_bold { font-weight: bold; } #tifwvoyvwi .gt_font_italic { font-style: italic; } #tifwvoyvwi .gt_super { font-size: 65%; } #tifwvoyvwi .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 1021 1, N = 971 1 = response to treatment, 0 = failure 0 66 (65%) 56 (58%) 1 36 (35%) 41 (42%) 1 n (%) # Calculate p-value for each comparison lesson5g %&gt;% filter(!is.na(age)) %&gt;% # Exclude 2 patients missing age group_by(hiage) %&gt;% summarize(p = chisq.test(response, chemo, correct = FALSE)$p.value) ## # A tibble: 2 x 2 ## hiage p ## * &lt;dbl&gt; &lt;dbl&gt; ## 1 0 0.229 ## 2 1 0.313 There do not appear to be any differences between groups. Now to do the interaction analysis, you can create an interaction term in one of two ways (chemo*age or chemo*hiage). # Logistic regression model with interaction between chemo and age (continuous) age_int_model1 &lt;- glm(response ~ chemo + age + chemo*age, data = lesson5g, family = &quot;binomial&quot;) tbl_regression(age_int_model1, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jkehecqzjk .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jkehecqzjk .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jkehecqzjk .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jkehecqzjk .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #jkehecqzjk .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jkehecqzjk .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jkehecqzjk .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jkehecqzjk .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jkehecqzjk .gt_column_spanner_outer:first-child { padding-left: 0; } #jkehecqzjk .gt_column_spanner_outer:last-child { padding-right: 0; } #jkehecqzjk .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #jkehecqzjk .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #jkehecqzjk .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #jkehecqzjk .gt_from_md > :first-child { margin-top: 0; } #jkehecqzjk .gt_from_md > :last-child { margin-bottom: 0; } #jkehecqzjk .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jkehecqzjk .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #jkehecqzjk .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jkehecqzjk .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #jkehecqzjk .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jkehecqzjk .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jkehecqzjk .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jkehecqzjk .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jkehecqzjk .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jkehecqzjk .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #jkehecqzjk .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jkehecqzjk .gt_sourcenote { font-size: 90%; padding: 4px; } #jkehecqzjk .gt_left { text-align: left; } #jkehecqzjk .gt_center { text-align: center; } #jkehecqzjk .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jkehecqzjk .gt_font_normal { font-weight: normal; } #jkehecqzjk .gt_font_bold { font-weight: bold; } #jkehecqzjk .gt_font_italic { font-style: italic; } #jkehecqzjk .gt_super { font-size: 65%; } #jkehecqzjk .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value 0 for regime a, 1 for regime b 2.24 0.42, 12.1 0.3 age 0.98 0.96, 1.01 0.3 0 for regime a, 1 for regime b * age 0.99 0.95, 1.03 0.6 1 OR = Odds Ratio, CI = Confidence Interval # Logistic regression model with interaction between chemo and hiage (binary) age_int_model2 &lt;- glm(response ~ chemo + hiage + chemo*hiage, data = lesson5g, family = &quot;binomial&quot;) tbl_regression(age_int_model2, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #ofvubetlvn .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ofvubetlvn .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ofvubetlvn .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ofvubetlvn .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #ofvubetlvn .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ofvubetlvn .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ofvubetlvn .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ofvubetlvn .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ofvubetlvn .gt_column_spanner_outer:first-child { padding-left: 0; } #ofvubetlvn .gt_column_spanner_outer:last-child { padding-right: 0; } #ofvubetlvn .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #ofvubetlvn .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #ofvubetlvn .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ofvubetlvn .gt_from_md > :first-child { margin-top: 0; } #ofvubetlvn .gt_from_md > :last-child { margin-bottom: 0; } #ofvubetlvn .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ofvubetlvn .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #ofvubetlvn .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ofvubetlvn .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #ofvubetlvn .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ofvubetlvn .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ofvubetlvn .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ofvubetlvn .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ofvubetlvn .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ofvubetlvn .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #ofvubetlvn .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ofvubetlvn .gt_sourcenote { font-size: 90%; padding: 4px; } #ofvubetlvn .gt_left { text-align: left; } #ofvubetlvn .gt_center { text-align: center; } #ofvubetlvn .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ofvubetlvn .gt_font_normal { font-weight: normal; } #ofvubetlvn .gt_font_bold { font-weight: bold; } #ofvubetlvn .gt_font_italic { font-style: italic; } #ofvubetlvn .gt_super { font-size: 65%; } #ofvubetlvn .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value 0 for regime a, 1 for regime b 1.41 0.81, 2.47 0.2 hiage 0.64 0.36, 1.14 0.13 0 for regime a, 1 for regime b * hiage 0.95 0.43, 2.12 >0.9 1 OR = Odds Ratio, CI = Confidence Interval Whichever one you choose, the interaction is non-significant in a logistic regression with age and chemotherapy. Incidentally, you must put age in the model because, not surprisingly, it is statistically significant, with higher age being associated with a lower chance of response. Incidentally, I have often emphasized the importance of including an estimate and a 95% confidence interval in any set of results rather than just saying differences between groups were / were not significant. Interaction analyses are somewhat of an exception to this general rule. First, these tend to be secondary, exploratory analyses. Secondly, interaction is rather rare in medicine: treatments tend to work (or not work) regardless of a patients age, gender, race and so on. Thirdly, the coefficient for the interaction term can be quite difficult to interpret. So it is often appropriate just to say that you looked for an interaction and didnt find one. A model answer might be: [Describe main comparison between chemo regimens here. Describe age and sex here.] In a subgroup analysis, there appeared to be a differential effect of the two regimens depending on sex. In men, response rates were higher for regimen B (51%) than regimen A (39%); response rates were more similar in women, though perhaps favoring regimen A (44% vs. 39%). Sex and sex by regimen interaction were entered into a logistic regression model of regimen and response, but the interaction term was non-significant (p=0.14). There were no apparent differences in response depending on age: response rates were 54% v. 46% in patients aged below the median compared to 42% v. 35% in patients aged above the median. The interaction between regimen and age as a continuous variable was non-significant (p=0.6). 9.5.8 lesson5h.rds PSA is used to screen for prostate cancer. In this dataset, the researchers are looking at various forms of PSA (e.g. nicked PSA). What variables should be used to try to predict prostate cancer? How accurate would this test be? One approach to selecting which variables to include in a predictive model would be to do a regression. You could start with all the variables. # Model with all variables glm(cancer ~ psa + psan + psai + psant, data = lesson5h, family = &quot;binomial&quot;) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mpvoaaoyfm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mpvoaaoyfm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mpvoaaoyfm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mpvoaaoyfm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mpvoaaoyfm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mpvoaaoyfm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mpvoaaoyfm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mpvoaaoyfm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mpvoaaoyfm .gt_column_spanner_outer:first-child { padding-left: 0; } #mpvoaaoyfm .gt_column_spanner_outer:last-child { padding-right: 0; } #mpvoaaoyfm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mpvoaaoyfm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mpvoaaoyfm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mpvoaaoyfm .gt_from_md > :first-child { margin-top: 0; } #mpvoaaoyfm .gt_from_md > :last-child { margin-bottom: 0; } #mpvoaaoyfm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mpvoaaoyfm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mpvoaaoyfm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mpvoaaoyfm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mpvoaaoyfm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mpvoaaoyfm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mpvoaaoyfm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mpvoaaoyfm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mpvoaaoyfm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mpvoaaoyfm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mpvoaaoyfm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mpvoaaoyfm .gt_sourcenote { font-size: 90%; padding: 4px; } #mpvoaaoyfm .gt_left { text-align: left; } #mpvoaaoyfm .gt_center { text-align: center; } #mpvoaaoyfm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mpvoaaoyfm .gt_font_normal { font-weight: normal; } #mpvoaaoyfm .gt_font_bold { font-weight: bold; } #mpvoaaoyfm .gt_font_italic { font-style: italic; } #mpvoaaoyfm .gt_super { font-size: 65%; } #mpvoaaoyfm .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value total PSA 1.25 1.12, 1.40 nicked PSA 0.35 0.12, 0.95 0.058 intact PSA 0.27 0.05, 0.91 0.058 ratio of nicked to total psa 0.01 0.00, 25.5 0.3 1 OR = Odds Ratio, CI = Confidence Interval You might notice that psant is not a good predictor (p=0.3) and decide to take it out of the model. # Model excluding &quot;psant&quot; glm(cancer ~ psa + psan + psai, data = lesson5h, family = &quot;binomial&quot;) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #phijstdxka .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #phijstdxka .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #phijstdxka .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #phijstdxka .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #phijstdxka .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #phijstdxka .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #phijstdxka .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #phijstdxka .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #phijstdxka .gt_column_spanner_outer:first-child { padding-left: 0; } #phijstdxka .gt_column_spanner_outer:last-child { padding-right: 0; } #phijstdxka .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #phijstdxka .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #phijstdxka .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #phijstdxka .gt_from_md > :first-child { margin-top: 0; } #phijstdxka .gt_from_md > :last-child { margin-bottom: 0; } #phijstdxka .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #phijstdxka .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #phijstdxka .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #phijstdxka .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #phijstdxka .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #phijstdxka .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #phijstdxka .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #phijstdxka .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #phijstdxka .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #phijstdxka .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #phijstdxka .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #phijstdxka .gt_sourcenote { font-size: 90%; padding: 4px; } #phijstdxka .gt_left { text-align: left; } #phijstdxka .gt_center { text-align: center; } #phijstdxka .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #phijstdxka .gt_font_normal { font-weight: normal; } #phijstdxka .gt_font_bold { font-weight: bold; } #phijstdxka .gt_font_italic { font-style: italic; } #phijstdxka .gt_super { font-size: 65%; } #phijstdxka .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value total PSA 1.30 1.20, 1.43 nicked PSA 0.22 0.10, 0.46 intact PSA 0.41 0.13, 1.10 0.081 1 OR = Odds Ratio, CI = Confidence Interval In a regression using the remaining three variables, psai is not statistically significant, and you might then want to remove that variable too. # Model excluding &quot;psant&quot; and &quot;psai&quot; glm(cancer ~ psa + psan, data = lesson5h, family = &quot;binomial&quot;) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #alcqlbdxer .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #alcqlbdxer .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #alcqlbdxer .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #alcqlbdxer .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #alcqlbdxer .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #alcqlbdxer .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #alcqlbdxer .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #alcqlbdxer .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #alcqlbdxer .gt_column_spanner_outer:first-child { padding-left: 0; } #alcqlbdxer .gt_column_spanner_outer:last-child { padding-right: 0; } #alcqlbdxer .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #alcqlbdxer .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #alcqlbdxer .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #alcqlbdxer .gt_from_md > :first-child { margin-top: 0; } #alcqlbdxer .gt_from_md > :last-child { margin-bottom: 0; } #alcqlbdxer .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #alcqlbdxer .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #alcqlbdxer .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #alcqlbdxer .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #alcqlbdxer .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #alcqlbdxer .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #alcqlbdxer .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #alcqlbdxer .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #alcqlbdxer .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #alcqlbdxer .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #alcqlbdxer .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #alcqlbdxer .gt_sourcenote { font-size: 90%; padding: 4px; } #alcqlbdxer .gt_left { text-align: left; } #alcqlbdxer .gt_center { text-align: center; } #alcqlbdxer .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #alcqlbdxer .gt_font_normal { font-weight: normal; } #alcqlbdxer .gt_font_bold { font-weight: bold; } #alcqlbdxer .gt_font_italic { font-style: italic; } #alcqlbdxer .gt_super { font-size: 65%; } #alcqlbdxer .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value total PSA 1.28 1.18, 1.40 nicked PSA 0.30 0.15, 0.54 1 OR = Odds Ratio, CI = Confidence Interval Both psa and psan are highly predictive, so you could leave them in the model and use the roc function to get the area-under-the-curve. # Save out final model final_model &lt;- glm(cancer ~ psa + psan, data = lesson5h, family = &quot;binomial&quot;) # Get predicted probabilities from final model final_model_pred &lt;- augment(final_model, type.predict = &quot;response&quot;) # Get AUC roc(cancer ~ .fitted, data = final_model_pred) ## ## Call: ## roc.formula(formula = cancer ~ .fitted, data = final_model_pred) ## ## Data: .fitted in 117 controls (cancer 0) &lt; 236 cases (cancer 1). ## Area under the curve: 0.729 However, I would have my doubts about such an approach. What you are trying to do here is predict the presence of cancer as well as you can: the significance or otherwise of individual variables doesnt really come into it. How I would go about my analysis would be in terms of the area-under-the-curve of the models. # Full model model1 &lt;- glm(cancer ~ psa + psan + psai + psant, data = lesson5h, family = &quot;binomial&quot;) model1_pred &lt;- augment(model1, type.predict = &quot;response&quot;) roc(cancer ~ .fitted, data = model1_pred) ## ## Call: ## roc.formula(formula = cancer ~ .fitted, data = model1_pred) ## ## Data: .fitted in 117 controls (cancer 0) &lt; 236 cases (cancer 1). ## Area under the curve: 0.7365 # Model without &quot;psant&quot; model2 &lt;- glm(cancer ~ psa + psan + psai, data = lesson5h, family = &quot;binomial&quot;) model2_pred &lt;- augment(model2, type.predict = &quot;response&quot;) roc(cancer ~ .fitted, data = model2_pred) ## ## Call: ## roc.formula(formula = cancer ~ .fitted, data = model2_pred) ## ## Data: .fitted in 117 controls (cancer 0) &lt; 236 cases (cancer 1). ## Area under the curve: 0.7378 # Model without &quot;psant&quot; or &quot;psai&quot; model3 &lt;- glm(cancer ~ psa + psan, data = lesson5h, family = &quot;binomial&quot;) model3_pred &lt;- augment(model3, type.predict = &quot;response&quot;) roc(cancer ~ .fitted, data = model3_pred) ## ## Call: ## roc.formula(formula = cancer ~ .fitted, data = model3_pred) ## ## Data: .fitted in 117 controls (cancer 0) &lt; 236 cases (cancer 1). ## Area under the curve: 0.729 So a model answer might be: The cohort consisted of 353 patients. Values for PSA and PSA subtypes are shown in the table. Entering all four PSA variables into a logistic model to predict the presence of prostate cancer gave an area-under-the-curve (AUC) of 0.736. Nicked-to-total ratio was not a strong predictor and removing it from the model did not decrease AUC (0.738). Removing intact PSA from the model had a small but noticeable impact on AUC (0.729). We therefore recommend that further research use total, nicked and intact PSA to predict prostate cancer. Table 1. Marker distributions html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #wimnizqbsk .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #wimnizqbsk .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #wimnizqbsk .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #wimnizqbsk .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #wimnizqbsk .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #wimnizqbsk .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #wimnizqbsk .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #wimnizqbsk .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #wimnizqbsk .gt_column_spanner_outer:first-child { padding-left: 0; } #wimnizqbsk .gt_column_spanner_outer:last-child { padding-right: 0; } #wimnizqbsk .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #wimnizqbsk .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #wimnizqbsk .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #wimnizqbsk .gt_from_md > :first-child { margin-top: 0; } #wimnizqbsk .gt_from_md > :last-child { margin-bottom: 0; } #wimnizqbsk .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #wimnizqbsk .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #wimnizqbsk .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #wimnizqbsk .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #wimnizqbsk .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #wimnizqbsk .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #wimnizqbsk .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #wimnizqbsk .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #wimnizqbsk .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #wimnizqbsk .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #wimnizqbsk .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #wimnizqbsk .gt_sourcenote { font-size: 90%; padding: 4px; } #wimnizqbsk .gt_left { text-align: left; } #wimnizqbsk .gt_center { text-align: center; } #wimnizqbsk .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #wimnizqbsk .gt_font_normal { font-weight: normal; } #wimnizqbsk .gt_font_bold { font-weight: bold; } #wimnizqbsk .gt_font_italic { font-style: italic; } #wimnizqbsk .gt_super { font-size: 65%; } #wimnizqbsk .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 3531 Total PSA (ng/mL) 6.8 (4.3, 10.2) Nicked PSA (ng/mL) 0.47 (0.28, 0.71) Intact PSA (ng/mL) 0.48 (0.38, 0.57) Nicked-to-total ratio 0.07 (0.05, 0.11) 1 Median (IQR) Table 2. Multivariable prediction model html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qqptoewtbw .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qqptoewtbw .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qqptoewtbw .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qqptoewtbw .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qqptoewtbw .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qqptoewtbw .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qqptoewtbw .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qqptoewtbw .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qqptoewtbw .gt_column_spanner_outer:first-child { padding-left: 0; } #qqptoewtbw .gt_column_spanner_outer:last-child { padding-right: 0; } #qqptoewtbw .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qqptoewtbw .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qqptoewtbw .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qqptoewtbw .gt_from_md > :first-child { margin-top: 0; } #qqptoewtbw .gt_from_md > :last-child { margin-bottom: 0; } #qqptoewtbw .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qqptoewtbw .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qqptoewtbw .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qqptoewtbw .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qqptoewtbw .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qqptoewtbw .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qqptoewtbw .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qqptoewtbw .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qqptoewtbw .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qqptoewtbw .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qqptoewtbw .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qqptoewtbw .gt_sourcenote { font-size: 90%; padding: 4px; } #qqptoewtbw .gt_left { text-align: left; } #qqptoewtbw .gt_center { text-align: center; } #qqptoewtbw .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qqptoewtbw .gt_font_normal { font-weight: normal; } #qqptoewtbw .gt_font_bold { font-weight: bold; } #qqptoewtbw .gt_font_italic { font-style: italic; } #qqptoewtbw .gt_super { font-size: 65%; } #qqptoewtbw .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value Total PSA 1.30 1.20, 1.43 Nicked PSA 0.22 0.10, 0.46 Intact PSA 0.41 0.13, 1.10 0.081 1 OR = Odds Ratio, CI = Confidence Interval 9.5.9 lesson5i.rds This is a randomized trial of behavioral therapy in cancer patients with depressed mood. Patients are randomized to no treatment (group 1), informal contact with a volunteer (group 2) or behavior therapy with a trained therapist (group 3). What would you conclude about the effectiveness of these treatments? One approach to these data is to use a test called ANOVA. This addresses the question of whether there is some overall difference between the three groups, or, more specifically, tests the null hypothesis that the three groups are equivalent. But this isnt a very interesting hypothesis. The other thing to do would be to conduct t-tests on all possible pairs (i.e. no treatment vs. therapy; therapy vs. volunteer; volunteer vs. no treatment). But I am not sure that this is particularly interesting either. What I would use is a regression analysis. # Create variables for treatment (yes/no) and therapy (yes/no) lesson5i &lt;- lesson5i %&gt;% mutate( treat = if_else(group &gt; 1, 1, 0), therapy = if_else(group == 3, 1, 0), ) # Create linear regression model for followup treat_model &lt;- lm(followup ~ baseline + treat + therapy, data = lesson5i) tbl_regression(treat_model) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #xvkjrdadrg .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #xvkjrdadrg .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #xvkjrdadrg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #xvkjrdadrg .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #xvkjrdadrg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #xvkjrdadrg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #xvkjrdadrg .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #xvkjrdadrg .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #xvkjrdadrg .gt_column_spanner_outer:first-child { padding-left: 0; } #xvkjrdadrg .gt_column_spanner_outer:last-child { padding-right: 0; } #xvkjrdadrg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #xvkjrdadrg .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #xvkjrdadrg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #xvkjrdadrg .gt_from_md > :first-child { margin-top: 0; } #xvkjrdadrg .gt_from_md > :last-child { margin-bottom: 0; } #xvkjrdadrg .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #xvkjrdadrg .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #xvkjrdadrg .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #xvkjrdadrg .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #xvkjrdadrg .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #xvkjrdadrg .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #xvkjrdadrg .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #xvkjrdadrg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #xvkjrdadrg .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #xvkjrdadrg .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #xvkjrdadrg .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #xvkjrdadrg .gt_sourcenote { font-size: 90%; padding: 4px; } #xvkjrdadrg .gt_left { text-align: left; } #xvkjrdadrg .gt_center { text-align: center; } #xvkjrdadrg .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #xvkjrdadrg .gt_font_normal { font-weight: normal; } #xvkjrdadrg .gt_font_bold { font-weight: bold; } #xvkjrdadrg .gt_font_italic { font-style: italic; } #xvkjrdadrg .gt_super { font-size: 65%; } #xvkjrdadrg .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic Beta 95% CI1 p-value baseline mood score 0.58 0.52, 0.63 treat 0.83 0.54, 1.1 therapy 1.0 0.73, 1.3 1 CI = Confidence Interval What this does is to create two dummy variables treat and therapy. treat means that you had some kind of treatment, whether that was contact with the therapist or just with a volunteer. therapy means you saw the trained therapist. So the groups are coded: html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #oguvercsxm .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #oguvercsxm .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #oguvercsxm .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #oguvercsxm .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #oguvercsxm .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #oguvercsxm .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #oguvercsxm .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #oguvercsxm .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #oguvercsxm .gt_column_spanner_outer:first-child { padding-left: 0; } #oguvercsxm .gt_column_spanner_outer:last-child { padding-right: 0; } #oguvercsxm .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #oguvercsxm .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #oguvercsxm .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #oguvercsxm .gt_from_md > :first-child { margin-top: 0; } #oguvercsxm .gt_from_md > :last-child { margin-bottom: 0; } #oguvercsxm .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #oguvercsxm .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #oguvercsxm .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #oguvercsxm .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #oguvercsxm .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #oguvercsxm .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #oguvercsxm .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #oguvercsxm .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #oguvercsxm .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #oguvercsxm .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #oguvercsxm .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #oguvercsxm .gt_sourcenote { font-size: 90%; padding: 4px; } #oguvercsxm .gt_left { text-align: left; } #oguvercsxm .gt_center { text-align: center; } #oguvercsxm .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #oguvercsxm .gt_font_normal { font-weight: normal; } #oguvercsxm .gt_font_bold { font-weight: bold; } #oguvercsxm .gt_font_italic { font-style: italic; } #oguvercsxm .gt_super { font-size: 65%; } #oguvercsxm .gt_footnote_marks { font-style: italic; font-size: 65%; } Group treat therapy No treatment 0 0 Volunteer 1 0 Trained therapy 1 1 Now when you regress the change score using the variables treat and therapy you get an estimate of the effect of just spending time with someone and the effect of seeing a trained professional. In my view, this fits in well with the original study design. A model answer might be: Mood scores improved in the therapist group (2.1 points, SD 0.88) and volunteer groups (1.0, SD 0.89) but not in the no treatment group (0.1 point worsening in score, SD 1.1). Interaction with a considerate individual appears to improve mood by 0.83 points (95% CI 0.54, 1.1, p&lt;0.001) with active behavior therapy further improving scores an additional 1.0 points (95% CI 0.73, 1.3, p&lt;0.001). 9.6 Week 6 # Week 6: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 6: load data lesson6a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6a.rds&quot;)) lesson6b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6b.rds&quot;)) lesson6c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6c.rds&quot;)) lesson6d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 6&quot;, &quot;lesson6d.rds&quot;)) 9.6.1 lesson6a.rds and lesson6b.rds These are data on a blood test (creatine kinase) to detect a recent myocardial infarct. The two datasets are from a coronary care unit population (06b) and a general hospital population (06c). What is the sensitivity, specificity, positive predictive value and negative predictive value? The thing to take away from this is that sensitivity and specificity dont change, but the positive and negative predictive value do. The prevalence of myocardial infarct is obviously much lower in the general hospital population compared to the coronary care population. So negative predictive value is higher in general patients (you are unlikely to have an MI anyway, so if the test says youre negative, it is almost definite) and positive predictive value higher in coronary care patients (you are at high risk of having an MI, so a positive test just about confirms it). 9.6.2 lesson6c.rds Here are the data from a study of a marker to predict the results of biopsy for cancer. There are 2000 patients, half of whom had a suspicious imaging result and were biopsied. It is known that only about half of patients with abnormal imaging actually have cancer and that is what is found in this study. The marker was measured in patients undergoing biopsy. Might the new marker help decide which patients with abnormal scans should receive biopsy? You might be tempted just to try: # Calculate AUC for marker predicting cancer using marker roc(cancer ~ marker, data = lesson6c) ## ## Call: ## roc.formula(formula = cancer ~ marker, data = lesson6c) ## ## Data: marker in 500 controls (cancer 0) &lt; 500 cases (cancer 1). ## Area under the curve: 0.7 Youd get an AUC of 0.700, which is pretty good. But the question isnt how good is the marker? but might the new marker help make a clinical decision about biopsy? So we need to look at clinical consequences. Lets try: # Here we will drop observations missing marker data from the table (filter function) tbl_summary( lesson6c %&gt;% filter(!is.na(marker)) %&gt;% select(cancer, marker), by = marker, type = list(&quot;cancer&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kluxeipkeg .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kluxeipkeg .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kluxeipkeg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kluxeipkeg .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kluxeipkeg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kluxeipkeg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kluxeipkeg .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kluxeipkeg .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kluxeipkeg .gt_column_spanner_outer:first-child { padding-left: 0; } #kluxeipkeg .gt_column_spanner_outer:last-child { padding-right: 0; } #kluxeipkeg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kluxeipkeg .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kluxeipkeg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kluxeipkeg .gt_from_md > :first-child { margin-top: 0; } #kluxeipkeg .gt_from_md > :last-child { margin-bottom: 0; } #kluxeipkeg .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kluxeipkeg .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kluxeipkeg .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kluxeipkeg .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kluxeipkeg .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kluxeipkeg .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kluxeipkeg .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kluxeipkeg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kluxeipkeg .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kluxeipkeg .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kluxeipkeg .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kluxeipkeg .gt_sourcenote { font-size: 90%; padding: 4px; } #kluxeipkeg .gt_left { text-align: left; } #kluxeipkeg .gt_center { text-align: center; } #kluxeipkeg .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kluxeipkeg .gt_font_normal { font-weight: normal; } #kluxeipkeg .gt_font_bold { font-weight: bold; } #kluxeipkeg .gt_font_italic { font-style: italic; } #kluxeipkeg .gt_super { font-size: 65%; } #kluxeipkeg .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 6001 1, N = 4001 cancer 0 400 (67%) 100 (25%) 1 200 (33%) 300 (75%) 1 n (%) So you can see that, if you only biopsied patients who were positive for the marker, you do 600 fewer biopsies per 1000, but youd also miss 200 cancers. That is a lot of cancers to miss and so you might feel that using the marker to make biopsy decisions would do more harm than good. 9.6.3 lesson6d.rds This is a dataset of cancer patients undergoing surgery with the endpoint of recurrence within 5 years. Since this cohort was established, adjuvant therapy has been shown to be of benefit. Current guidelines are that adjuvant therapy should be considered in patients with stage 3 or high grade disease. Recently, two new variables have been added to the dataset: levels of a novel tumor marker were obtained from banked tissue samples and preoperative imaging scans were retrieved and scored from 0 (no evidence of local extension) to 4 (definite evidence of local extension). Here are some questions about these data: How good is the current method for determining whether patients should be referred to adjuvant therapy? It has been suggested that a statistical model using stage and grade would be better than the current risk grouping. How good do you think this model would be? Does the marker add information to the model of stage and grade? Does imaging add information to the model including stage, grade and the marker? The first question concerns the value of the current method of determining referral for adjuvant therapy. There are two ways of thinking about this. The first is to show a simple table: # Two-way table of recurrence by hi_risk tbl_summary( lesson6d %&gt;% select(recurrence, hi_risk), by = hi_risk, type = list(&quot;recurrence&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qcfdyzmmty .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qcfdyzmmty .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qcfdyzmmty .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qcfdyzmmty .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qcfdyzmmty .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qcfdyzmmty .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qcfdyzmmty .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qcfdyzmmty .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qcfdyzmmty .gt_column_spanner_outer:first-child { padding-left: 0; } #qcfdyzmmty .gt_column_spanner_outer:last-child { padding-right: 0; } #qcfdyzmmty .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qcfdyzmmty .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qcfdyzmmty .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qcfdyzmmty .gt_from_md > :first-child { margin-top: 0; } #qcfdyzmmty .gt_from_md > :last-child { margin-bottom: 0; } #qcfdyzmmty .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qcfdyzmmty .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qcfdyzmmty .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qcfdyzmmty .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qcfdyzmmty .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qcfdyzmmty .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qcfdyzmmty .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qcfdyzmmty .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qcfdyzmmty .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qcfdyzmmty .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qcfdyzmmty .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qcfdyzmmty .gt_sourcenote { font-size: 90%; padding: 4px; } #qcfdyzmmty .gt_left { text-align: left; } #qcfdyzmmty .gt_center { text-align: center; } #qcfdyzmmty .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qcfdyzmmty .gt_font_normal { font-weight: normal; } #qcfdyzmmty .gt_font_bold { font-weight: bold; } #qcfdyzmmty .gt_font_italic { font-style: italic; } #qcfdyzmmty .gt_super { font-size: 65%; } #qcfdyzmmty .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 4,3751 1, N = 2,2001 recurrence 0 4,125 (94%) 1,609 (73%) 1 250 (5.7%) 591 (27%) 1 n (%) You can see that 27% of patients who met high risk criteria recurred compared to only 5.7% of those who were not high stage or high grade. Another way to think about how good the criterion is would be to look at discriminative accuracy. # Calculate AUC for prediction of recurrence using hi_risk roc(recurrence ~ hi_risk, data = lesson6d) ## ## Call: ## roc.formula(formula = recurrence ~ hi_risk, data = lesson6d) ## ## Data: hi_risk in 5734 controls (recurrence 0) &lt; 841 cases (recurrence 1). ## Area under the curve: 0.7111 The area-under-the-curve (AUC) is 0.71. Because high risk is a binary variable, this AUC is equivalent to sensitivity plus specificity  1 (you can check this if you like). So now lets look at the statistical model of stage and grade. Well first create this model and then use the model to give us the predicted probabilities for each patient. # Create the model # &quot;grade&quot; is a categorical variable, so use &quot;factor()&quot; recur_model &lt;- glm(recurrence ~ stage + factor(grade_numeric), data = lesson6d, family = &quot;binomial&quot;) # Get the predicted probability for each patient lesson6d_pred &lt;- augment( recur_model, newdata = lesson6d, type.predict = &quot;response&quot;, se = TRUE ) %&gt;% # Renaming to identify each prediction separately rename(clinpred = .fitted, clinpred_se = .se.fit) # Calculate the AUC for the clinical model roc(recurrence ~ clinpred, data = lesson6d_pred) ## ## Call: ## roc.formula(formula = recurrence ~ clinpred, data = lesson6d_pred) ## ## Data: clinpred in 5734 controls (recurrence 0) &lt; 841 cases (recurrence 1). ## Area under the curve: 0.7567 So the AUC is better for the model than for simple risk grouping. But would using a model make a clinical difference? The first thing to think about is the sort of risk that would make you consider the use of adjuvant therapy. Clearly a patient with a 1% risk of recurrence should not be referred for adjuvant; a risk of 90% would definitely be an indication for chemotherapy. Somewhere in between 1% and 90%, wed think that the risk becomes high enough to warrant adjuvant therapy. Lets imagine that we choose a risk threshold of 10%. We can now do this. # Create a new variable to define patients at high risk from the model lesson6d_pred &lt;- lesson6d_pred %&gt;% mutate( clinmodel_hirisk = if_else(clinpred &gt;= 0.1, 1, 0) ) # Compare who is defined as high risk from the model # with those defined as high risk using clinical criteria tbl_summary( lesson6d_pred %&gt;% select(clinmodel_hirisk, hi_risk), by = hi_risk, type = list(&quot;clinmodel_hirisk&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vjnfqcioza .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vjnfqcioza .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vjnfqcioza .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vjnfqcioza .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vjnfqcioza .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vjnfqcioza .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vjnfqcioza .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vjnfqcioza .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vjnfqcioza .gt_column_spanner_outer:first-child { padding-left: 0; } #vjnfqcioza .gt_column_spanner_outer:last-child { padding-right: 0; } #vjnfqcioza .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vjnfqcioza .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vjnfqcioza .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vjnfqcioza .gt_from_md > :first-child { margin-top: 0; } #vjnfqcioza .gt_from_md > :last-child { margin-bottom: 0; } #vjnfqcioza .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vjnfqcioza .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vjnfqcioza .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vjnfqcioza .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vjnfqcioza .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vjnfqcioza .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vjnfqcioza .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vjnfqcioza .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vjnfqcioza .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vjnfqcioza .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vjnfqcioza .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vjnfqcioza .gt_sourcenote { font-size: 90%; padding: 4px; } #vjnfqcioza .gt_left { text-align: left; } #vjnfqcioza .gt_center { text-align: center; } #vjnfqcioza .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vjnfqcioza .gt_font_normal { font-weight: normal; } #vjnfqcioza .gt_font_bold { font-weight: bold; } #vjnfqcioza .gt_font_italic { font-style: italic; } #vjnfqcioza .gt_super { font-size: 65%; } #vjnfqcioza .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 4,3751 1, N = 2,2001 clinmodel_hirisk 0 4,375 (100%) 0 (0%) 1 0 (0%) 2,200 (100%) 1 n (%) You can see that no patient is reclassified using the model. All 2200 patients defined as high risk by clinical criteria are also defined as high risk (risk 10%) by the model, similarly, all 4,375 patients defined as low risk by clinical criteria have risks &lt;10% from the model. How about adding in the marker? # Create the model marker_recur_model &lt;- glm(recurrence ~ stage + factor(grade_numeric) + marker, data = lesson6d, family = &quot;binomial&quot;) tbl_regression(marker_recur_model, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #fssxgtwmsf .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #fssxgtwmsf .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #fssxgtwmsf .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #fssxgtwmsf .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #fssxgtwmsf .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #fssxgtwmsf .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #fssxgtwmsf .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #fssxgtwmsf .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #fssxgtwmsf .gt_column_spanner_outer:first-child { padding-left: 0; } #fssxgtwmsf .gt_column_spanner_outer:last-child { padding-right: 0; } #fssxgtwmsf .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #fssxgtwmsf .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #fssxgtwmsf .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #fssxgtwmsf .gt_from_md > :first-child { margin-top: 0; } #fssxgtwmsf .gt_from_md > :last-child { margin-bottom: 0; } #fssxgtwmsf .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #fssxgtwmsf .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #fssxgtwmsf .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #fssxgtwmsf .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #fssxgtwmsf .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #fssxgtwmsf .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #fssxgtwmsf .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #fssxgtwmsf .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #fssxgtwmsf .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #fssxgtwmsf .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #fssxgtwmsf .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #fssxgtwmsf .gt_sourcenote { font-size: 90%; padding: 4px; } #fssxgtwmsf .gt_left { text-align: left; } #fssxgtwmsf .gt_center { text-align: center; } #fssxgtwmsf .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #fssxgtwmsf .gt_font_normal { font-weight: normal; } #fssxgtwmsf .gt_font_bold { font-weight: bold; } #fssxgtwmsf .gt_font_italic { font-style: italic; } #fssxgtwmsf .gt_super { font-size: 65%; } #fssxgtwmsf .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic OR1 95% CI1 p-value Stage II or III disease 3.26 2.75, 3.86 factor(grade_numeric) 0 &mdash; &mdash; 1 1.83 1.51, 2.22 2 6.77 5.26, 8.73 Marker level 1.09 1.07, 1.10 1 OR = Odds Ratio, CI = Confidence Interval # Get the predicted probability for each patient lesson6d_pred &lt;- augment( marker_recur_model, newdata = lesson6d_pred, type.predict = &quot;response&quot;, se = TRUE ) %&gt;% rename(markerpred = .fitted, markerpred_se = .se.fit) # Calculate the AUC from the marker for the marker model roc(recurrence ~ markerpred, data = lesson6d_pred) ## ## Call: ## roc.formula(formula = recurrence ~ markerpred, data = lesson6d_pred) ## ## Data: markerpred in 5734 controls (recurrence 0) &lt; 841 cases (recurrence 1). ## Area under the curve: 0.7982 A couple of things to note here. First, the marker is a statistically significant predictor in the model. Typical language is that the marker is an independent predictor or that it is significant after adjusting for stage and grade. Second, it increases AUC quite a bit, from 0.757 for the clinical variables alone to 0.798 for the clinical variables plus the marker. But lets again look at clinical consequences. # Identify patients at &gt;= 10% risk from clinical+marker model lesson6d_pred &lt;- lesson6d_pred %&gt;% mutate(markermodel_hirisk = if_else(markerpred &gt;= 0.1, 1, 0)) # Compare who is defined as high risk from the clinical+marker model # with those defined as high risk using clinical criteria tbl_summary( lesson6d_pred %&gt;% select(markermodel_hirisk, hi_risk), by = hi_risk, type = list(&quot;markermodel_hirisk&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #njcjwgigkv .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #njcjwgigkv .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #njcjwgigkv .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #njcjwgigkv .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #njcjwgigkv .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #njcjwgigkv .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #njcjwgigkv .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #njcjwgigkv .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #njcjwgigkv .gt_column_spanner_outer:first-child { padding-left: 0; } #njcjwgigkv .gt_column_spanner_outer:last-child { padding-right: 0; } #njcjwgigkv .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #njcjwgigkv .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #njcjwgigkv .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #njcjwgigkv .gt_from_md > :first-child { margin-top: 0; } #njcjwgigkv .gt_from_md > :last-child { margin-bottom: 0; } #njcjwgigkv .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #njcjwgigkv .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #njcjwgigkv .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #njcjwgigkv .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #njcjwgigkv .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #njcjwgigkv .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #njcjwgigkv .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #njcjwgigkv .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #njcjwgigkv .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #njcjwgigkv .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #njcjwgigkv .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #njcjwgigkv .gt_sourcenote { font-size: 90%; padding: 4px; } #njcjwgigkv .gt_left { text-align: left; } #njcjwgigkv .gt_center { text-align: center; } #njcjwgigkv .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #njcjwgigkv .gt_font_normal { font-weight: normal; } #njcjwgigkv .gt_font_bold { font-weight: bold; } #njcjwgigkv .gt_font_italic { font-style: italic; } #njcjwgigkv .gt_super { font-size: 65%; } #njcjwgigkv .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 4,3751 1, N = 2,2001 markermodel_hirisk 0 4,030 (92%) 133 (6.0%) 1 345 (7.9%) 2,067 (94%) 1 n (%) You can see now that 133 patients who would otherwise be referred to adjuvant chemotherapy would not using the model, and 345 of those defined at low risk by the clinical criteria are reclassified as high risk from the model (presumably because of a high level of the marker). You could also do this: # Table of recurrences for those at high risk from the marker model but not clinically tbl_summary( lesson6d_pred %&gt;% filter(markermodel_hirisk == 1 &amp; hi_risk == 0) %&gt;% select(recurrence), type = list(&quot;recurrence&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jzetravkvy .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jzetravkvy .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jzetravkvy .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jzetravkvy .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #jzetravkvy .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jzetravkvy .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jzetravkvy .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jzetravkvy .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jzetravkvy .gt_column_spanner_outer:first-child { padding-left: 0; } #jzetravkvy .gt_column_spanner_outer:last-child { padding-right: 0; } #jzetravkvy .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #jzetravkvy .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #jzetravkvy .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #jzetravkvy .gt_from_md > :first-child { margin-top: 0; } #jzetravkvy .gt_from_md > :last-child { margin-bottom: 0; } #jzetravkvy .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jzetravkvy .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #jzetravkvy .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jzetravkvy .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #jzetravkvy .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #jzetravkvy .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jzetravkvy .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jzetravkvy .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jzetravkvy .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jzetravkvy .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #jzetravkvy .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jzetravkvy .gt_sourcenote { font-size: 90%; padding: 4px; } #jzetravkvy .gt_left { text-align: left; } #jzetravkvy .gt_center { text-align: center; } #jzetravkvy .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jzetravkvy .gt_font_normal { font-weight: normal; } #jzetravkvy .gt_font_bold { font-weight: bold; } #jzetravkvy .gt_font_italic { font-style: italic; } #jzetravkvy .gt_super { font-size: 65%; } #jzetravkvy .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 3451 recurrence 0 286 (83%) 1 59 (17%) 1 n (%) # Table of recurrences for those at low risk from the marker model but high risk clinically tbl_summary( lesson6d_pred %&gt;% filter(markermodel_hirisk == 0 &amp; hi_risk == 1) %&gt;% select(recurrence), type = list(&quot;recurrence&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #myzlhqiesj .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #myzlhqiesj .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #myzlhqiesj .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #myzlhqiesj .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #myzlhqiesj .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #myzlhqiesj .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #myzlhqiesj .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #myzlhqiesj .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #myzlhqiesj .gt_column_spanner_outer:first-child { padding-left: 0; } #myzlhqiesj .gt_column_spanner_outer:last-child { padding-right: 0; } #myzlhqiesj .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #myzlhqiesj .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #myzlhqiesj .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #myzlhqiesj .gt_from_md > :first-child { margin-top: 0; } #myzlhqiesj .gt_from_md > :last-child { margin-bottom: 0; } #myzlhqiesj .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #myzlhqiesj .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #myzlhqiesj .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #myzlhqiesj .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #myzlhqiesj .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #myzlhqiesj .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #myzlhqiesj .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #myzlhqiesj .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #myzlhqiesj .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #myzlhqiesj .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #myzlhqiesj .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #myzlhqiesj .gt_sourcenote { font-size: 90%; padding: 4px; } #myzlhqiesj .gt_left { text-align: left; } #myzlhqiesj .gt_center { text-align: center; } #myzlhqiesj .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #myzlhqiesj .gt_font_normal { font-weight: normal; } #myzlhqiesj .gt_font_bold { font-weight: bold; } #myzlhqiesj .gt_font_italic { font-style: italic; } #myzlhqiesj .gt_super { font-size: 65%; } #myzlhqiesj .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 1331 recurrence 0 125 (94%) 1 8 (6.0%) 1 n (%) You can see that patients reclassified as low risk using the marker really are at low risk (only 6.0% of them recurred) whereas 17% of those defined as high risk from the model did indeed recur. As to whether youd use this in practice, the question is whether it is worth measuring the marker on ~6500 to reclassify ~500. That all depends on how difficult, invasive and expensive it is to measure the marker. As for imaging, if you try: # Create model that includes imaging score imaging_model &lt;- glm(recurrence ~ stage + factor(grade_numeric) + marker + imaging_score, data = lesson6d, family = &quot;binomial&quot;) # Get predictions for imaging model lesson6d_pred &lt;- augment( imaging_model, newdata = lesson6d_pred, type.predict = &quot;response&quot;, se = TRUE ) %&gt;% rename(imagingpred = .fitted, imagingpred_se = .se.fit) # Calculate AUC for imaging model roc(recurrence ~ imagingpred, data = lesson6d_pred) ## ## Call: ## roc.formula(formula = recurrence ~ imagingpred, data = lesson6d_pred) ## ## Data: imagingpred in 5734 controls (recurrence 0) &lt; 841 cases (recurrence 1). ## Area under the curve: 0.8004 Youll find that imaging is a statistically significant predictor of recurrence, even after adjusting for stage, grade and the marker, but it doesnt improve AUC by very much (from 0.798 to 0.800). You could go on to see that it also doesnt reclassify very well. # Create variable indicating whether patient is high risk from imaging model lesson6d_pred &lt;- lesson6d_pred %&gt;% mutate( imagingmodel_hirisk = if_else(imagingpred &gt;= 0.1, 1, 0) ) # Two-way table of high risk status, based on marker model and imaging model tbl_summary( lesson6d_pred %&gt;% select(imagingmodel_hirisk, markermodel_hirisk), by = markermodel_hirisk, type = list(&quot;imagingmodel_hirisk&quot; ~ &quot;categorical&quot;) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #mexgygslyy .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #mexgygslyy .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mexgygslyy .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #mexgygslyy .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #mexgygslyy .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mexgygslyy .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #mexgygslyy .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #mexgygslyy .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #mexgygslyy .gt_column_spanner_outer:first-child { padding-left: 0; } #mexgygslyy .gt_column_spanner_outer:last-child { padding-right: 0; } #mexgygslyy .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #mexgygslyy .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #mexgygslyy .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #mexgygslyy .gt_from_md > :first-child { margin-top: 0; } #mexgygslyy .gt_from_md > :last-child { margin-bottom: 0; } #mexgygslyy .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #mexgygslyy .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #mexgygslyy .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mexgygslyy .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #mexgygslyy .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #mexgygslyy .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #mexgygslyy .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #mexgygslyy .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #mexgygslyy .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mexgygslyy .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #mexgygslyy .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #mexgygslyy .gt_sourcenote { font-size: 90%; padding: 4px; } #mexgygslyy .gt_left { text-align: left; } #mexgygslyy .gt_center { text-align: center; } #mexgygslyy .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #mexgygslyy .gt_font_normal { font-weight: normal; } #mexgygslyy .gt_font_bold { font-weight: bold; } #mexgygslyy .gt_font_italic { font-style: italic; } #mexgygslyy .gt_super { font-size: 65%; } #mexgygslyy .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 0, N = 4,1631 1, N = 2,4121 imagingmodel_hirisk 0 4,073 (98%) 82 (3.4%) 1 90 (2.2%) 2,330 (97%) 1 n (%) Youll see that only 172 patients are reclassified. It is questionable whether wed want to do scans on ~6600 patients to reclassify 172 of them. And here are the answers to the questions without data! 9.6.4 lesson6e Hospitalized neutropenic patients were randomized to receive drug a or placebo. Bloods were taken every day. The time until patients were no longer neutropenic was measured (all patients eventually did get better). A possible answer might be: Mean time to recovery was ?? (SD ??) in the ?? patients randomized to drug a, compared to ?? (SD ??) in the ?? patients receiving placebo. The difference between means of ?? fewer / more days with neutropenia (95% C.I. ??, ??) was / was not statistically significant (p=??). If the data were very skewed, which wouldnt be uncommon for data of this sort, we might try the following, although obtaining a 95% confidence interval for the difference between medians is not straightforward. Median time to recovery was ?? (interquartile range ?? - ??) in the ?? patients randomized to drug a, compared to ?? (interquartile range ?? - ??) in the ?? patients receiving placebo. The difference between medians of ?? fewer / more days with neutropenia (95% C.I. ??, ??) was / was not statistically significant (p=??). 9.6.5 lesson6f A new lab machine sometimes fails to give a readout with the result that the sample is wasted. To try and get a handle on this problem, a researcher carefully documents the number of failures for the 516 samples that she analyzes in the month of September. This is a simple one: Of the 516 samples analyzed in September, ?? led to a failed readout (??%, 95% C.I. ??%, ??%). 9.6.6 lesson6g Drug a appears to be effective against cancer cells in vitro. Researchers create two new drugs, b and c, by making slight molecular rearrangements of drug a. The three drugs are then added to tumor cells in the test tube and the degree of cell growth measured. The key thing to think about here is the comparisons you want to make. Drug a already is known to work, so what you want to know is whether drug b or c might be more effective. So you want the comparison between drug a and b and between drug a and c, not between drug b and c. Hence you might have something like: Mean cell growth was ?? (SD??), ?? (SD??) and ?? (SD??) in cells treated by drugs a, b and c respectively. Drug b was more / less effective than drug a (difference between mean cell growth ??; 95% C.I. ??, ??). Drug c was more / less effective than drug a (difference between mean cell growth ??; 95% C.I. ??, ??). 9.7 Week 7 # Week 7: load packages library(skimr) library(gt) library(gtsummary) library(epiR) library(broom) library(pROC) library(gmodels) library(survival) library(here) library(tidyverse) # Week 7: load data lesson7a &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7a.rds&quot;)) lesson7b &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7b.rds&quot;)) lesson7c &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7c.rds&quot;)) lesson7d &lt;- readRDS(here::here(&quot;Data&quot;, &quot;Week 7&quot;, &quot;lesson7d.rds&quot;)) 9.7.1 lesson7a.rds This is a large set of data on patients receiving adjuvant therapy after surgery for colon cancer. Describe this dataset and determine which, if any, variables are prognostic in this patient group. The data list the number of days of follow-up (survival_time), whether the patient was dead or alive at last follow-up (died), sex, age and various characteristics of the colon tumor. We can use survfit and skim to get the median time for all patients and for survivors only. Remember to use the Surv function to specify your event status and time to event. # Median followup for all patients survfit(Surv(survival_time, died) ~ 1, data = lesson7a) ## Call: survfit(formula = Surv(survival_time, died) ~ 1, data = lesson7a) ## ## n events median 0.95LCL 0.95UCL ## 614 284 2910 2482 NA # Median followup for survivors lesson7a %&gt;% filter(died == 0) %&gt;% skim(survival_time) Table 9.6: Data summary Name Piped data Number of rows 330 Number of columns 9 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist survival_time 0 1 2389.38 336.23 1279 2162 2352 2625.5 3329  To look at predictors of survival, we might conduct a multivariable regression: # Multivariable Cox model for time to death coxph(Surv(survival_time, died) ~ sex + age + obstruction + perforation + adhesions + nodes, data = lesson7a) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #zrfktzocbr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #zrfktzocbr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zrfktzocbr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #zrfktzocbr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #zrfktzocbr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zrfktzocbr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #zrfktzocbr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #zrfktzocbr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #zrfktzocbr .gt_column_spanner_outer:first-child { padding-left: 0; } #zrfktzocbr .gt_column_spanner_outer:last-child { padding-right: 0; } #zrfktzocbr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #zrfktzocbr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #zrfktzocbr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #zrfktzocbr .gt_from_md > :first-child { margin-top: 0; } #zrfktzocbr .gt_from_md > :last-child { margin-bottom: 0; } #zrfktzocbr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #zrfktzocbr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #zrfktzocbr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zrfktzocbr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #zrfktzocbr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #zrfktzocbr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #zrfktzocbr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #zrfktzocbr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #zrfktzocbr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zrfktzocbr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #zrfktzocbr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #zrfktzocbr .gt_sourcenote { font-size: 90%; padding: 4px; } #zrfktzocbr .gt_left { text-align: left; } #zrfktzocbr .gt_center { text-align: center; } #zrfktzocbr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #zrfktzocbr .gt_font_normal { font-weight: normal; } #zrfktzocbr .gt_font_bold { font-weight: bold; } #zrfktzocbr .gt_font_italic { font-style: italic; } #zrfktzocbr .gt_super { font-size: 65%; } #zrfktzocbr .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value sex 0.99 0.78, 1.25 >0.9 age 1.00 0.99, 1.02 0.4 obstruction 1.49 1.11, 2.00 0.009 perforation 0.76 0.37, 1.57 0.5 adhesions 1.39 1.01, 1.91 0.041 nodes 1.09 1.07, 1.12 1 HR = Hazard Ratio, CI = Confidence Interval This suggests that the presence of obstruction or adhesion influences survival, as well as the number of nodes. Neither age (surprisingly) nor sex are likely to have a large impact (the confidence interval does not include any large differences between groups). The p-value for perforation is non-significant, but the confidence intervals are wide. Why is this? Try this: # Table of perforation rate tbl_summary( lesson7a %&gt;% select(perforation) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #qeykezvosr .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #qeykezvosr .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qeykezvosr .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #qeykezvosr .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #qeykezvosr .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qeykezvosr .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #qeykezvosr .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #qeykezvosr .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #qeykezvosr .gt_column_spanner_outer:first-child { padding-left: 0; } #qeykezvosr .gt_column_spanner_outer:last-child { padding-right: 0; } #qeykezvosr .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #qeykezvosr .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #qeykezvosr .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #qeykezvosr .gt_from_md > :first-child { margin-top: 0; } #qeykezvosr .gt_from_md > :last-child { margin-bottom: 0; } #qeykezvosr .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #qeykezvosr .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #qeykezvosr .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qeykezvosr .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #qeykezvosr .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #qeykezvosr .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #qeykezvosr .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #qeykezvosr .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #qeykezvosr .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qeykezvosr .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #qeykezvosr .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #qeykezvosr .gt_sourcenote { font-size: 90%; padding: 4px; } #qeykezvosr .gt_left { text-align: left; } #qeykezvosr .gt_center { text-align: center; } #qeykezvosr .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #qeykezvosr .gt_font_normal { font-weight: normal; } #qeykezvosr .gt_font_bold { font-weight: bold; } #qeykezvosr .gt_font_italic { font-style: italic; } #qeykezvosr .gt_super { font-size: 65%; } #qeykezvosr .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 6141 perforation 18 (2.9%) 1 n (%) You will see that less than 3% of patients had perforations, making it almost impossible to assess its predictive value. Another useful thing to do is to try: # Summarize number of nodes lesson7a %&gt;% skim(nodes) Table 9.7: Data summary Name Piped data Number of rows 614 Number of columns 9 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist nodes 15 0.98 3.59 3.49 0 1 2 4.5 33  You can see that patients had up to 33 nodes affected, yet all but a handful had 10 or fewer nodes. This might make us somewhat suspicious of the coefficient for nodes (which is interpreted as increase in hazard ratio for each additional node). One possibility might be to cap the number of nodes. This creates a new variable that caps the number of nodes at 10. Since fewer than 3% of patients had perforations, we will exclude this variable from our model. # Create new nodes variable, capped at 10 nodes lesson7a &lt;- lesson7a %&gt;% mutate( n2 = case_when( nodes &lt;= 10 ~ nodes, nodes &gt; 10 ~ 10 ) ) # Re-run cox model using &quot;n2&quot; (which caps the number of nodes at 10) coxph(Surv(survival_time, died) ~ sex + age + obstruction + adhesions + n2, data = lesson7a) %&gt;% tbl_regression(exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vscgzddlst .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vscgzddlst .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vscgzddlst .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vscgzddlst .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vscgzddlst .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vscgzddlst .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vscgzddlst .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vscgzddlst .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vscgzddlst .gt_column_spanner_outer:first-child { padding-left: 0; } #vscgzddlst .gt_column_spanner_outer:last-child { padding-right: 0; } #vscgzddlst .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vscgzddlst .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vscgzddlst .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vscgzddlst .gt_from_md > :first-child { margin-top: 0; } #vscgzddlst .gt_from_md > :last-child { margin-bottom: 0; } #vscgzddlst .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vscgzddlst .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vscgzddlst .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vscgzddlst .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vscgzddlst .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vscgzddlst .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vscgzddlst .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vscgzddlst .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vscgzddlst .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vscgzddlst .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vscgzddlst .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vscgzddlst .gt_sourcenote { font-size: 90%; padding: 4px; } #vscgzddlst .gt_left { text-align: left; } #vscgzddlst .gt_center { text-align: center; } #vscgzddlst .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vscgzddlst .gt_font_normal { font-weight: normal; } #vscgzddlst .gt_font_bold { font-weight: bold; } #vscgzddlst .gt_font_italic { font-style: italic; } #vscgzddlst .gt_super { font-size: 65%; } #vscgzddlst .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value sex 0.99 0.78, 1.26 >0.9 age 1.01 1.00, 1.02 0.3 obstruction 1.48 1.10, 1.98 0.009 adhesions 1.40 1.02, 1.92 0.037 n2 1.17 1.13, 1.22 1 HR = Hazard Ratio, CI = Confidence Interval However, it might be better to group patients. Here we create a new variable called node4 that groups patients into four groups: 0  2 nodes, 3  5 nodes, 5  10 nodes, 11 or more nodes. # Categorize values of nodes removed lesson7a &lt;- lesson7a %&gt;% mutate( node4 = case_when( nodes &lt;= 2 ~ 1, nodes &gt; 2 &amp; nodes &lt;= 5 ~ 2, nodes &gt; 5 &amp; nodes &lt;= 10 ~ 3, nodes &gt; 10 ~ 4 ) ) The cut-points are arbitrary but are not particularly important unless you think the effect of nodes radically changes at one particular cut point or another. The regression code would then be: # Re-run Cox model using categorized variable for nodes # Since &quot;node4&quot; is categorical, we must use &quot;factor()&quot; with this variable coxph(Surv(survival_time, died) ~ sex + age + obstruction + adhesions + factor(node4), data = lesson7a) ## Call: ## coxph(formula = Surv(survival_time, died) ~ sex + age + obstruction + ## adhesions + factor(node4), data = lesson7a) ## ## coef exp(coef) se(coef) z p ## sex -0.006908 0.993116 0.121775 -0.057 0.95476 ## age 0.005283 1.005297 0.005355 0.987 0.32387 ## obstruction 0.363027 1.437674 0.149796 2.423 0.01537 ## adhesions 0.344250 1.410932 0.160702 2.142 0.03218 ## factor(node4)2 0.481741 1.618890 0.146725 3.283 0.00103 ## factor(node4)3 1.075440 2.931281 0.161608 6.655 2.84e-11 ## factor(node4)4 1.193543 3.298747 0.241068 4.951 7.38e-07 ## ## Likelihood ratio test=59.3 on 7 df, p=2.083e-10 ## n= 599, number of events= 274 ## (15 observations deleted due to missingness) A model answer for this dataset might be: Median survival in the 614 patients in the cohort was 8.0 years, with a median duration of follow-up for survivors of 6.4 years. There were 284 deaths during follow-up. Although about 95% of patients had ten nodes or fewer, a small number of patients had a very large number of affected nodes, up to 33 in one case. Nodes were therefore categorized as 0-2, 3-5, 6-10, and &gt;10. In a Cox regression of the 599 patients with complete data, obstruction, adhesion and number of nodes were predictive of survival. Neither sex, age or perforation appeared to influence survival. Fewer than 3% of patients experienced perforations and this variable was therefore removed from the model. Patient characteristics and results for the final model are given in the table. Table 1. Patient Characteristics html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #dsijydijcl .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #dsijydijcl .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #dsijydijcl .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #dsijydijcl .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #dsijydijcl .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #dsijydijcl .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #dsijydijcl .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #dsijydijcl .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #dsijydijcl .gt_column_spanner_outer:first-child { padding-left: 0; } #dsijydijcl .gt_column_spanner_outer:last-child { padding-right: 0; } #dsijydijcl .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #dsijydijcl .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #dsijydijcl .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #dsijydijcl .gt_from_md > :first-child { margin-top: 0; } #dsijydijcl .gt_from_md > :last-child { margin-bottom: 0; } #dsijydijcl .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #dsijydijcl .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #dsijydijcl .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #dsijydijcl .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #dsijydijcl .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #dsijydijcl .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #dsijydijcl .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #dsijydijcl .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #dsijydijcl .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #dsijydijcl .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #dsijydijcl .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #dsijydijcl .gt_sourcenote { font-size: 90%; padding: 4px; } #dsijydijcl .gt_left { text-align: left; } #dsijydijcl .gt_center { text-align: center; } #dsijydijcl .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #dsijydijcl .gt_font_normal { font-weight: normal; } #dsijydijcl .gt_font_bold { font-weight: bold; } #dsijydijcl .gt_font_italic { font-style: italic; } #dsijydijcl .gt_super { font-size: 65%; } #dsijydijcl .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic N = 6141 Female 318 (52%) Age 61 (53, 69) Obstruction 117 (19%) Adhesions 88 (14%) Number of Nodes 0-2 311 (52%) 3-5 168 (28%) 5-10 92 (15%) &gt;10 28 (4.7%) Unknown 15 1 n (%); Median (IQR) Table 2. Results of Cox proportional hazards model for time to death html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #vzibdsvmtd .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #vzibdsvmtd .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vzibdsvmtd .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #vzibdsvmtd .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #vzibdsvmtd .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vzibdsvmtd .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #vzibdsvmtd .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #vzibdsvmtd .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #vzibdsvmtd .gt_column_spanner_outer:first-child { padding-left: 0; } #vzibdsvmtd .gt_column_spanner_outer:last-child { padding-right: 0; } #vzibdsvmtd .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #vzibdsvmtd .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #vzibdsvmtd .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #vzibdsvmtd .gt_from_md > :first-child { margin-top: 0; } #vzibdsvmtd .gt_from_md > :last-child { margin-bottom: 0; } #vzibdsvmtd .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #vzibdsvmtd .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #vzibdsvmtd .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vzibdsvmtd .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #vzibdsvmtd .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #vzibdsvmtd .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #vzibdsvmtd .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #vzibdsvmtd .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #vzibdsvmtd .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vzibdsvmtd .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #vzibdsvmtd .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #vzibdsvmtd .gt_sourcenote { font-size: 90%; padding: 4px; } #vzibdsvmtd .gt_left { text-align: left; } #vzibdsvmtd .gt_center { text-align: center; } #vzibdsvmtd .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #vzibdsvmtd .gt_font_normal { font-weight: normal; } #vzibdsvmtd .gt_font_bold { font-weight: bold; } #vzibdsvmtd .gt_font_italic { font-style: italic; } #vzibdsvmtd .gt_super { font-size: 65%; } #vzibdsvmtd .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value Female 0.99 0.78, 1.26 >0.9 Age (per 1 year) 1.01 0.99, 1.02 0.3 Obstruction 1.44 1.07, 1.93 0.015 Adhesions 1.41 1.03, 1.93 0.032 Number of Nodes 0-2 &mdash; &mdash; 3-5 1.62 1.21, 2.16 0.001 5-10 2.93 2.14, 4.02 &gt;10 3.30 2.06, 5.29 1 HR = Hazard Ratio, CI = Confidence Interval 9.7.2 lesson7b.rds These are time to recurrence data on forty patients with biliary cancer treated at one of two hospitals, one of which treats a large number of cancer patients and one of which does not. Do patients treated at a high volume hospital have a longer time to recurrence? We can test the difference between groups by using the survdiff function: # Test for difference in time to recurrence by hivolume survdiff(Surv(time, recurrence) ~ hivolume, data = lesson7b) ## Call: ## survdiff(formula = Surv(time, recurrence) ~ hivolume, data = lesson7b) ## ## N Observed Expected (O-E)^2/E (O-E)^2/V ## hivolume=0 20 7 4.5 1.39 2.53 ## hivolume=1 20 3 5.5 1.14 2.53 ## ## Chisq= 2.5 on 1 degrees of freedom, p= 0.1 We get a p-value of 0.11. This is not sufficient evidence to conclude that high volume hospitals and more experienced surgeons lower recurrence rates. However, could there be a difference and the trial was not large enough to detect it? The key point here is not sample size, but the number of events (typically recurrences or deaths). Even if you had a trial of 100,000 patients, if only one or two people died you would not have any data on length of survival to test. In this dataset, though there were 40 patients, there were only ten events. You can see that if you use the survfit function: # Look at number of recurrence events in this dataset survfit(Surv(time, recurrence) ~ 1, data = lesson7b) ## Call: survfit(formula = Surv(time, recurrence) ~ 1, data = lesson7b) ## ## n events median 0.95LCL 0.95UCL ## 40 10 NA NA NA You can then look at a Cox model: # Cox model for time to recurrence lesson7b_cox &lt;- coxph(Surv(time, recurrence) ~ hivolume, data = lesson7b) tbl_regression(lesson7b_cox, exponentiate = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #kkkcaoxbev .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #kkkcaoxbev .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kkkcaoxbev .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #kkkcaoxbev .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #kkkcaoxbev .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kkkcaoxbev .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #kkkcaoxbev .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #kkkcaoxbev .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #kkkcaoxbev .gt_column_spanner_outer:first-child { padding-left: 0; } #kkkcaoxbev .gt_column_spanner_outer:last-child { padding-right: 0; } #kkkcaoxbev .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #kkkcaoxbev .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #kkkcaoxbev .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #kkkcaoxbev .gt_from_md > :first-child { margin-top: 0; } #kkkcaoxbev .gt_from_md > :last-child { margin-bottom: 0; } #kkkcaoxbev .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #kkkcaoxbev .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #kkkcaoxbev .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kkkcaoxbev .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #kkkcaoxbev .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #kkkcaoxbev .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #kkkcaoxbev .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #kkkcaoxbev .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #kkkcaoxbev .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kkkcaoxbev .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #kkkcaoxbev .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #kkkcaoxbev .gt_sourcenote { font-size: 90%; padding: 4px; } #kkkcaoxbev .gt_left { text-align: left; } #kkkcaoxbev .gt_center { text-align: center; } #kkkcaoxbev .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #kkkcaoxbev .gt_font_normal { font-weight: normal; } #kkkcaoxbev .gt_font_bold { font-weight: bold; } #kkkcaoxbev .gt_font_italic { font-style: italic; } #kkkcaoxbev .gt_super { font-size: 65%; } #kkkcaoxbev .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic HR1 95% CI1 p-value 1 = high volume, 0 = low volume 0.35 0.09, 1.35 0.13 1 HR = Hazard Ratio, CI = Confidence Interval You find that the hazard ratio for survival is 0.35. The 95% CI is 0.09, 1.35. Clearly, high volume hospitals seem to do better, this dataset just isnt large enough to see it. A model answer: At a median follow-up for survivors of 44 months, 3 patients in the high volume hospital had recurred compared to 7 in the low volume hospital (Figure 1, p=0.11 by log-rank test). Median survival has not been reached in either group. The hazard ratio of 0.35 (95% CI 0.09, 1.35) suggests that a large difference between groups may not have been detected at this stage of follow-up. Figure 1. Kaplan-Meier curve for recurrence in low volume (blue) and high volume (red) centers Another way of doing this would be to estimate survival at say, 6, 12 and 18 months in each hospital. The command would be: # Estimate survival at 6, 12 and 18 months summary(survfit(Surv(time, recurrence) ~ hivolume, data = lesson7b), times = c(183, 365, 548)) ## Call: survfit(formula = Surv(time, recurrence) ~ hivolume, data = lesson7b) ## ## hivolume=0 ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 183 18 2 0.900 0.0671 0.778 1.000 ## 365 15 3 0.750 0.0968 0.582 0.966 ## 548 5 2 0.556 0.1404 0.339 0.912 ## ## hivolume=1 ## time n.risk n.event survival std.err lower 95% CI upper 95% CI ## 183 20 0 1.000 0.0000 1.000 1 ## 365 18 2 0.900 0.0671 0.778 1 ## 548 10 1 0.847 0.0814 0.702 1 You could report survival of 100%, 90%, and 85% in the high volume hospital compared to 90%, 75% and 56% in the low volume hospital. 9.7.3 lesson7c.rds These are data from a randomized trial comparing no treatment, 5FU (a chemotherapy agent) and 5FU plus levamisole in the adjuvant treatment of colon cancer. Describe the dataset. What conclusions would you draw about the effectiveness of the different treatments? Lets jump straight to the model answer. The study consisted of 929 patients, of whom 452 died during the study. Median duration of follow-up for survivors was 6.4 years. Median survival in the control and 5FU groups was 5.7 and 5.9 years, respectively; median survival for the combination group has not been reached (see figure). The overall log-rank test was significant (p=0.003), suggesting that the survival is different between groups. In a multivariable Cox regression with group coded as two dummy variables (5FU and Levamisole), 5FU was found to have little effect on survival (HR 0.97 (95% CI 0.78, 1.21; p=0.8)). Levamisole, however, led to significantly increased survival (hazard ratio 0.69 (95% CI 0.55, 0.87; p=0.002)). Figure In case you are wondering how I did all this, one key is to see that in the dataset group and treatment are equivalent: # Two-way table of group by treatment tbl_summary( lesson7c %&gt;% select(group, treatment), by = treatment ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #rybbrzjeef .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #rybbrzjeef .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rybbrzjeef .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #rybbrzjeef .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 4px; border-top-color: #FFFFFF; border-top-width: 0; } #rybbrzjeef .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rybbrzjeef .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #rybbrzjeef .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #rybbrzjeef .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #rybbrzjeef .gt_column_spanner_outer:first-child { padding-left: 0; } #rybbrzjeef .gt_column_spanner_outer:last-child { padding-right: 0; } #rybbrzjeef .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; overflow-x: hidden; display: inline-block; width: 100%; } #rybbrzjeef .gt_group_heading { padding: 8px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; } #rybbrzjeef .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #rybbrzjeef .gt_from_md > :first-child { margin-top: 0; } #rybbrzjeef .gt_from_md > :last-child { margin-bottom: 0; } #rybbrzjeef .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #rybbrzjeef .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 12px; } #rybbrzjeef .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rybbrzjeef .gt_first_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; } #rybbrzjeef .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #rybbrzjeef .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #rybbrzjeef .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #rybbrzjeef .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #rybbrzjeef .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rybbrzjeef .gt_footnote { margin: 0px; font-size: 90%; padding: 4px; } #rybbrzjeef .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #rybbrzjeef .gt_sourcenote { font-size: 90%; padding: 4px; } #rybbrzjeef .gt_left { text-align: left; } #rybbrzjeef .gt_center { text-align: center; } #rybbrzjeef .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #rybbrzjeef .gt_font_normal { font-weight: normal; } #rybbrzjeef .gt_font_bold { font-weight: bold; } #rybbrzjeef .gt_font_italic { font-style: italic; } #rybbrzjeef .gt_super { font-size: 65%; } #rybbrzjeef .gt_footnote_marks { font-style: italic; font-size: 65%; } Characteristic 5FU, N = 3101 5FU+Levamisole, N = 3041 control, N = 3151 group 1 0 (0%) 0 (0%) 315 (100%) 2 310 (100%) 0 (0%) 0 (0%) 3 0 (0%) 304 (100%) 0 (0%) 1 n (%) When I did the graph, I used the variable treatment to get the names of the treatments (rather than the group number). I also used a function called ggsurvplot (from the survminer package) rather than the standard plot option, because ggsurvplot allows more customization to the graph. Survival time was specified as survival_time/365.25 so that the graph is plotted showing survival time in years, rather than days. # Create Kaplan-Meier plot by treatment group survminer::ggsurvplot(survfit(Surv(survival_time/365.25, died) ~ treatment, data = lesson7c), legend = &quot;bottom&quot;) When I did the Cox regression, I created dummy variables by typing: # Create dummy variable for treatment lesson7c &lt;- lesson7c %&gt;% mutate( fu = if_else(group == 2, 1, 0), lev = if_else(group == 3, 1, 0) ) Then it was straightforward to create the cox model and get the overall p-value from the survdiff function. # Cox model with dummy variables coxph(Surv(survival_time, died) ~ fu + lev, data = lesson7c) ## Call: ## coxph(formula = Surv(survival_time, died) ~ fu + lev, data = lesson7c) ## ## coef exp(coef) se(coef) z p ## fu -0.02664 0.97371 0.11030 -0.241 0.80917 ## lev -0.37171 0.68955 0.11875 -3.130 0.00175 ## ## Likelihood ratio test=12.15 on 2 df, p=0.002302 ## n= 929, number of events= 452 # Overall p-value for all 3 groups survdiff(Surv(survival_time, died) ~ group, data = lesson7c) ## Call: ## survdiff(formula = Surv(survival_time, died) ~ group, data = lesson7c) ## ## N Observed Expected (O-E)^2/E (O-E)^2/V ## group=1 315 168 148 2.58 3.85 ## group=2 310 161 146 1.52 2.25 ## group=3 304 123 157 7.55 11.62 ## ## Chisq= 11.7 on 2 degrees of freedom, p= 0.003 Any oncologists notice a problem here? It is this: Levamisole doesnt work at all, but 5FU (obviously) does. It turns out that this whole dataset (which I downloaded from the internet) was miscoded: it should have been: control, levamisole alone, levamisole + 5FU. Which goes to show the importance of checking your data. 9.7.4 lesson7d.rds More data on time to recurrence by hospital volume. Given this dataset, determine whether patients treated at a high volume hospital have a longer time to recurrence. These data are comparable to lesson7b.rds, except with a longer length of follow-up. There are more recurrences (events) because more time has elapsed. So though the hazard ratio is very similar, and the number of patients identical, the confidence interval is much narrower and the results statistically significant. However, do be careful about drawing causal inferences: just because recurrence rates are lower at the high volume hospital, it doesnt mean that treatment at a high volume hospital reduces risk of recurrence. There may be other differences between hospitals (e.g. case mix). "]]
